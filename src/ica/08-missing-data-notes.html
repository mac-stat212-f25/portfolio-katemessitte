<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>‚Äî ‚Äì COMP/STAT212 Portfolio</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../src/ica/09-functions-notes.html" rel="next">
<link href="../../src/ica/06-wrangling-1-notes.html" rel="prev">
<script src="../../site_libs/cookie-consent/cookie-consent.js"></script>
<link href="../../site_libs/cookie-consent/cookie-consent.css" rel="stylesheet">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-b53751a350365c71b6c909e95f209ed1.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-463f7e572b85bff0cfe833e89a202fa4.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-2b27489b1280a247593da265a4955406.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

<script type="text/javascript" charset="UTF-8">
document.addEventListener('DOMContentLoaded', function () {
cookieconsent.run({
  "notice_banner_type":"simple",
  "consent_type":"implied",
  "palette":"light",
  "language":"en",
  "page_load_consent_levels":["strictly-necessary","functionality","tracking","targeting"],
  "notice_banner_reject_button_hide":false,
  "preferences_center_close_button_hide":false,
  "website_name":""
  ,
"language":"en"
  });
});
</script> 
  
<style>html{ scroll-behavior: smooth; }</style>


<link rel="stylesheet" href="../../style/custom.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../src/ica/ica-sample1.html">In-Class Activities</a></li><li class="breadcrumb-item"><a href="../../src/ica/08-missing-data-notes.html"><span class="chapter-title">‚Äî</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../../index.html" class="sidebar-logo-link">
      <img src="../../assets/sidebar-logo.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">Your Name Here</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Prof Viz</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/pv/pv-01.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Professional Viz Sample</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">TidyTuesday</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/tt/2025-07-08.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">TidyTuesday Sample 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/tt/2025-07-15.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">TidyTuesday Sample 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/tt/HW01-tt.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Homework 01</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/tt/HW02-tt.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Homework 02</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/tt/HW03-tt.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Homework 03</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/tt/HW04-tt.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Homework 04</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/tt/HW05-tt.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Homework 05</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">In-Class Activities</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/ica/ica-sample1.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">ICA Sample 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/ica/ica-sample2.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">ICA Sample 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/ica/cleaning.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Cleaning SFO Weather Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/ica/03-adv-ggplot-notes.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">3 Advanced Data Viz</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/ica/04_adv_maps/code/04-adv-maps-1-notes.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">4 Advanced Spatial Viz P1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/ica/06-wrangling-1-notes.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">6 Adv Data wrangling P1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/ica/08-missing-data-notes.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">‚Äî</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/ica/09-functions-notes.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">9 Functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/ica/10-base-r-notes.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">‚Äî</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Exams</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/ex/Exam1Findings.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Exam1Findings</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/appx/appx-sample1.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Appendix Sample 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/appx/appx-sample2.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Appendix Sample 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../mm/mm.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Mind Maps</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="99">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#title-8-missing-data" id="toc-title-8-missing-data" class="nav-link active" data-scroll-target="#title-8-missing-data">title: ‚Äú8 Missing Data‚Äù</a></li>
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section">‚Äî</a></li>
  <li><a href="#section-1" id="toc-section-1" class="nav-link" data-scroll-target="#section-1"></a></li>
  <li><a href="#section-2" id="toc-section-2" class="nav-link" data-scroll-target="#section-2"></a></li>
  <li><a href="#r-doc_setup_08-echofalse-messagefalse-librarytidyverse-librarynaniar-librarymice" id="toc-r-doc_setup_08-echofalse-messagefalse-librarytidyverse-librarynaniar-librarymice" class="nav-link" data-scroll-target="#r-doc_setup_08-echofalse-messagefalse-librarytidyverse-librarynaniar-librarymice"><code>{r doc_setup_08, echo=FALSE, message=FALSE} # library(tidyverse) # library(naniar) # library(mice) #</code></a></li>
  <li><a href="#section-3" id="toc-section-3" class="nav-link" data-scroll-target="#section-3"></a></li>
  <li><a href="#learning-goals" id="toc-learning-goals" class="nav-link" data-scroll-target="#learning-goals">## üß© Learning Goals</a></li>
  <li><a href="#section-4" id="toc-section-4" class="nav-link" data-scroll-target="#section-4"></a></li>
  <li><a href="#by-the-end-of-this-lesson-you-should-be-able-to" id="toc-by-the-end-of-this-lesson-you-should-be-able-to" class="nav-link" data-scroll-target="#by-the-end-of-this-lesson-you-should-be-able-to">By the end of this lesson, you should be able to:</a></li>
  <li><a href="#section-5" id="toc-section-5" class="nav-link" data-scroll-target="#section-5"></a></li>
  <li><a href="#go-through-a-data-quality-checklist-when-data-wrangling" id="toc-go-through-a-data-quality-checklist-when-data-wrangling" class="nav-link" data-scroll-target="#go-through-a-data-quality-checklist-when-data-wrangling">- Go through a data quality checklist when data wrangling</a></li>
  <li><a href="#explain-the-difference-between-mcar-mar-and-mnar-missing-data-mechanisms" id="toc-explain-the-difference-between-mcar-mar-and-mnar-missing-data-mechanisms" class="nav-link" data-scroll-target="#explain-the-difference-between-mcar-mar-and-mnar-missing-data-mechanisms">- Explain the difference between MCAR, MAR, and MNAR missing data mechanisms</a></li>
  <li><a href="#assess-what-missing-data-mechanisms-might-be-at-play-in-a-given-dataset" id="toc-assess-what-missing-data-mechanisms-might-be-at-play-in-a-given-dataset" class="nav-link" data-scroll-target="#assess-what-missing-data-mechanisms-might-be-at-play-in-a-given-dataset">- Assess what missing data mechanisms might be at play in a given dataset</a></li>
  <li><a href="#use-visualizations-to-explore-missing-data-patterns" id="toc-use-visualizations-to-explore-missing-data-patterns" class="nav-link" data-scroll-target="#use-visualizations-to-explore-missing-data-patterns">- Use visualizations to explore missing data patterns</a></li>
  <li><a href="#explain-why-multiple-imputation-is-preferred-to-single-imputation" id="toc-explain-why-multiple-imputation-is-preferred-to-single-imputation" class="nav-link" data-scroll-target="#explain-why-multiple-imputation-is-preferred-to-single-imputation">- Explain why multiple imputation is preferred to single imputation</a></li>
  <li><a href="#explain-how-a-simulation-study-can-be-used-to-investigate-properties-of-statistical-methods" id="toc-explain-how-a-simulation-study-can-be-used-to-investigate-properties-of-statistical-methods" class="nav-link" data-scroll-target="#explain-how-a-simulation-study-can-be-used-to-investigate-properties-of-statistical-methods">- Explain how a simulation study can be used to investigate properties of statistical methods</a></li>
  <li><a href="#section-6" id="toc-section-6" class="nav-link" data-scroll-target="#section-6"></a></li>
  <li><a href="#section-7" id="toc-section-7" class="nav-link" data-scroll-target="#section-7"></a></li>
  <li><a href="#data-quality-checklist" id="toc-data-quality-checklist" class="nav-link" data-scroll-target="#data-quality-checklist">## Data Quality Checklist</a></li>
  <li><a href="#section-8" id="toc-section-8" class="nav-link" data-scroll-target="#section-8"></a></li>
  <li><a href="#when-wrangling-cleaning-data-make-sure-to-check-the-assumptions-you-make-about-the-data-to-ensure-you-dont-lose-data-quality." id="toc-when-wrangling-cleaning-data-make-sure-to-check-the-assumptions-you-make-about-the-data-to-ensure-you-dont-lose-data-quality." class="nav-link" data-scroll-target="#when-wrangling-cleaning-data-make-sure-to-check-the-assumptions-you-make-about-the-data-to-ensure-you-dont-lose-data-quality.">When wrangling / cleaning data, make sure to check the assumptions you make about the data to ensure you don‚Äôt lose data quality.</a></li>
  <li><a href="#section-9" id="toc-section-9" class="nav-link" data-scroll-target="#section-9"></a></li>
  <li><a href="#section-10" id="toc-section-10" class="nav-link" data-scroll-target="#section-10"></a></li>
  <li><a href="#section-11" id="toc-section-11" class="nav-link" data-scroll-target="#section-11">:::</a></li>
  <li><a href="#data-parsing-reading-data-into-a-different-data-format" id="toc-data-parsing-reading-data-into-a-different-data-format" class="nav-link" data-scroll-target="#data-parsing-reading-data-into-a-different-data-format"><strong>Data Parsing</strong> (reading data into a different data format)</a></li>
  <li><a href="#section-12" id="toc-section-12" class="nav-link" data-scroll-target="#section-12"></a></li>
  <li><a href="#always-keep-the-original-raw-data-dont-manually-change-it." id="toc-always-keep-the-original-raw-data-dont-manually-change-it." class="nav-link" data-scroll-target="#always-keep-the-original-raw-data-dont-manually-change-it.">- Always keep the original, raw data (don‚Äôt manually change it).</a></li>
  <li><a href="#use-test-cases-find-rows-or-write-test-cases-to-double-check-the-wrangling-works-as-expected" id="toc-use-test-cases-find-rows-or-write-test-cases-to-double-check-the-wrangling-works-as-expected" class="nav-link" data-scroll-target="#use-test-cases-find-rows-or-write-test-cases-to-double-check-the-wrangling-works-as-expected">- Use Test Cases: Find rows or write test cases to double check the wrangling works as expected</a></li>
  <li><a href="#dates-when-using-lubridate-to-parse-dates-and-times-ensure-the-strings-are-consistently-ordered-and-formatted-correctly-eg-mmddyy-vs.-ddmmyy." id="toc-dates-when-using-lubridate-to-parse-dates-and-times-ensure-the-strings-are-consistently-ordered-and-formatted-correctly-eg-mmddyy-vs.-ddmmyy." class="nav-link" data-scroll-target="#dates-when-using-lubridate-to-parse-dates-and-times-ensure-the-strings-are-consistently-ordered-and-formatted-correctly-eg-mmddyy-vs.-ddmmyy.">- DATES: When using <code>lubridate</code> to parse dates and times, ensure the strings are consistently ordered and formatted correctly, eg, mm/dd/yy vs.&nbsp;dd/mm/yy.</a></li>
  <li><a href="#strings-when-using-stringr-to-parse-strings-with-regular-expressions-check-example-rows-to-ensure-that-the-pattern-captured-all-of-the-examples-you-want-and-excluded-the-patterns-you-dont-want." id="toc-strings-when-using-stringr-to-parse-strings-with-regular-expressions-check-example-rows-to-ensure-that-the-pattern-captured-all-of-the-examples-you-want-and-excluded-the-patterns-you-dont-want." class="nav-link" data-scroll-target="#strings-when-using-stringr-to-parse-strings-with-regular-expressions-check-example-rows-to-ensure-that-the-pattern-captured-all-of-the-examples-you-want-and-excluded-the-patterns-you-dont-want.">- STRINGS: When using <code>stringr</code> to parse strings with regular expressions, check example rows to ensure that the pattern captured all of the examples you want and excluded the patterns you don‚Äôt want.</a></li>
  <li><a href="#always-check-for-missing-values-to-see-if-the-missing-ones-are-expected-given-the-original-data." id="toc-always-check-for-missing-values-to-see-if-the-missing-ones-are-expected-given-the-original-data." class="nav-link" data-scroll-target="#always-check-for-missing-values-to-see-if-the-missing-ones-are-expected-given-the-original-data.">- Always check for missing values to see if the missing ones are expected given the original data.</a></li>
  <li><a href="#section-13" id="toc-section-13" class="nav-link" data-scroll-target="#section-13"></a></li>
  <li><a href="#section-14" id="toc-section-14" class="nav-link" data-scroll-target="#section-14">:::</a></li>
  <li><a href="#section-15" id="toc-section-15" class="nav-link" data-scroll-target="#section-15"></a></li>
  <li><a href="#data-joining" id="toc-data-joining" class="nav-link" data-scroll-target="#data-joining"><strong>Data Joining</strong></a></li>
  <li><a href="#section-16" id="toc-section-16" class="nav-link" data-scroll-target="#section-16"></a></li>
  <li><a href="#section-17" id="toc-section-17" class="nav-link" data-scroll-target="#section-17">:::</a></li>
  <li><a href="#section-18" id="toc-section-18" class="nav-link" data-scroll-target="#section-18"></a></li>
  <li><a href="#identify-missing-values-in-the-key-variables-and-decide-how-to-handle-them-before-the-merge-process-e.g.-omitting-rows-with-missing-values-imputing-missing-values." id="toc-identify-missing-values-in-the-key-variables-and-decide-how-to-handle-them-before-the-merge-process-e.g.-omitting-rows-with-missing-values-imputing-missing-values." class="nav-link" data-scroll-target="#identify-missing-values-in-the-key-variables-and-decide-how-to-handle-them-before-the-merge-process-e.g.-omitting-rows-with-missing-values-imputing-missing-values.">- Identify missing values in the key variables and decide how to handle them before the merge process (e.g., omitting rows with missing values, imputing missing values).</a></li>
  <li><a href="#decide-on-the-correct-join-type-left-right-inner-full-etc.-or-if-the-data-structure-is-the-same-use-list_rbind-to-bind-rows-or-list_cbind-to-bind-columns." id="toc-decide-on-the-correct-join-type-left-right-inner-full-etc.-or-if-the-data-structure-is-the-same-use-list_rbind-to-bind-rows-or-list_cbind-to-bind-columns." class="nav-link" data-scroll-target="#decide-on-the-correct-join-type-left-right-inner-full-etc.-or-if-the-data-structure-is-the-same-use-list_rbind-to-bind-rows-or-list_cbind-to-bind-columns.">- Decide on the correct join type (left, right, inner, full, etc.) OR if the data structure is the same use <code>list_rbind()</code> to bind rows or <code>list_cbind()</code> to bind columns.</a></li>
  <li><a href="#if-doing-a-join-make-sure-that-the-key-variables-by-have-the-same-meaning-in-both-datasets-and-are-represented-in-the-same-way-e.g.-id-1-to-20-in-first-dataset-will-match-id-1---20-in-undesirable-ways" id="toc-if-doing-a-join-make-sure-that-the-key-variables-by-have-the-same-meaning-in-both-datasets-and-are-represented-in-the-same-way-e.g.-id-1-to-20-in-first-dataset-will-match-id-1---20-in-undesirable-ways" class="nav-link" data-scroll-target="#if-doing-a-join-make-sure-that-the-key-variables-by-have-the-same-meaning-in-both-datasets-and-are-represented-in-the-same-way-e.g.-id-1-to-20-in-first-dataset-will-match-id-1---20-in-undesirable-ways">- If doing a join, make sure that the key variables (<code>by</code>) have the same meaning in both datasets and are represented in the same way (e.g., id = 1 to 20 in first dataset will match id = 1 - 20 in undesirable ways)</a></li>
  <li><a href="#predict-the-number-of-rows-that-will-result-from-the-join-and-double-check-the-anti_join-to-see-which-rows-did-not-find-a-match." id="toc-predict-the-number-of-rows-that-will-result-from-the-join-and-double-check-the-anti_join-to-see-which-rows-did-not-find-a-match." class="nav-link" data-scroll-target="#predict-the-number-of-rows-that-will-result-from-the-join-and-double-check-the-anti_join-to-see-which-rows-did-not-find-a-match.">- Predict the number of rows that will result from the join and double check the <code>anti_join()</code> to see which rows did not find a match.</a></li>
  <li><a href="#check-for-duplicate-records-within-each-dataset-and-ensure-they-are-handled-appropriately-before-merging." id="toc-check-for-duplicate-records-within-each-dataset-and-ensure-they-are-handled-appropriately-before-merging." class="nav-link" data-scroll-target="#check-for-duplicate-records-within-each-dataset-and-ensure-they-are-handled-appropriately-before-merging.">- Check for duplicate records within each dataset and ensure they are handled appropriately before merging.</a></li>
  <li><a href="#verify-that-the-merged-dataset-maintains-consistency-with-the-original-datasets-in-terms-of-data-values-variable-names-and-variable-types." id="toc-verify-that-the-merged-dataset-maintains-consistency-with-the-original-datasets-in-terms-of-data-values-variable-names-and-variable-types." class="nav-link" data-scroll-target="#verify-that-the-merged-dataset-maintains-consistency-with-the-original-datasets-in-terms-of-data-values-variable-names-and-variable-types.">- Verify that the merged dataset maintains consistency with the original datasets in terms of data values, variable names, and variable types.</a></li>
  <li><a href="#perform-some-preliminary-analysis-or-validation-checks-on-the-merged-dataset-to-ensure-that-it-meets-the-requirements-of-your-analysis." id="toc-perform-some-preliminary-analysis-or-validation-checks-on-the-merged-dataset-to-ensure-that-it-meets-the-requirements-of-your-analysis." class="nav-link" data-scroll-target="#perform-some-preliminary-analysis-or-validation-checks-on-the-merged-dataset-to-ensure-that-it-meets-the-requirements-of-your-analysis.">- Perform some preliminary analysis or validation checks on the merged dataset to ensure that it meets the requirements of your analysis.</a></li>
  <li><a href="#section-19" id="toc-section-19" class="nav-link" data-scroll-target="#section-19"></a></li>
  <li><a href="#section-20" id="toc-section-20" class="nav-link" data-scroll-target="#section-20">:::</a></li>
  <li><a href="#section-21" id="toc-section-21" class="nav-link" data-scroll-target="#section-21"></a></li>
  <li><a href="#section-22" id="toc-section-22" class="nav-link" data-scroll-target="#section-22"></a></li>
  <li><a href="#sanity-check-visualize-your-data" id="toc-sanity-check-visualize-your-data" class="nav-link" data-scroll-target="#sanity-check-visualize-your-data"><strong>Sanity Check: Visualize your data!!!</strong></a></li>
  <li><a href="#section-23" id="toc-section-23" class="nav-link" data-scroll-target="#section-23"></a></li>
  <li><a href="#section-24" id="toc-section-24" class="nav-link" data-scroll-target="#section-24">:::</a></li>
  <li><a href="#do-the-right-number-of-points-appear" id="toc-do-the-right-number-of-points-appear" class="nav-link" data-scroll-target="#do-the-right-number-of-points-appear">- Do the right number of points appear?</a></li>
  <li><a href="#do-the-values-seem-reasonable" id="toc-do-the-values-seem-reasonable" class="nav-link" data-scroll-target="#do-the-values-seem-reasonable">- Do the values seem reasonable?</a></li>
  <li><a href="#section-25" id="toc-section-25" class="nav-link" data-scroll-target="#section-25">:::</a></li>
  <li><a href="#section-26" id="toc-section-26" class="nav-link" data-scroll-target="#section-26"></a></li>
  <li><a href="#explicit-v.-implicit-missing-data" id="toc-explicit-v.-implicit-missing-data" class="nav-link" data-scroll-target="#explicit-v.-implicit-missing-data">## Explicit v. Implicit Missing Data</a></li>
  <li><a href="#section-27" id="toc-section-27" class="nav-link" data-scroll-target="#section-27"></a></li>
  <li><a href="#explicit-missing-data-is-data-that-is-explicitly-marked-as-missing.-in-r-this-is-done-with-na." id="toc-explicit-missing-data-is-data-that-is-explicitly-marked-as-missing.-in-r-this-is-done-with-na." class="nav-link" data-scroll-target="#explicit-missing-data-is-data-that-is-explicitly-marked-as-missing.-in-r-this-is-done-with-na."><strong>Explicit missing data</strong> is data that is explicitly marked as missing. In R, this is done with <code>NA</code>.</a></li>
  <li><a href="#section-28" id="toc-section-28" class="nav-link" data-scroll-target="#section-28"></a></li>
  <li><a href="#section-29" id="toc-section-29" class="nav-link" data-scroll-target="#section-29"></a></li>
  <li><a href="#implicit-missing-data-is-data-that-is-missing-but-not-explicitly-marked-as-such." id="toc-implicit-missing-data-is-data-that-is-missing-but-not-explicitly-marked-as-such." class="nav-link" data-scroll-target="#implicit-missing-data-is-data-that-is-missing-but-not-explicitly-marked-as-such."><strong>Implicit missing data</strong> is data that is missing but not explicitly marked as such.</a></li>
  <li><a href="#section-30" id="toc-section-30" class="nav-link" data-scroll-target="#section-30"></a></li>
  <li><a href="#this-can-happen-when-an-entire-row-is-missing-from-a-dataset." id="toc-this-can-happen-when-an-entire-row-is-missing-from-a-dataset." class="nav-link" data-scroll-target="#this-can-happen-when-an-entire-row-is-missing-from-a-dataset.">- This can happen when an entire row is missing from a dataset.</a></li>
  <li><a href="#for-example-if-a-study-participant-doesnt-attend-a-follow-up-visit.-it-maybe-not-even-be-recorded-in-the-data." id="toc-for-example-if-a-study-participant-doesnt-attend-a-follow-up-visit.-it-maybe-not-even-be-recorded-in-the-data." class="nav-link" data-scroll-target="#for-example-if-a-study-participant-doesnt-attend-a-follow-up-visit.-it-maybe-not-even-be-recorded-in-the-data.">- For example, if a study participant doesn‚Äôt attend a follow-up visit. It maybe not even be recorded in the data.</a></li>
  <li><a href="#section-31" id="toc-section-31" class="nav-link" data-scroll-target="#section-31"></a></li>
  <li><a href="#we-need-to-make-implicit-missingness-explicit-before-we-can-work-with-the-data." id="toc-we-need-to-make-implicit-missingness-explicit-before-we-can-work-with-the-data." class="nav-link" data-scroll-target="#we-need-to-make-implicit-missingness-explicit-before-we-can-work-with-the-data.">We need to <strong>make implicit missingness explicit</strong> before we can work with the data.</a></li>
  <li><a href="#section-32" id="toc-section-32" class="nav-link" data-scroll-target="#section-32"></a></li>
  <li><a href="#consider-the-combinations-of-variables-that-youd-expect-to-be-fully-present-in-a-complete-dataset." id="toc-consider-the-combinations-of-variables-that-youd-expect-to-be-fully-present-in-a-complete-dataset." class="nav-link" data-scroll-target="#consider-the-combinations-of-variables-that-youd-expect-to-be-fully-present-in-a-complete-dataset.">- Consider the combinations of variables that you‚Äôd expect to be fully present in a complete dataset.</a></li>
  <li><a href="#if-a-combination-is-missing-you-can-create-a-new-row-with-explicit-missing-values." id="toc-if-a-combination-is-missing-you-can-create-a-new-row-with-explicit-missing-values." class="nav-link" data-scroll-target="#if-a-combination-is-missing-you-can-create-a-new-row-with-explicit-missing-values.">- If a combination is missing, you can create a new row with explicit missing values.</a></li>
  <li><a href="#for-example-if-you-expect-every-participant-each-has-a-unique-pid-to-have-an-observation-for-each-visit-you-could-use-the-function-complete-to-create-that-new-row-and-plug-in-values-of-na-for-the-missing-data." id="toc-for-example-if-you-expect-every-participant-each-has-a-unique-pid-to-have-an-observation-for-each-visit-you-could-use-the-function-complete-to-create-that-new-row-and-plug-in-values-of-na-for-the-missing-data." class="nav-link" data-scroll-target="#for-example-if-you-expect-every-participant-each-has-a-unique-pid-to-have-an-observation-for-each-visit-you-could-use-the-function-complete-to-create-that-new-row-and-plug-in-values-of-na-for-the-missing-data.">- For example, if you expect every participant (each has a unique <code>pid</code>) to have an observation for each <code>visit</code>, you could use the function <code>complete()</code> to create that new row and plug in values of <code>NA</code> for the missing data.</a></li>
  <li><a href="#section-33" id="toc-section-33" class="nav-link" data-scroll-target="#section-33"></a></li>
  <li><a href="#study_data_full---study_data-completepid-visit" id="toc-study_data_full---study_data-completepid-visit" class="nav-link" data-scroll-target="#study_data_full---study_data-completepid-visit"><code># study_data_full &lt;- study_data |&gt;  #   complete(pid, visit) #</code></a></li>
  <li><a href="#section-34" id="toc-section-34" class="nav-link" data-scroll-target="#section-34"></a></li>
  <li><a href="#dealing-with-missing-data" id="toc-dealing-with-missing-data" class="nav-link" data-scroll-target="#dealing-with-missing-data">## Dealing with missing data</a></li>
  <li><a href="#section-35" id="toc-section-35" class="nav-link" data-scroll-target="#section-35"></a></li>
  <li><a href="#if-you-have-explicit-missing-data-there-are-3-main-ways-of-proceeding" id="toc-if-you-have-explicit-missing-data-there-are-3-main-ways-of-proceeding" class="nav-link" data-scroll-target="#if-you-have-explicit-missing-data-there-are-3-main-ways-of-proceeding">If you have <strong>explicit</strong> missing data, there are 3 main ways of proceeding:</a></li>
  <li><a href="#section-36" id="toc-section-36" class="nav-link" data-scroll-target="#section-36"></a></li>
  <li><a href="#section-37" id="toc-section-37" class="nav-link" data-scroll-target="#section-37">:::</a></li>
  <li><a href="#section-38" id="toc-section-38" class="nav-link" data-scroll-target="#section-38"></a></li>
  <li><a href="#drop-the-cases-or-rows-with-any-missing-data-from-the-analysisa-complete-case-analysis" id="toc-drop-the-cases-or-rows-with-any-missing-data-from-the-analysisa-complete-case-analysis" class="nav-link" data-scroll-target="#drop-the-cases-or-rows-with-any-missing-data-from-the-analysisa-complete-case-analysis">1. Drop the cases or rows with any missing data from the analysis‚Äìa <strong>complete case analysis</strong></a></li>
  <li><a href="#pro-easy-to-implement" id="toc-pro-easy-to-implement" class="nav-link" data-scroll-target="#pro-easy-to-implement">- Pro: Easy to implement</a></li>
  <li><a href="#con-reduces-sample-size-introduces-bias-if-the-missing-data-is-not-missing-completely-at-random" id="toc-con-reduces-sample-size-introduces-bias-if-the-missing-data-is-not-missing-completely-at-random" class="nav-link" data-scroll-target="#con-reduces-sample-size-introduces-bias-if-the-missing-data-is-not-missing-completely-at-random">- Con: reduces sample size, introduces bias if the missing data is not ‚Äúmissing completely at random‚Äù</a></li>
  <li><a href="#section-39" id="toc-section-39" class="nav-link" data-scroll-target="#section-39"></a></li>
  <li><a href="#create-a-category-for-missing-values." id="toc-create-a-category-for-missing-values." class="nav-link" data-scroll-target="#create-a-category-for-missing-values.">2. Create a category for missing values.</a></li>
  <li><a href="#example-the-survey-question-what-is-your-gender-might-only-provide-two-possible-responses-male-and-female.-missing-values-for-this-could-indicate-that-the-respondent-uses-a-non-binary-designation.-instead-of-dropping-these-cases-treating-the-missing-data-as-its-own-category-does-not-wish-to-answer-would-be-more-appropriate." id="toc-example-the-survey-question-what-is-your-gender-might-only-provide-two-possible-responses-male-and-female.-missing-values-for-this-could-indicate-that-the-respondent-uses-a-non-binary-designation.-instead-of-dropping-these-cases-treating-the-missing-data-as-its-own-category-does-not-wish-to-answer-would-be-more-appropriate." class="nav-link" data-scroll-target="#example-the-survey-question-what-is-your-gender-might-only-provide-two-possible-responses-male-and-female.-missing-values-for-this-could-indicate-that-the-respondent-uses-a-non-binary-designation.-instead-of-dropping-these-cases-treating-the-missing-data-as-its-own-category-does-not-wish-to-answer-would-be-more-appropriate.">- Example: The survey question ‚ÄúWhat is your gender?‚Äù might only provide two possible responses: ‚Äúmale‚Äù and ‚Äúfemale‚Äù. Missing values for this could indicate that the respondent uses a non-binary designation. Instead of dropping these cases, treating the missing data as its own category (‚ÄúDoes not wish to answer‚Äù) would be more appropriate.</a></li>
  <li><a href="#pros-maintains-sample-size-may-help-us-if-data-is-missing-not-at-random" id="toc-pros-maintains-sample-size-may-help-us-if-data-is-missing-not-at-random" class="nav-link" data-scroll-target="#pros-maintains-sample-size-may-help-us-if-data-is-missing-not-at-random">- Pros: Maintains sample size, may help us if data is ‚Äúmissing not at random‚Äù</a></li>
  <li><a href="#cons-not-directly-applicable-to-continuous-outcomes-could-include-interactions-with-a-categorical-version-in-models-to-account-for-it" id="toc-cons-not-directly-applicable-to-continuous-outcomes-could-include-interactions-with-a-categorical-version-in-models-to-account-for-it" class="nav-link" data-scroll-target="#cons-not-directly-applicable-to-continuous-outcomes-could-include-interactions-with-a-categorical-version-in-models-to-account-for-it">- Cons: Not directly applicable to continuous outcomes (could include interactions with a categorical version in models to account for it)</a></li>
  <li><a href="#section-40" id="toc-section-40" class="nav-link" data-scroll-target="#section-40"></a></li>
  <li><a href="#impute-or-fill-in-values-for-the-missing-data-using-imputation-algorithms." id="toc-impute-or-fill-in-values-for-the-missing-data-using-imputation-algorithms." class="nav-link" data-scroll-target="#impute-or-fill-in-values-for-the-missing-data-using-imputation-algorithms.">3. <strong>Impute</strong> (or fill in values for) the missing data using imputation algorithms.</a></li>
  <li><a href="#imputation-algorithms-can-be-as-simple-as-replacing-missing-values-with-the-mean-of-the-non-missing-values-very-simplistic." id="toc-imputation-algorithms-can-be-as-simple-as-replacing-missing-values-with-the-mean-of-the-non-missing-values-very-simplistic." class="nav-link" data-scroll-target="#imputation-algorithms-can-be-as-simple-as-replacing-missing-values-with-the-mean-of-the-non-missing-values-very-simplistic.">- Imputation algorithms can be as simple as replacing missing values with the mean of the non-missing values (very simplistic).</a></li>
  <li><a href="#regression-imputation-algorithms-use-models-to-predict-missing-values-as-a-function-of-other-variables-in-the-data." id="toc-regression-imputation-algorithms-use-models-to-predict-missing-values-as-a-function-of-other-variables-in-the-data." class="nav-link" data-scroll-target="#regression-imputation-algorithms-use-models-to-predict-missing-values-as-a-function-of-other-variables-in-the-data.">- Regression imputation algorithms use models to predict missing values as a function of other variables in the data.</a></li>
  <li><a href="#pros-maintains-sample-size-multiple-regression-imputation-minimizes-bias-if-missing-at-random" id="toc-pros-maintains-sample-size-multiple-regression-imputation-minimizes-bias-if-missing-at-random" class="nav-link" data-scroll-target="#pros-maintains-sample-size-multiple-regression-imputation-minimizes-bias-if-missing-at-random">- Pros: Maintains sample size, multiple regression imputation minimizes bias if ‚Äúmissing at random‚Äù</a></li>
  <li><a href="#cons-computationally-intensive" id="toc-cons-computationally-intensive" class="nav-link" data-scroll-target="#cons-computationally-intensive">- Cons: Computationally intensive</a></li>
  <li><a href="#section-41" id="toc-section-41" class="nav-link" data-scroll-target="#section-41">:::</a></li>
  <li><a href="#section-42" id="toc-section-42" class="nav-link" data-scroll-target="#section-42"></a></li>
  <li><a href="#section-43" id="toc-section-43" class="nav-link" data-scroll-target="#section-43"></a></li>
  <li><a href="#deciding-between-these-options-and-proceeding-with-choosing-finer-details-within-an-option-requires-an-understanding-of-the-mechanism-by-which-data-become-missing." id="toc-deciding-between-these-options-and-proceeding-with-choosing-finer-details-within-an-option-requires-an-understanding-of-the-mechanism-by-which-data-become-missing." class="nav-link" data-scroll-target="#deciding-between-these-options-and-proceeding-with-choosing-finer-details-within-an-option-requires-an-understanding-of-the-mechanism-by-which-data-become-missing.">Deciding between these options and proceeding with choosing finer details within an option requires an understanding of the <strong>mechanism</strong> by which data become missing.</a></li>
  <li><a href="#section-44" id="toc-section-44" class="nav-link" data-scroll-target="#section-44"></a></li>
  <li><a href="#section-45" id="toc-section-45" class="nav-link" data-scroll-target="#section-45"></a></li>
  <li><a href="#section-46" id="toc-section-46" class="nav-link" data-scroll-target="#section-46"></a></li>
  <li><a href="#missing-data-mechanisms" id="toc-missing-data-mechanisms" class="nav-link" data-scroll-target="#missing-data-mechanisms">## Missing Data Mechanisms</a></li>
  <li><a href="#section-47" id="toc-section-47" class="nav-link" data-scroll-target="#section-47"></a></li>
  <li><a href="#the-reasons-for-which-a-variable-might-have-missing-data-are-divided-into-3-mechanisms-mcar-mar-and-mnar." id="toc-the-reasons-for-which-a-variable-might-have-missing-data-are-divided-into-3-mechanisms-mcar-mar-and-mnar." class="nav-link" data-scroll-target="#the-reasons-for-which-a-variable-might-have-missing-data-are-divided-into-3-mechanisms-mcar-mar-and-mnar.">The reasons for which a variable might have missing data are divided into 3 mechanisms: MCAR, MAR, and MNAR.</a></li>
  <li><a href="#section-48" id="toc-section-48" class="nav-link" data-scroll-target="#section-48"></a></li>
  <li><a href="#within-a-dataset-multiple-mechanisms-may-be-presentwe-need-to-consider-the-missingness-mechanism-for-each-variable-individually." id="toc-within-a-dataset-multiple-mechanisms-may-be-presentwe-need-to-consider-the-missingness-mechanism-for-each-variable-individually." class="nav-link" data-scroll-target="#within-a-dataset-multiple-mechanisms-may-be-presentwe-need-to-consider-the-missingness-mechanism-for-each-variable-individually.">Within a dataset, multiple mechanisms may be present‚Äìwe need to consider the missingness mechanism for each variable individually.</a></li>
  <li><a href="#section-49" id="toc-section-49" class="nav-link" data-scroll-target="#section-49"></a></li>
  <li><a href="#section-50" id="toc-section-50" class="nav-link" data-scroll-target="#section-50">:::</a></li>
  <li><a href="#missing-completely-at-random-mcar" id="toc-missing-completely-at-random-mcar" class="nav-link" data-scroll-target="#missing-completely-at-random-mcar">- <strong>Missing completely at random (MCAR)</strong>:</a></li>
  <li><a href="#the-probability-of-missing-data-for-a-variable-is-the-same-for-all-cases.-implies-that-causes-of-the-missing-data-are-unrelated-to-the-data.-httpsstefvanbuuren.namefimdsec-mcar.html" id="toc-the-probability-of-missing-data-for-a-variable-is-the-same-for-all-cases.-implies-that-causes-of-the-missing-data-are-unrelated-to-the-data.-httpsstefvanbuuren.namefimdsec-mcar.html" class="nav-link" data-scroll-target="#the-probability-of-missing-data-for-a-variable-is-the-same-for-all-cases.-implies-that-causes-of-the-missing-data-are-unrelated-to-the-data.-httpsstefvanbuuren.namefimdsec-mcar.html">- The probability of missing data for a variable is the same for all cases. Implies that causes of the missing data are unrelated to the data. (https://stefvanbuuren.name/fimd/sec-MCAR.html)</a></li>
  <li><a href="#examples" id="toc-examples" class="nav-link" data-scroll-target="#examples">- Examples:</a></li>
  <li><a href="#measurement-device-that-runs-out-of-batteries-causes-the-remainder-of-observations-for-the-day-to-be-missing." id="toc-measurement-device-that-runs-out-of-batteries-causes-the-remainder-of-observations-for-the-day-to-be-missing." class="nav-link" data-scroll-target="#measurement-device-that-runs-out-of-batteries-causes-the-remainder-of-observations-for-the-day-to-be-missing.">- Measurement device that runs out of batteries causes the remainder of observations for the day to be missing.</a></li>
  <li><a href="#data-entry-software-requires-a-particular-field-to-be-typo-free-and-missing-values-are-introduced-when-there-are-typos." id="toc-data-entry-software-requires-a-particular-field-to-be-typo-free-and-missing-values-are-introduced-when-there-are-typos." class="nav-link" data-scroll-target="#data-entry-software-requires-a-particular-field-to-be-typo-free-and-missing-values-are-introduced-when-there-are-typos.">- Data entry software requires a particular field to be typo-free, and missing values are introduced when there are typos.</a></li>
  <li><a href="#implications-for-downstream-work" id="toc-implications-for-downstream-work" class="nav-link" data-scroll-target="#implications-for-downstream-work">- Implications for downstream work:</a></li>
  <li><a href="#if-a-variable-has-mcar-missingness-a-complete-case-analysis-will-be-unbiased-still-valid." id="toc-if-a-variable-has-mcar-missingness-a-complete-case-analysis-will-be-unbiased-still-valid." class="nav-link" data-scroll-target="#if-a-variable-has-mcar-missingness-a-complete-case-analysis-will-be-unbiased-still-valid.">- If a variable has MCAR missingness, a complete case analysis will be unbiased (still valid).</a></li>
  <li><a href="#however-with-a-lot-of-missing-observations-a-complete-case-analysis-will-suffer-from-loss-of-statistical-power-ability-to-detect-a-real-difference-and-imputation-will-be-useful-to-retain-the-original-sample-size." id="toc-however-with-a-lot-of-missing-observations-a-complete-case-analysis-will-suffer-from-loss-of-statistical-power-ability-to-detect-a-real-difference-and-imputation-will-be-useful-to-retain-the-original-sample-size." class="nav-link" data-scroll-target="#however-with-a-lot-of-missing-observations-a-complete-case-analysis-will-suffer-from-loss-of-statistical-power-ability-to-detect-a-real-difference-and-imputation-will-be-useful-to-retain-the-original-sample-size.">- However, with a lot of missing observations, a complete case analysis will suffer from loss of statistical power (ability to detect a real difference), and imputation will be useful to retain the original sample size.</a></li>
  <li><a href="#section-51" id="toc-section-51" class="nav-link" data-scroll-target="#section-51"></a></li>
  <li><a href="#missing-at-random-mar" id="toc-missing-at-random-mar" class="nav-link" data-scroll-target="#missing-at-random-mar">- <strong>Missing at random (MAR):</strong></a></li>
  <li><a href="#the-probability-of-missing-data-is-related-to-observed-variables-but-unrelated-to-unobserved-information." id="toc-the-probability-of-missing-data-is-related-to-observed-variables-but-unrelated-to-unobserved-information." class="nav-link" data-scroll-target="#the-probability-of-missing-data-is-related-to-observed-variables-but-unrelated-to-unobserved-information.">- The probability of missing data is related to <strong>observed</strong> variables but unrelated to unobserved information.</a></li>
  <li><a href="#examples-1" id="toc-examples-1" class="nav-link" data-scroll-target="#examples-1">- Examples:</a></li>
  <li><a href="#blood-pressure-measurements-tend-to-be-missing-in-patients-in-worse-health.-those-in-worse-health-are-more-likely-to-miss-clinic-visits.-better-and-worse-health-can-be-measured-by-a-variety-of-indicators-in-their-health-record." id="toc-blood-pressure-measurements-tend-to-be-missing-in-patients-in-worse-health.-those-in-worse-health-are-more-likely-to-miss-clinic-visits.-better-and-worse-health-can-be-measured-by-a-variety-of-indicators-in-their-health-record." class="nav-link" data-scroll-target="#blood-pressure-measurements-tend-to-be-missing-in-patients-in-worse-health.-those-in-worse-health-are-more-likely-to-miss-clinic-visits.-better-and-worse-health-can-be-measured-by-a-variety-of-indicators-in-their-health-record.">- Blood pressure measurements tend to be missing in patients in worse health. (Those in worse health are more likely to miss clinic visits.) Better and worse health can be measured by a variety of indicators in their health record.</a></li>
  <li><a href="#in-a-survey-older-people-are-more-likely-to-report-their-income-than-younger-people.-missingness-is-related-to-the-observed-age-variable-but-not-to-unobserved-information." id="toc-in-a-survey-older-people-are-more-likely-to-report-their-income-than-younger-people.-missingness-is-related-to-the-observed-age-variable-but-not-to-unobserved-information." class="nav-link" data-scroll-target="#in-a-survey-older-people-are-more-likely-to-report-their-income-than-younger-people.-missingness-is-related-to-the-observed-age-variable-but-not-to-unobserved-information.">- In a survey, older people are more likely to report their income than younger people. Missingness is related to the observed age variable, but not to unobserved information.</a></li>
  <li><a href="#implications-for-downstream-work-1" id="toc-implications-for-downstream-work-1" class="nav-link" data-scroll-target="#implications-for-downstream-work-1">- Implications for downstream work:</a></li>
  <li><a href="#try-to-use-imputation-methods-that-predict-the-value-of-the-missing-variables-from-other-observed-variables.-assessing-whether-this-can-be-done-accurately-takes-some-explorationwell-explore-this-shortly." id="toc-try-to-use-imputation-methods-that-predict-the-value-of-the-missing-variables-from-other-observed-variables.-assessing-whether-this-can-be-done-accurately-takes-some-explorationwell-explore-this-shortly." class="nav-link" data-scroll-target="#try-to-use-imputation-methods-that-predict-the-value-of-the-missing-variables-from-other-observed-variables.-assessing-whether-this-can-be-done-accurately-takes-some-explorationwell-explore-this-shortly.">- Try to use imputation methods that predict the value of the missing variables from other observed variables. Assessing whether this can be done accurately takes some exploration‚Äìwe‚Äôll explore this shortly.</a></li>
  <li><a href="#section-52" id="toc-section-52" class="nav-link" data-scroll-target="#section-52"></a></li>
  <li><a href="#missing-not-at-random-mnar" id="toc-missing-not-at-random-mnar" class="nav-link" data-scroll-target="#missing-not-at-random-mnar">- <strong>Missing not at random (MNAR):</strong></a></li>
  <li><a href="#the-probability-of-missing-data-is-related-to-unobserved-variables-and-probably-observed-variables-too." id="toc-the-probability-of-missing-data-is-related-to-unobserved-variables-and-probably-observed-variables-too." class="nav-link" data-scroll-target="#the-probability-of-missing-data-is-related-to-unobserved-variables-and-probably-observed-variables-too.">- The probability of missing data is related to <strong>unobserved</strong> variables (and probably observed variables too).</a></li>
  <li><a href="#examples-2" id="toc-examples-2" class="nav-link" data-scroll-target="#examples-2">- Examples:</a></li>
  <li><a href="#blood-pressure-measurements-are-more-likely-to-be-missing-for-those-with-the-highest-blood-pressure.-this-is-mnar-rather-than-mar-because-the-missing-data-on-blood-pressure-is-related-to-the-unobserved-values-themselves." id="toc-blood-pressure-measurements-are-more-likely-to-be-missing-for-those-with-the-highest-blood-pressure.-this-is-mnar-rather-than-mar-because-the-missing-data-on-blood-pressure-is-related-to-the-unobserved-values-themselves." class="nav-link" data-scroll-target="#blood-pressure-measurements-are-more-likely-to-be-missing-for-those-with-the-highest-blood-pressure.-this-is-mnar-rather-than-mar-because-the-missing-data-on-blood-pressure-is-related-to-the-unobserved-values-themselves.">- Blood pressure measurements are more likely to be missing for those with the highest blood pressure. This is MNAR rather than MAR because the missing data on blood pressure is related to the unobserved values themselves.</a></li>
  <li><a href="#high-income-individuals-may-be-less-likely-to-report-their-income." id="toc-high-income-individuals-may-be-less-likely-to-report-their-income." class="nav-link" data-scroll-target="#high-income-individuals-may-be-less-likely-to-report-their-income.">- High-income individuals may be less likely to report their income.</a></li>
  <li><a href="#implications-for-downstream-work-2" id="toc-implications-for-downstream-work-2" class="nav-link" data-scroll-target="#implications-for-downstream-work-2">- Implications for downstream work:</a></li>
  <li><a href="#ideally-we-would-learn-more-about-the-causes-for-the-missingness.-this-could-allow-us-to-use-more-informed-imputation-models." id="toc-ideally-we-would-learn-more-about-the-causes-for-the-missingness.-this-could-allow-us-to-use-more-informed-imputation-models." class="nav-link" data-scroll-target="#ideally-we-would-learn-more-about-the-causes-for-the-missingness.-this-could-allow-us-to-use-more-informed-imputation-models.">- Ideally, we would learn more about the causes for the missingness. This could allow us to use more informed imputation models.</a></li>
  <li><a href="#example-biological-measurements-that-tend-to-be-missing-because-of-concentrations-that-are-too-low-a-phenomenon-known-as-left-censoring.-imputation-methods-specifically-suited-to-left-censoring-are-useful-here." id="toc-example-biological-measurements-that-tend-to-be-missing-because-of-concentrations-that-are-too-low-a-phenomenon-known-as-left-censoring.-imputation-methods-specifically-suited-to-left-censoring-are-useful-here." class="nav-link" data-scroll-target="#example-biological-measurements-that-tend-to-be-missing-because-of-concentrations-that-are-too-low-a-phenomenon-known-as-left-censoring.-imputation-methods-specifically-suited-to-left-censoring-are-useful-here.">- Example: Biological measurements that tend to be missing because of concentrations that are too low (a phenomenon known as left-censoring). Imputation methods specifically suited to left-censoring are useful here.</a></li>
  <li><a href="#we-can-use-imputation-methods-with-different-assumptions-about-the-missing-data-and-try-out-a-variety-of-assumptions.-this-lets-us-see-how-sensitive-the-results-are-under-various-scenarios." id="toc-we-can-use-imputation-methods-with-different-assumptions-about-the-missing-data-and-try-out-a-variety-of-assumptions.-this-lets-us-see-how-sensitive-the-results-are-under-various-scenarios." class="nav-link" data-scroll-target="#we-can-use-imputation-methods-with-different-assumptions-about-the-missing-data-and-try-out-a-variety-of-assumptions.-this-lets-us-see-how-sensitive-the-results-are-under-various-scenarios.">- We can use imputation methods with different assumptions about the missing data and try out a variety of assumptions. This lets us see how sensitive the results are under various scenarios.</a></li>
  <li><a href="#example-if-higher-incomes-are-more-likely-to-be-missing-we-can-make-different-assumptions-about-what-high-could-be-to-fill-in-the-missing-values-and-see-how-our-results-change-under-these-different-assumptions." id="toc-example-if-higher-incomes-are-more-likely-to-be-missing-we-can-make-different-assumptions-about-what-high-could-be-to-fill-in-the-missing-values-and-see-how-our-results-change-under-these-different-assumptions." class="nav-link" data-scroll-target="#example-if-higher-incomes-are-more-likely-to-be-missing-we-can-make-different-assumptions-about-what-high-could-be-to-fill-in-the-missing-values-and-see-how-our-results-change-under-these-different-assumptions.">- Example: If higher incomes are more likely to be missing, we can make different assumptions about what ‚Äúhigh‚Äù could be to fill in the missing values and see how our results change under these different assumptions.</a></li>
  <li><a href="#section-53" id="toc-section-53" class="nav-link" data-scroll-target="#section-53"></a></li>
  <li><a href="#section-54" id="toc-section-54" class="nav-link" data-scroll-target="#section-54">:::</a></li>
  <li><a href="#section-55" id="toc-section-55" class="nav-link" data-scroll-target="#section-55"></a></li>
  <li><a href="#exercise" id="toc-exercise" class="nav-link" data-scroll-target="#exercise">## Exercise</a></li>
  <li><a href="#section-56" id="toc-section-56" class="nav-link" data-scroll-target="#section-56"></a></li>
  <li><a href="#missing-data-mechanism-for-each-of-the-following-situations-propose-what-missing-data-mechanism-you-think-is-most-likely-at-play." id="toc-missing-data-mechanism-for-each-of-the-following-situations-propose-what-missing-data-mechanism-you-think-is-most-likely-at-play." class="nav-link" data-scroll-target="#missing-data-mechanism-for-each-of-the-following-situations-propose-what-missing-data-mechanism-you-think-is-most-likely-at-play.">1. <strong>Missing data mechanism</strong> For each of the following situations, propose what missing data mechanism you think is most likely at play.</a></li>
  <li><a href="#a.-in-a-clinical-trial-some-patients-dropped-out-before-the-end-of-the-study.-their-reasons-for-dropping-out-were-not-recorded." id="toc-a.-in-a-clinical-trial-some-patients-dropped-out-before-the-end-of-the-study.-their-reasons-for-dropping-out-were-not-recorded." class="nav-link" data-scroll-target="#a.-in-a-clinical-trial-some-patients-dropped-out-before-the-end-of-the-study.-their-reasons-for-dropping-out-were-not-recorded.">a. In a clinical trial, some patients dropped out before the end of the study. Their reasons for dropping out were not recorded.</a></li>
  <li><a href="#mnar-probably-the-chance-of-missingness-is-likely-due-to-factors-that-arent-recorded-like-discomfort." id="toc-mnar-probably-the-chance-of-missingness-is-likely-due-to-factors-that-arent-recorded-like-discomfort." class="nav-link" data-scroll-target="#mnar-probably-the-chance-of-missingness-is-likely-due-to-factors-that-arent-recorded-like-discomfort.">MNAR probably: The chance of missingness is likely due to factors that aren‚Äôt recorded (like discomfort).</a></li>
  <li><a href="#b.-a-weather-station-records-temperature-humidity-and-wind-speed-every-hour.-some-of-the-recorded-values-are-missing." id="toc-b.-a-weather-station-records-temperature-humidity-and-wind-speed-every-hour.-some-of-the-recorded-values-are-missing." class="nav-link" data-scroll-target="#b.-a-weather-station-records-temperature-humidity-and-wind-speed-every-hour.-some-of-the-recorded-values-are-missing.">b. A weather station records temperature, humidity, and wind speed every hour. Some of the recorded values are missing.</a></li>
  <li><a href="#could-be-mcar-if-the-missing-values-are-from-technical-glitches.-could-be-mar-if-the-missing-values-are-related-to-other-measured-weather-variables.-could-be-mnar-if-the-values-tend-to-be-missing-when-the-values-themselves-are-high-e.g.-high-temperature-humidity-and-wind-speed-causing-measurement-devices-to-malfunction." id="toc-could-be-mcar-if-the-missing-values-are-from-technical-glitches.-could-be-mar-if-the-missing-values-are-related-to-other-measured-weather-variables.-could-be-mnar-if-the-values-tend-to-be-missing-when-the-values-themselves-are-high-e.g.-high-temperature-humidity-and-wind-speed-causing-measurement-devices-to-malfunction." class="nav-link" data-scroll-target="#could-be-mcar-if-the-missing-values-are-from-technical-glitches.-could-be-mar-if-the-missing-values-are-related-to-other-measured-weather-variables.-could-be-mnar-if-the-values-tend-to-be-missing-when-the-values-themselves-are-high-e.g.-high-temperature-humidity-and-wind-speed-causing-measurement-devices-to-malfunction.">Could be MCAR if the missing values are from technical glitches. Could be MAR if the missing values are related to other measured weather variables. Could be MNAR if the values tend to be missing when the values themselves are high (e.g., high temperature, humidity, and wind speed causing measurement devices to malfunction).</a></li>
  <li><a href="#c.-a-social-media-platform-collects-data-on-user-interactions-such-as-likes-comments-and-shares.-some-interactions-are-not-recorded-due-to-bugs-in-the-code." id="toc-c.-a-social-media-platform-collects-data-on-user-interactions-such-as-likes-comments-and-shares.-some-interactions-are-not-recorded-due-to-bugs-in-the-code." class="nav-link" data-scroll-target="#c.-a-social-media-platform-collects-data-on-user-interactions-such-as-likes-comments-and-shares.-some-interactions-are-not-recorded-due-to-bugs-in-the-code.">c.&nbsp;A social media platform collects data on user interactions, such as likes, comments, and shares. Some interactions are not recorded due to bugs in the code.</a></li>
  <li><a href="#could-be-mcar-if-the-bugs-affected-the-platform-uniformly.-could-be-mar-if-the-bugs-affected-groups-of-users-differently-but-where-the-groupings-are-known-e.g.-bugs-affect-mobile-users-more-and-mobile-vs.-desktop-usage-is-measurable.-could-be-mnar-if-the-bugs-lead-to-performance-issues-that-affect-users-with-slower-internet-more-where-internet-speed-is-likely-not-measured." id="toc-could-be-mcar-if-the-bugs-affected-the-platform-uniformly.-could-be-mar-if-the-bugs-affected-groups-of-users-differently-but-where-the-groupings-are-known-e.g.-bugs-affect-mobile-users-more-and-mobile-vs.-desktop-usage-is-measurable.-could-be-mnar-if-the-bugs-lead-to-performance-issues-that-affect-users-with-slower-internet-more-where-internet-speed-is-likely-not-measured." class="nav-link" data-scroll-target="#could-be-mcar-if-the-bugs-affected-the-platform-uniformly.-could-be-mar-if-the-bugs-affected-groups-of-users-differently-but-where-the-groupings-are-known-e.g.-bugs-affect-mobile-users-more-and-mobile-vs.-desktop-usage-is-measurable.-could-be-mnar-if-the-bugs-lead-to-performance-issues-that-affect-users-with-slower-internet-more-where-internet-speed-is-likely-not-measured.">Could be MCAR if the bugs affected the platform uniformly. Could be MAR if the bugs affected groups of users differently, but where the groupings are known (e.g., bugs affect mobile users more and mobile vs.&nbsp;desktop usage is measurable). Could be MNAR if the bugs lead to performance issues that affect users with slower internet more (where internet speed is likely not measured).</a></li>
  <li><a href="#section-57" id="toc-section-57" class="nav-link" data-scroll-target="#section-57"></a></li>
  <li><a href="#section-58" id="toc-section-58" class="nav-link" data-scroll-target="#section-58"></a></li>
  <li><a href="#section-59" id="toc-section-59" class="nav-link" data-scroll-target="#section-59"></a></li>
  <li><a href="#exploring-missing-data" id="toc-exploring-missing-data" class="nav-link" data-scroll-target="#exploring-missing-data">## Exploring Missing Data</a></li>
  <li><a href="#section-60" id="toc-section-60" class="nav-link" data-scroll-target="#section-60"></a></li>
  <li><a href="#guiding-question-how-can-we-use-visualizations-and-tabulations-to-explore-what-missing-data-mechanisms-may-be-at-play" id="toc-guiding-question-how-can-we-use-visualizations-and-tabulations-to-explore-what-missing-data-mechanisms-may-be-at-play" class="nav-link" data-scroll-target="#guiding-question-how-can-we-use-visualizations-and-tabulations-to-explore-what-missing-data-mechanisms-may-be-at-play"><strong>Guiding question:</strong> How can we use visualizations and tabulations to explore what missing data mechanisms may be at play?</a></li>
  <li><a href="#section-61" id="toc-section-61" class="nav-link" data-scroll-target="#section-61"></a></li>
  <li><a href="#well-look-at-the-airquality-dataset-available-in-base-r-which-gives-daily-air-quality-measurements-in-new-york-from-may-to-september-1973.-you-can-pull-up-the-codebook-with-airquality-in-the-console." id="toc-well-look-at-the-airquality-dataset-available-in-base-r-which-gives-daily-air-quality-measurements-in-new-york-from-may-to-september-1973.-you-can-pull-up-the-codebook-with-airquality-in-the-console." class="nav-link" data-scroll-target="#well-look-at-the-airquality-dataset-available-in-base-r-which-gives-daily-air-quality-measurements-in-new-york-from-may-to-september-1973.-you-can-pull-up-the-codebook-with-airquality-in-the-console.">We‚Äôll look at the <code>airquality</code> dataset available in base R, which gives daily air quality measurements in New York from May to September 1973. You can pull up the codebook with <code>?airquality</code> in the Console.</a></li>
  <li><a href="#section-62" id="toc-section-62" class="nav-link" data-scroll-target="#section-62"></a></li>
  <li><a href="#r-load_airqual-eval-true-dataairquality" id="toc-r-load_airqual-eval-true-dataairquality" class="nav-link" data-scroll-target="#r-load_airqual-eval-true-dataairquality"><code>{r load_airqual} # #| eval: true # data(airquality) #</code></a></li>
  <li><a href="#section-63" id="toc-section-63" class="nav-link" data-scroll-target="#section-63"></a></li>
  <li><a href="#missingness-by-variable" id="toc-missingness-by-variable" class="nav-link" data-scroll-target="#missingness-by-variable">## Missingness by Variable</a></li>
  <li><a href="#section-64" id="toc-section-64" class="nav-link" data-scroll-target="#section-64"></a></li>
  <li><a href="#we-can-explore-how-much-missingness-there-is-for-each-variable-with-the-following-functions" id="toc-we-can-explore-how-much-missingness-there-is-for-each-variable-with-the-following-functions" class="nav-link" data-scroll-target="#we-can-explore-how-much-missingness-there-is-for-each-variable-with-the-following-functions">We can explore how much missingness there is for each variable with the following functions:</a></li>
  <li><a href="#section-65" id="toc-section-65" class="nav-link" data-scroll-target="#section-65"></a></li>
  <li><a href="#r-miss_by_var-eval-true-summaryairquality-summary-statistics-in-addition-to-number-of-nas-naniarvis_missairquality-where-are-nas-located-naniarmiss_var_summaryairquality-information-from-vis_miss-in-table-form" id="toc-r-miss_by_var-eval-true-summaryairquality-summary-statistics-in-addition-to-number-of-nas-naniarvis_missairquality-where-are-nas-located-naniarmiss_var_summaryairquality-information-from-vis_miss-in-table-form" class="nav-link" data-scroll-target="#r-miss_by_var-eval-true-summaryairquality-summary-statistics-in-addition-to-number-of-nas-naniarvis_missairquality-where-are-nas-located-naniarmiss_var_summaryairquality-information-from-vis_miss-in-table-form"><code>{r miss_by_var} # #| eval: true # summary(airquality) # Summary statistics in addition to number of NA's # naniar::vis_miss(airquality) # Where are NA's located? # naniar::miss_var_summary(airquality) # Information from vis_miss() in table form #</code></a></li>
  <li><a href="#section-66" id="toc-section-66" class="nav-link" data-scroll-target="#section-66"></a></li>
  <li><a href="#missingness-by-case" id="toc-missingness-by-case" class="nav-link" data-scroll-target="#missingness-by-case">## Missingness by Case</a></li>
  <li><a href="#section-67" id="toc-section-67" class="nav-link" data-scroll-target="#section-67"></a></li>
  <li><a href="#we-can-explore-how-much-missingness-there-is-for-each-case-with-naniarmiss_case_summary." id="toc-we-can-explore-how-much-missingness-there-is-for-each-case-with-naniarmiss_case_summary." class="nav-link" data-scroll-target="#we-can-explore-how-much-missingness-there-is-for-each-case-with-naniarmiss_case_summary.">We can explore how much missingness there is for each case with <code>naniar::miss_case_summary()</code>.</a></li>
  <li><a href="#for-each-case-this-function-calculates-the-number-and-percentage-of-variables-with-a-missing-value." id="toc-for-each-case-this-function-calculates-the-number-and-percentage-of-variables-with-a-missing-value." class="nav-link" data-scroll-target="#for-each-case-this-function-calculates-the-number-and-percentage-of-variables-with-a-missing-value.">For each case, this function calculates the number and percentage of variables with a missing value.</a></li>
  <li><a href="#section-68" id="toc-section-68" class="nav-link" data-scroll-target="#section-68"></a></li>
  <li><a href="#section-69" id="toc-section-69" class="nav-link" data-scroll-target="#section-69"></a></li>
  <li><a href="#impact-of-information-if-the-pct_miss-column-is-large-for-a-case-we-likely-wont-be-able-to-impute-any-of-its-missing-values-because-there-just-isnt-enough-known-informationthis-case-will-have-to-be-dropped-from-the-analysis." id="toc-impact-of-information-if-the-pct_miss-column-is-large-for-a-case-we-likely-wont-be-able-to-impute-any-of-its-missing-values-because-there-just-isnt-enough-known-informationthis-case-will-have-to-be-dropped-from-the-analysis." class="nav-link" data-scroll-target="#impact-of-information-if-the-pct_miss-column-is-large-for-a-case-we-likely-wont-be-able-to-impute-any-of-its-missing-values-because-there-just-isnt-enough-known-informationthis-case-will-have-to-be-dropped-from-the-analysis."><strong>Impact of Information:</strong> If the <code>pct_miss</code> column is large for a case, we likely won‚Äôt be able to impute any of its missing values because there just isn‚Äôt enough known information‚Äìthis case will have to be dropped from the analysis.</a></li>
  <li><a href="#section-70" id="toc-section-70" class="nav-link" data-scroll-target="#section-70"></a></li>
  <li><a href="#r-miss_by_case-eval-true-naniarmiss_case_summaryairquality" id="toc-r-miss_by_case-eval-true-naniarmiss_case_summaryairquality" class="nav-link" data-scroll-target="#r-miss_by_case-eval-true-naniarmiss_case_summaryairquality"><code>{r miss_by_case} # #| eval: true # naniar::miss_case_summary(airquality) #</code></a></li>
  <li><a href="#section-71" id="toc-section-71" class="nav-link" data-scroll-target="#section-71"></a></li>
  <li><a href="#exploring-missingness-mechanisms" id="toc-exploring-missingness-mechanisms" class="nav-link" data-scroll-target="#exploring-missingness-mechanisms">## Exploring Missingness Mechanisms</a></li>
  <li><a href="#section-72" id="toc-section-72" class="nav-link" data-scroll-target="#section-72"></a></li>
  <li><a href="#assessing-missingness-mechanisms-involves-checking-if-missingness-in-a-variable-is-related-to-other-variables." id="toc-assessing-missingness-mechanisms-involves-checking-if-missingness-in-a-variable-is-related-to-other-variables." class="nav-link" data-scroll-target="#assessing-missingness-mechanisms-involves-checking-if-missingness-in-a-variable-is-related-to-other-variables.">Assessing missingness mechanisms involves checking if missingness in a variable is related to other variables.</a></li>
  <li><a href="#section-73" id="toc-section-73" class="nav-link" data-scroll-target="#section-73"></a></li>
  <li><a href="#note-through-our-available-data-we-are-really-only-able-to-explore-the-potential-for-mcar-or-mar-mechanisms." id="toc-note-through-our-available-data-we-are-really-only-able-to-explore-the-potential-for-mcar-or-mar-mechanisms." class="nav-link" data-scroll-target="#note-through-our-available-data-we-are-really-only-able-to-explore-the-potential-for-mcar-or-mar-mechanisms.">Note: Through our available data, we are really only able to explore the potential for MCAR or MAR mechanisms.</a></li>
  <li><a href="#section-74" id="toc-section-74" class="nav-link" data-scroll-target="#section-74"></a></li>
  <li><a href="#section-75" id="toc-section-75" class="nav-link" data-scroll-target="#section-75"></a></li>
  <li><a href="#section-76" id="toc-section-76" class="nav-link" data-scroll-target="#section-76"></a></li>
  <li><a href="#impact-of-information-there-is-always-the-chance-that-unobserved-information-unobserved-other-variables-or-unobserved-values-of-the-variables-we-do-have-is-related-to-missingness-for-our-variables-so-to-think-through-the-potential-for-mnar-more-contextual-information-is-necessary." id="toc-impact-of-information-there-is-always-the-chance-that-unobserved-information-unobserved-other-variables-or-unobserved-values-of-the-variables-we-do-have-is-related-to-missingness-for-our-variables-so-to-think-through-the-potential-for-mnar-more-contextual-information-is-necessary." class="nav-link" data-scroll-target="#impact-of-information-there-is-always-the-chance-that-unobserved-information-unobserved-other-variables-or-unobserved-values-of-the-variables-we-do-have-is-related-to-missingness-for-our-variables-so-to-think-through-the-potential-for-mnar-more-contextual-information-is-necessary."><strong>Impact of Information:</strong> There is always the chance that unobserved information (unobserved other variables or unobserved values of the variables we do have) is related to missingness for our variables, so to think through the potential for MNAR, more contextual information is necessary.</a></li>
  <li><a href="#section-77" id="toc-section-77" class="nav-link" data-scroll-target="#section-77"></a></li>
  <li><a href="#section-78" id="toc-section-78" class="nav-link" data-scroll-target="#section-78"></a></li>
  <li><a href="#section-79" id="toc-section-79" class="nav-link" data-scroll-target="#section-79"></a></li>
  <li><a href="#to-explore-these-relationships-we-can-create-truefalse-indicators-of-whether-a-variable-is-missing.-in-the-plots-below-we-use-is.naozone-to-explore-whether-cases-with-missing-ozone-values-are-noticeably-different-from-cases-with-observed-ozone-values-in-terms-of-solar.r." id="toc-to-explore-these-relationships-we-can-create-truefalse-indicators-of-whether-a-variable-is-missing.-in-the-plots-below-we-use-is.naozone-to-explore-whether-cases-with-missing-ozone-values-are-noticeably-different-from-cases-with-observed-ozone-values-in-terms-of-solar.r." class="nav-link" data-scroll-target="#to-explore-these-relationships-we-can-create-truefalse-indicators-of-whether-a-variable-is-missing.-in-the-plots-below-we-use-is.naozone-to-explore-whether-cases-with-missing-ozone-values-are-noticeably-different-from-cases-with-observed-ozone-values-in-terms-of-solar.r.">To explore these relationships, we can create TRUE/FALSE indicators of whether a variable is missing. In the plots below, we use <code>is.na(Ozone)</code> to explore whether cases with missing ozone values are noticeably different from cases with observed ozone values in terms of <code>Solar.R</code>.</a></li>
  <li><a href="#section-80" id="toc-section-80" class="nav-link" data-scroll-target="#section-80"></a></li>
  <li><a href="#r-miss_box_dens-libraryggplot2-eval-true-ggplotairquality-aesx-is.naozone-y-solar.r-geom_boxplot-ggplotairquality-aesx-solar.r-color-is.naozone-geom_density" id="toc-r-miss_box_dens-libraryggplot2-eval-true-ggplotairquality-aesx-is.naozone-y-solar.r-geom_boxplot-ggplotairquality-aesx-solar.r-color-is.naozone-geom_density" class="nav-link" data-scroll-target="#r-miss_box_dens-libraryggplot2-eval-true-ggplotairquality-aesx-is.naozone-y-solar.r-geom_boxplot-ggplotairquality-aesx-solar.r-color-is.naozone-geom_density"><code>{r miss_box_dens} # library(ggplot2) # #| eval: true # ggplot(airquality, aes(x = is.na(Ozone), y = Solar.R)) +  #     geom_boxplot() # ggplot(airquality, aes(x = Solar.R, color = is.na(Ozone))) +  #     geom_density() #</code></a></li>
  <li><a href="#section-81" id="toc-section-81" class="nav-link" data-scroll-target="#section-81"></a></li>
  <li><a href="#the-above-boxplots-and-density-plots-suggest-that-missing-ozone-is-not-strongly-related-to-solar-radiation-levels." id="toc-the-above-boxplots-and-density-plots-suggest-that-missing-ozone-is-not-strongly-related-to-solar-radiation-levels." class="nav-link" data-scroll-target="#the-above-boxplots-and-density-plots-suggest-that-missing-ozone-is-not-strongly-related-to-solar-radiation-levels.">The above boxplots and density plots suggest that missing ozone is not strongly related to solar radiation levels.</a></li>
  <li><a href="#section-82" id="toc-section-82" class="nav-link" data-scroll-target="#section-82"></a></li>
  <li><a href="#section-83" id="toc-section-83" class="nav-link" data-scroll-target="#section-83"></a></li>
  <li><a href="#we-still-should-check-if-ozone-missingness-is-related-to-the-wind-temp-month-and-day-variables-to-be-done-in-exercises." id="toc-we-still-should-check-if-ozone-missingness-is-related-to-the-wind-temp-month-and-day-variables-to-be-done-in-exercises." class="nav-link" data-scroll-target="#we-still-should-check-if-ozone-missingness-is-related-to-the-wind-temp-month-and-day-variables-to-be-done-in-exercises.">We still should check if ozone missingness is related to the <code>Wind</code>, <code>Temp</code>, <code>Month</code>, and <code>Day</code> variables (to be done in Exercises).</a></li>
  <li><a href="#section-84" id="toc-section-84" class="nav-link" data-scroll-target="#section-84"></a></li>
  <li><a href="#section-85" id="toc-section-85" class="nav-link" data-scroll-target="#section-85"></a></li>
  <li><a href="#section-86" id="toc-section-86" class="nav-link" data-scroll-target="#section-86"></a></li>
  <li><a href="#in-addition-to-checking-if-the-chance-of-ozone-missingness-is-related-to-solar.r-we-should-check-if-the-values-of-ozone-could-be-predicted-by-solar.r." id="toc-in-addition-to-checking-if-the-chance-of-ozone-missingness-is-related-to-solar.r-we-should-check-if-the-values-of-ozone-could-be-predicted-by-solar.r." class="nav-link" data-scroll-target="#in-addition-to-checking-if-the-chance-of-ozone-missingness-is-related-to-solar.r-we-should-check-if-the-values-of-ozone-could-be-predicted-by-solar.r.">In addition to checking if the <em>chance</em> of ozone missingness is related to <code>Solar.R</code>, we should check if the <em>values</em> of ozone could be predicted by <code>Solar.R</code>.</a></li>
  <li><a href="#section-87" id="toc-section-87" class="nav-link" data-scroll-target="#section-87"></a></li>
  <li><a href="#section-88" id="toc-section-88" class="nav-link" data-scroll-target="#section-88"></a></li>
  <li><a href="#in-the-scaterrplot-below-we-look-at-the-relationship-between-ozone-and-solar.r-and-use-vertical-lines-to-indicate-the-solar.r-values-for-cases-that-are-missing-ozone." id="toc-in-the-scaterrplot-below-we-look-at-the-relationship-between-ozone-and-solar.r-and-use-vertical-lines-to-indicate-the-solar.r-values-for-cases-that-are-missing-ozone." class="nav-link" data-scroll-target="#in-the-scaterrplot-below-we-look-at-the-relationship-between-ozone-and-solar.r-and-use-vertical-lines-to-indicate-the-solar.r-values-for-cases-that-are-missing-ozone.">In the scaterrplot below, we look at the relationship between <code>Ozone</code> and <code>Solar.R</code> and use vertical lines to indicate the <code>Solar.R</code> values for cases that are missing <code>Ozone</code>.</a></li>
  <li><a href="#section-89" id="toc-section-89" class="nav-link" data-scroll-target="#section-89"></a></li>
  <li><a href="#impact-of-information-we-see-that-missing-ozone-cases-are-within-the-observed-span-of-solar.r-so-we-would-be-ok-with-predicting-ozone-from-solar.r-because-there-would-be-no-extrapolation." id="toc-impact-of-information-we-see-that-missing-ozone-cases-are-within-the-observed-span-of-solar.r-so-we-would-be-ok-with-predicting-ozone-from-solar.r-because-there-would-be-no-extrapolation." class="nav-link" data-scroll-target="#impact-of-information-we-see-that-missing-ozone-cases-are-within-the-observed-span-of-solar.r-so-we-would-be-ok-with-predicting-ozone-from-solar.r-because-there-would-be-no-extrapolation.">- <strong>Impact of Information:</strong> We see that missing <code>Ozone</code> cases are within the observed span of <code>Solar.R</code>, so we would be ok with predicting <code>Ozone</code> from <code>Solar.R</code> because there would be no <strong>extrapolation</strong>.</a></li>
  <li><a href="#section-90" id="toc-section-90" class="nav-link" data-scroll-target="#section-90"></a></li>
  <li><a href="#r-miss_scatter_na_markers-eval-true-ggplotairquality-aesx-solar.r-y-ozone-geom_point-geom_smooth-geom_vlinedata-airquality-filteris.naozone-mapping-aesxintercept-solar.r" id="toc-r-miss_scatter_na_markers-eval-true-ggplotairquality-aesx-solar.r-y-ozone-geom_point-geom_smooth-geom_vlinedata-airquality-filteris.naozone-mapping-aesxintercept-solar.r" class="nav-link" data-scroll-target="#r-miss_scatter_na_markers-eval-true-ggplotairquality-aesx-solar.r-y-ozone-geom_point-geom_smooth-geom_vlinedata-airquality-filteris.naozone-mapping-aesxintercept-solar.r"><code>{r miss_scatter_na_markers} # #| eval: true # ggplot(airquality, aes(x = Solar.R, y = Ozone)) + #     geom_point() + #     geom_smooth() + #     geom_vline(data = airquality |&gt; filter(is.na(Ozone)), mapping = aes(xintercept = Solar.R)) #</code></a></li>
  <li><a href="#section-91" id="toc-section-91" class="nav-link" data-scroll-target="#section-91"></a></li>
  <li><a href="#section-92" id="toc-section-92" class="nav-link" data-scroll-target="#section-92"></a></li>
  <li><a href="#section-93" id="toc-section-93" class="nav-link" data-scroll-target="#section-93"></a></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises">## Exercises</a></li>
  <li><a href="#section-94" id="toc-section-94" class="nav-link" data-scroll-target="#section-94"></a></li>
  <li><a href="#mechanism-detection-practice-look-at-the-boxplot-scatterplot-pairs-for-alternate-situations-1-and-2-below.-how-do-these-situations-compare-to-our-actual-situation-and-to-each-other-what-concerns-might-arise-from-using-a-model-to-impute-ozone" id="toc-mechanism-detection-practice-look-at-the-boxplot-scatterplot-pairs-for-alternate-situations-1-and-2-below.-how-do-these-situations-compare-to-our-actual-situation-and-to-each-other-what-concerns-might-arise-from-using-a-model-to-impute-ozone" class="nav-link" data-scroll-target="#mechanism-detection-practice-look-at-the-boxplot-scatterplot-pairs-for-alternate-situations-1-and-2-below.-how-do-these-situations-compare-to-our-actual-situation-and-to-each-other-what-concerns-might-arise-from-using-a-model-to-impute-ozone">2. <strong>Mechanism detection practice</strong> Look at the boxplot + scatterplot pairs for Alternate Situations 1 and 2 below. How do these situations compare to our actual situation and to each other? What concerns might arise from using a model to impute <code>Ozone</code>?</a></li>
  <li><a href="#section-95" id="toc-section-95" class="nav-link" data-scroll-target="#section-95"></a></li>
  <li><a href="#r-miss_scatter_na_markers_alt-libraryreadr-librarytidyverse-eval-true-echo-false-airquality_mod---airquality-mutate-solar.r_mod1-if_elseis.naozone-250-solar.r4-solar.r-solar.r_mod2-if_elseis.naozone-250-solar.r2-solar.r-ggplotairquality_mod-aesx-is.naozone-y-solar.r_mod1-geom_boxplot-labstitle-alternate-situation-1-ggplotairquality_mod-aesx-solar.r_mod1-y-ozone-geom_point-geom_smooth-geom_vlinedata-airquality_mod-filteris.naozone-mapping-aesxintercept-solar.r_mod1-labstitle-alternate-situation-1-ggplotairquality_mod-aesx-is.naozone-y-solar.r_mod2-geom_boxplot-labstitle-alternate-situation-2-ggplotairquality_mod-aesx-solar.r_mod2-y-ozone-geom_point-geom_smooth-geom_vlinedata-airquality_mod-filteris.naozone-mapping-aesxintercept-solar.r_mod2-labstitle-alternate-situation-2" id="toc-r-miss_scatter_na_markers_alt-libraryreadr-librarytidyverse-eval-true-echo-false-airquality_mod---airquality-mutate-solar.r_mod1-if_elseis.naozone-250-solar.r4-solar.r-solar.r_mod2-if_elseis.naozone-250-solar.r2-solar.r-ggplotairquality_mod-aesx-is.naozone-y-solar.r_mod1-geom_boxplot-labstitle-alternate-situation-1-ggplotairquality_mod-aesx-solar.r_mod1-y-ozone-geom_point-geom_smooth-geom_vlinedata-airquality_mod-filteris.naozone-mapping-aesxintercept-solar.r_mod1-labstitle-alternate-situation-1-ggplotairquality_mod-aesx-is.naozone-y-solar.r_mod2-geom_boxplot-labstitle-alternate-situation-2-ggplotairquality_mod-aesx-solar.r_mod2-y-ozone-geom_point-geom_smooth-geom_vlinedata-airquality_mod-filteris.naozone-mapping-aesxintercept-solar.r_mod2-labstitle-alternate-situation-2" class="nav-link" data-scroll-target="#r-miss_scatter_na_markers_alt-libraryreadr-librarytidyverse-eval-true-echo-false-airquality_mod---airquality-mutate-solar.r_mod1-if_elseis.naozone-250-solar.r4-solar.r-solar.r_mod2-if_elseis.naozone-250-solar.r2-solar.r-ggplotairquality_mod-aesx-is.naozone-y-solar.r_mod1-geom_boxplot-labstitle-alternate-situation-1-ggplotairquality_mod-aesx-solar.r_mod1-y-ozone-geom_point-geom_smooth-geom_vlinedata-airquality_mod-filteris.naozone-mapping-aesxintercept-solar.r_mod1-labstitle-alternate-situation-1-ggplotairquality_mod-aesx-is.naozone-y-solar.r_mod2-geom_boxplot-labstitle-alternate-situation-2-ggplotairquality_mod-aesx-solar.r_mod2-y-ozone-geom_point-geom_smooth-geom_vlinedata-airquality_mod-filteris.naozone-mapping-aesxintercept-solar.r_mod2-labstitle-alternate-situation-2"><code>{r miss_scatter_na_markers_alt} # library(readr) # library(tidyverse) # #| eval: true # #| echo: false # airquality_mod &lt;- airquality |&gt;  #     mutate( #         Solar.R_mod1 = if_else(is.na(Ozone), 250 + Solar.R/4, Solar.R), #         Solar.R_mod2 = if_else(is.na(Ozone), 250 + Solar.R/2, Solar.R) #     ) #  # ggplot(airquality_mod, aes(x = is.na(Ozone), y = Solar.R_mod1)) +  #     geom_boxplot() + #     labs(title = "Alternate Situation 1") # ggplot(airquality_mod, aes(x = Solar.R_mod1, y = Ozone)) + #     geom_point() + #     geom_smooth() + #     geom_vline(data = airquality_mod |&gt; filter(is.na(Ozone)), mapping = aes(xintercept = Solar.R_mod1)) + #     labs(title = "Alternate Situation 1") #  # ggplot(airquality_mod, aes(x = is.na(Ozone), y = Solar.R_mod2)) +  #     geom_boxplot() + #     labs(title = "Alternate Situation 2") # ggplot(airquality_mod, aes(x = Solar.R_mod2, y = Ozone)) + #     geom_point() + #     geom_smooth() + #     geom_vline(data = airquality_mod |&gt; filter(is.na(Ozone)), mapping = aes(xintercept = Solar.R_mod2)) + #     labs(title = "Alternate Situation 2") #</code></a></li>
  <li><a href="#ozone-is-missing-when-solar-is-at-higher-values-for-both-alternative-situations.-in-alt-1-version-we-have-some-observed-data-in-the-range-of-solar-for-where-ozone-is-missing-so-we-could-predict-it-fairly-well.-in-alt-2-version-ozone-is-missing-when-solar-is-beyond-the-values-of-our-observed-data-so-we-dont-have-a-good-sense-of-what-the-relationship-would-be-between-solar-and-ozone." id="toc-ozone-is-missing-when-solar-is-at-higher-values-for-both-alternative-situations.-in-alt-1-version-we-have-some-observed-data-in-the-range-of-solar-for-where-ozone-is-missing-so-we-could-predict-it-fairly-well.-in-alt-2-version-ozone-is-missing-when-solar-is-beyond-the-values-of-our-observed-data-so-we-dont-have-a-good-sense-of-what-the-relationship-would-be-between-solar-and-ozone." class="nav-link" data-scroll-target="#ozone-is-missing-when-solar-is-at-higher-values-for-both-alternative-situations.-in-alt-1-version-we-have-some-observed-data-in-the-range-of-solar-for-where-ozone-is-missing-so-we-could-predict-it-fairly-well.-in-alt-2-version-ozone-is-missing-when-solar-is-beyond-the-values-of-our-observed-data-so-we-dont-have-a-good-sense-of-what-the-relationship-would-be-between-solar-and-ozone.">Ozone is missing when solar is at higher values for both alternative situations. In alt 1 version, we have some observed data in the range of Solar for where Ozone is missing so we could predict it fairly well. In alt 2 version, Ozone is missing when Solar is beyond the values of our observed data so we don‚Äôt have a good sense of what the relationship would be between Solar and Ozone.</a></li>
  <li><a href="#ozone-mechanism-detection-continue-the-investigation-of-missingness-for-ozone." id="toc-ozone-mechanism-detection-continue-the-investigation-of-missingness-for-ozone." class="nav-link" data-scroll-target="#ozone-mechanism-detection-continue-the-investigation-of-missingness-for-ozone.">3. <strong>Ozone mechanism detection</strong> Continue the investigation of missingness for <code>Ozone</code>.</a></li>
  <li><a href="#section-96" id="toc-section-96" class="nav-link" data-scroll-target="#section-96"></a></li>
  <li><a href="#we-want-to-see-how-month-wind-and-temp-relate-to-the-chance-of-missingness-for-ozone-and-to-the-value-of-ozone." id="toc-we-want-to-see-how-month-wind-and-temp-relate-to-the-chance-of-missingness-for-ozone-and-to-the-value-of-ozone." class="nav-link" data-scroll-target="#we-want-to-see-how-month-wind-and-temp-relate-to-the-chance-of-missingness-for-ozone-and-to-the-value-of-ozone.">We want to see how <code>Month</code>, <code>Wind</code>, and <code>Temp</code> relate to the chance of missingness for <code>Ozone</code> and to the value of <code>Ozone</code>.</a></li>
  <li><a href="#section-97" id="toc-section-97" class="nav-link" data-scroll-target="#section-97"></a></li>
  <li><a href="#does-it-look-like-a-linear-regression-model-perhaps-with-variable-transformations-could-be-effective-in-imputing-the-missing-ozone-data" id="toc-does-it-look-like-a-linear-regression-model-perhaps-with-variable-transformations-could-be-effective-in-imputing-the-missing-ozone-data" class="nav-link" data-scroll-target="#does-it-look-like-a-linear-regression-model-perhaps-with-variable-transformations-could-be-effective-in-imputing-the-missing-ozone-data">Does it look like a linear regression model (perhaps with variable transformations) could be effective in imputing the missing ozone data?</a></li>
  <li><a href="#section-98" id="toc-section-98" class="nav-link" data-scroll-target="#section-98"></a></li>
  <li><a href="#r-ggplotairquality-aesfill-is.naozone-x-factormonth-geom_barposition-fill-ggplotairquality-aesx-is.naozone-y-wind-geom_boxplot-ggplotairquality-aesx-is.naozone-y-temp-geom_boxplot-ggplotairquality-aesx-factormonth-y-ozone-geom_boxplot-ggplotairquality-aesx-wind-y-ozone-geom_point-geom_smooth-geom_vlinedata-airquality-filteris.naozone-mapping-aesxintercept-wind-ggplotairquality-aesx-temp-y-ozone-geom_point-geom_smooth-geom_vlinedata-airquality-filteris.naozone-mapping-aesxintercept-temp" id="toc-r-ggplotairquality-aesfill-is.naozone-x-factormonth-geom_barposition-fill-ggplotairquality-aesx-is.naozone-y-wind-geom_boxplot-ggplotairquality-aesx-is.naozone-y-temp-geom_boxplot-ggplotairquality-aesx-factormonth-y-ozone-geom_boxplot-ggplotairquality-aesx-wind-y-ozone-geom_point-geom_smooth-geom_vlinedata-airquality-filteris.naozone-mapping-aesxintercept-wind-ggplotairquality-aesx-temp-y-ozone-geom_point-geom_smooth-geom_vlinedata-airquality-filteris.naozone-mapping-aesxintercept-temp" class="nav-link" data-scroll-target="#r-ggplotairquality-aesfill-is.naozone-x-factormonth-geom_barposition-fill-ggplotairquality-aesx-is.naozone-y-wind-geom_boxplot-ggplotairquality-aesx-is.naozone-y-temp-geom_boxplot-ggplotairquality-aesx-factormonth-y-ozone-geom_boxplot-ggplotairquality-aesx-wind-y-ozone-geom_point-geom_smooth-geom_vlinedata-airquality-filteris.naozone-mapping-aesxintercept-wind-ggplotairquality-aesx-temp-y-ozone-geom_point-geom_smooth-geom_vlinedata-airquality-filteris.naozone-mapping-aesxintercept-temp"><code>{r} # ggplot(airquality, aes(fill = is.na(Ozone), x = factor(Month))) + #   geom_bar(position = "fill") #  # ggplot(airquality, aes(x = is.na(Ozone), y = Wind)) + #   geom_boxplot() #  # ggplot(airquality, aes(x = is.na(Ozone), y = Temp)) + #   geom_boxplot() #  # ggplot(airquality, aes(x = factor(Month), y = Ozone)) + #     geom_boxplot() #  # ggplot(airquality, aes(x = Wind, y = Ozone)) + #   geom_point() + #   geom_smooth() + #   geom_vline(data = airquality |&gt; filter(is.na(Ozone)), mapping = aes(xintercept = Wind)) #  # ggplot(airquality, aes(x = Temp, y = Ozone)) + #     geom_point() + #     geom_smooth() + #     geom_vline(data = airquality |&gt; filter(is.na(Ozone)), mapping = aes(xintercept = Temp)) #</code></a></li>
  <li><a href="#section-99" id="toc-section-99" class="nav-link" data-scroll-target="#section-99"></a></li>
  <li><a href="#section-100" id="toc-section-100" class="nav-link" data-scroll-target="#section-100"></a></li>
  <li><a href="#section-101" id="toc-section-101" class="nav-link" data-scroll-target="#section-101"></a></li>
  <li><a href="#regression-imputation" id="toc-regression-imputation" class="nav-link" data-scroll-target="#regression-imputation">## Regression Imputation</a></li>
  <li><a href="#section-102" id="toc-section-102" class="nav-link" data-scroll-target="#section-102"></a></li>
  <li><a href="#when-a-model-is-built-and-used-to-generate-a-single-set-of-predictions-for-missing-values-this-is-known-as-single-imputation." id="toc-when-a-model-is-built-and-used-to-generate-a-single-set-of-predictions-for-missing-values-this-is-known-as-single-imputation." class="nav-link" data-scroll-target="#when-a-model-is-built-and-used-to-generate-a-single-set-of-predictions-for-missing-values-this-is-known-as-single-imputation.">When a model is built and used to generate a single set of predictions for missing values, this is known as <strong>single imputation</strong>.</a></li>
  <li><a href="#section-103" id="toc-section-103" class="nav-link" data-scroll-target="#section-103"></a></li>
  <li><a href="#section-104" id="toc-section-104" class="nav-link" data-scroll-target="#section-104"></a></li>
  <li><a href="#when-using-singly-imputed-data-in-subsequent-modeling-the-uncertainty-in-estimates-tends-to-be-underestimated.-this-means-that" id="toc-when-using-singly-imputed-data-in-subsequent-modeling-the-uncertainty-in-estimates-tends-to-be-underestimated.-this-means-that" class="nav-link" data-scroll-target="#when-using-singly-imputed-data-in-subsequent-modeling-the-uncertainty-in-estimates-tends-to-be-underestimated.-this-means-that">- When using singly imputed data in subsequent modeling, the uncertainty in estimates tends to be underestimated. This means that:</a></li>
  <li><a href="#standard-errors-are-lower-than-they-should-be." id="toc-standard-errors-are-lower-than-they-should-be." class="nav-link" data-scroll-target="#standard-errors-are-lower-than-they-should-be.">- Standard errors are lower than they should be.</a></li>
  <li><a href="#confidence-intervals-wont-contain-the-true-parameter-value-the-advertised-percentage-of-times" id="toc-confidence-intervals-wont-contain-the-true-parameter-value-the-advertised-percentage-of-times" class="nav-link" data-scroll-target="#confidence-intervals-wont-contain-the-true-parameter-value-the-advertised-percentage-of-times">- Confidence intervals won‚Äôt contain the true parameter value the ‚Äúadvertised‚Äù percentage of times</a></li>
  <li><a href="#e.g.-95-confidence-intervals-will-not-contain-the-truth-in-95-of-samplesthe-coverage-probability-will-be-less-than-95" id="toc-e.g.-95-confidence-intervals-will-not-contain-the-truth-in-95-of-samplesthe-coverage-probability-will-be-less-than-95" class="nav-link" data-scroll-target="#e.g.-95-confidence-intervals-will-not-contain-the-truth-in-95-of-samplesthe-coverage-probability-will-be-less-than-95">- e.g., 95% confidence intervals will not contain the truth in 95% of samples‚Äìthe coverage probability will be less than 95%</a></li>
  <li><a href="#section-105" id="toc-section-105" class="nav-link" data-scroll-target="#section-105"></a></li>
  <li><a href="#section-106" id="toc-section-106" class="nav-link" data-scroll-target="#section-106"></a></li>
  <li><a href="#in-multiple-imputation-multiple-imputed-datasets-are-generated-with-different-values-for-the-filled-in-data." id="toc-in-multiple-imputation-multiple-imputed-datasets-are-generated-with-different-values-for-the-filled-in-data." class="nav-link" data-scroll-target="#in-multiple-imputation-multiple-imputed-datasets-are-generated-with-different-values-for-the-filled-in-data.">In <strong>multiple imputation</strong>, multiple imputed datasets are generated with different values for the filled-in data.</a></li>
  <li><a href="#section-107" id="toc-section-107" class="nav-link" data-scroll-target="#section-107"></a></li>
  <li><a href="#section-108" id="toc-section-108" class="nav-link" data-scroll-target="#section-108"></a></li>
  <li><a href="#subsequent-models-are-fit-on-each-of-these-datasets-and-both-estimates-and-uncertainty-measures-are-pooled-across-all-of-these-fits." id="toc-subsequent-models-are-fit-on-each-of-these-datasets-and-both-estimates-and-uncertainty-measures-are-pooled-across-all-of-these-fits." class="nav-link" data-scroll-target="#subsequent-models-are-fit-on-each-of-these-datasets-and-both-estimates-and-uncertainty-measures-are-pooled-across-all-of-these-fits.">- Subsequent models are fit on each of these datasets, and both estimates and uncertainty measures are pooled across all of these fits.</a></li>
  <li><a href="#multiple-imputation-more-accurately-estimates-uncertainty-measures." id="toc-multiple-imputation-more-accurately-estimates-uncertainty-measures." class="nav-link" data-scroll-target="#multiple-imputation-more-accurately-estimates-uncertainty-measures.">- Multiple imputation more accurately estimates uncertainty measures.</a></li>
  <li><a href="#section-109" id="toc-section-109" class="nav-link" data-scroll-target="#section-109"></a></li>
  <li><a href="#simulation-studies" id="toc-simulation-studies" class="nav-link" data-scroll-target="#simulation-studies">## Simulation Studies</a></li>
  <li><a href="#section-110" id="toc-section-110" class="nav-link" data-scroll-target="#section-110"></a></li>
  <li><a href="#we-can-use-a-simulation-study-to-investigate-the-statistical-properties-described-above." id="toc-we-can-use-a-simulation-study-to-investigate-the-statistical-properties-described-above." class="nav-link" data-scroll-target="#we-can-use-a-simulation-study-to-investigate-the-statistical-properties-described-above.">We can use a <strong>simulation study</strong> to investigate the statistical properties described above.</a></li>
  <li><a href="#section-111" id="toc-section-111" class="nav-link" data-scroll-target="#section-111"></a></li>
  <li><a href="#section-112" id="toc-section-112" class="nav-link" data-scroll-target="#section-112">:::</a></li>
  <li><a href="#section-113" id="toc-section-113" class="nav-link" data-scroll-target="#section-113"></a></li>
  <li><a href="#generate-simulate-data-where-we-are-in-control-of-missing-data-mechanisms-and-the-true-relationship-between-an-outcome-and-the-predictors." id="toc-generate-simulate-data-where-we-are-in-control-of-missing-data-mechanisms-and-the-true-relationship-between-an-outcome-and-the-predictors." class="nav-link" data-scroll-target="#generate-simulate-data-where-we-are-in-control-of-missing-data-mechanisms-and-the-true-relationship-between-an-outcome-and-the-predictors.">1. Generate (simulate) data where we are in control of missing data mechanisms and the true relationship between an outcome and the predictors.</a></li>
  <li><a href="#on-that-simulated-data-use-single-imputation-to-fill-in-the-missing-values.-fit-the-desired-model-and-obtain-a-confidence-interval-for-a-coefficient-of-interest." id="toc-on-that-simulated-data-use-single-imputation-to-fill-in-the-missing-values.-fit-the-desired-model-and-obtain-a-confidence-interval-for-a-coefficient-of-interest." class="nav-link" data-scroll-target="#on-that-simulated-data-use-single-imputation-to-fill-in-the-missing-values.-fit-the-desired-model-and-obtain-a-confidence-interval-for-a-coefficient-of-interest.">2. On that simulated data, use <strong>single imputation</strong> to fill in the missing values. Fit the desired model, and obtain a confidence interval for a coefficient of interest.</a></li>
  <li><a href="#on-that-simulated-data-use-multiple-imputation-to-fill-in-the-missing-values.-fit-the-desired-models-on-all-imputed-datasets-pool-results-and-obtain-a-confidence-interval-for-a-coefficient-of-interest." id="toc-on-that-simulated-data-use-multiple-imputation-to-fill-in-the-missing-values.-fit-the-desired-models-on-all-imputed-datasets-pool-results-and-obtain-a-confidence-interval-for-a-coefficient-of-interest." class="nav-link" data-scroll-target="#on-that-simulated-data-use-multiple-imputation-to-fill-in-the-missing-values.-fit-the-desired-models-on-all-imputed-datasets-pool-results-and-obtain-a-confidence-interval-for-a-coefficient-of-interest.">3. On that simulated data, use <strong>multiple imputation</strong> to fill in the missing values. Fit the desired models on all imputed datasets, pool results, and obtain a confidence interval for a coefficient of interest.</a></li>
  <li><a href="#steps-1---3-are-repeated-a-lot-of-times-num_simulations---1000-to-see-how-things-work-out-in-lots-of-different-samples." id="toc-steps-1---3-are-repeated-a-lot-of-times-num_simulations---1000-to-see-how-things-work-out-in-lots-of-different-samples." class="nav-link" data-scroll-target="#steps-1---3-are-repeated-a-lot-of-times-num_simulations---1000-to-see-how-things-work-out-in-lots-of-different-samples.">4. Steps 1 - 3 are repeated a lot of times (<code>num_simulations &lt;- 1000</code>) to see how things work out in lots of different samples.</a></li>
  <li><a href="#summarize-the-performance-of-single-and-multiple-imputation-across-the-num_simulations-simulations." id="toc-summarize-the-performance-of-single-and-multiple-imputation-across-the-num_simulations-simulations." class="nav-link" data-scroll-target="#summarize-the-performance-of-single-and-multiple-imputation-across-the-num_simulations-simulations.">5. Summarize the performance of single and multiple imputation across the <code>num_simulations</code> simulations.</a></li>
  <li><a href="#section-114" id="toc-section-114" class="nav-link" data-scroll-target="#section-114"></a></li>
  <li><a href="#section-115" id="toc-section-115" class="nav-link" data-scroll-target="#section-115">:::</a></li>
  <li><a href="#section-116" id="toc-section-116" class="nav-link" data-scroll-target="#section-116"></a></li>
  <li><a href="#we-will-slowly-step-through-the-simulation-study-code-below.-we-will-pause-frequently-for-you-to-add-comments-documenting-what-is-happening." id="toc-we-will-slowly-step-through-the-simulation-study-code-below.-we-will-pause-frequently-for-you-to-add-comments-documenting-what-is-happening." class="nav-link" data-scroll-target="#we-will-slowly-step-through-the-simulation-study-code-below.-we-will-pause-frequently-for-you-to-add-comments-documenting-what-is-happening.">We will slowly step through the simulation study code below. We will pause frequently for you to add comments documenting what is happening.</a></li>
  <li><a href="#section-117" id="toc-section-117" class="nav-link" data-scroll-target="#section-117"></a></li>
  <li><a href="#r-mult_single_sim_study-set.seed224-num_simulations---1000-ci_list---vectorlist-length-num_simulations-system.time-for-i-in-1num_simulations-simulate-data-n---1000-sim_data---tibble-x1-runifn-min-0-max-1-x2-x1-rnormn-mean-0-sd-1-x2_miss_bool-rbinomn-size-1-prob-x12-x2_na-if_elsex2_miss_bool-1-na-x2-y-x1-x2-rnormn-mean-0-sd-1-single-imputation-----------------mice_obj---micesim_data-selectx1-x2_na-y-m-1-method-norm-printflag-false-si_mod---withmice_obj-lmy-x1-x2_na-ci_single---si_modanalyses1-confintlevel-0.95-ci_single---ci_singlex2_na-multiple-imputation---------------mice_obj---micesim_data-selectx1-x2_na-y-m-10-method-norm-printflag-false-mi_mods---withmice_obj-lmy-x1-x2_na-pooled_res---poolmi_mods-summ_pooled_res---summarypooled_res-conf.int-true-conf.level-0.95-ci_multiple_lower---summ_pooled_res-filtertermx2_na-pull2.5-ci_multiple_upper---summ_pooled_res-filtertermx2_na-pull97.5-store-ci-information-ci_listi---tibble-ci_lower-c-ci_single1-ci_multiple_lower-ci_upper-c-ci_single2-ci_multiple_upper-which_imp-csingle-multiple" id="toc-r-mult_single_sim_study-set.seed224-num_simulations---1000-ci_list---vectorlist-length-num_simulations-system.time-for-i-in-1num_simulations-simulate-data-n---1000-sim_data---tibble-x1-runifn-min-0-max-1-x2-x1-rnormn-mean-0-sd-1-x2_miss_bool-rbinomn-size-1-prob-x12-x2_na-if_elsex2_miss_bool-1-na-x2-y-x1-x2-rnormn-mean-0-sd-1-single-imputation-----------------mice_obj---micesim_data-selectx1-x2_na-y-m-1-method-norm-printflag-false-si_mod---withmice_obj-lmy-x1-x2_na-ci_single---si_modanalyses1-confintlevel-0.95-ci_single---ci_singlex2_na-multiple-imputation---------------mice_obj---micesim_data-selectx1-x2_na-y-m-10-method-norm-printflag-false-mi_mods---withmice_obj-lmy-x1-x2_na-pooled_res---poolmi_mods-summ_pooled_res---summarypooled_res-conf.int-true-conf.level-0.95-ci_multiple_lower---summ_pooled_res-filtertermx2_na-pull2.5-ci_multiple_upper---summ_pooled_res-filtertermx2_na-pull97.5-store-ci-information-ci_listi---tibble-ci_lower-c-ci_single1-ci_multiple_lower-ci_upper-c-ci_single2-ci_multiple_upper-which_imp-csingle-multiple" class="nav-link" data-scroll-target="#r-mult_single_sim_study-set.seed224-num_simulations---1000-ci_list---vectorlist-length-num_simulations-system.time-for-i-in-1num_simulations-simulate-data-n---1000-sim_data---tibble-x1-runifn-min-0-max-1-x2-x1-rnormn-mean-0-sd-1-x2_miss_bool-rbinomn-size-1-prob-x12-x2_na-if_elsex2_miss_bool-1-na-x2-y-x1-x2-rnormn-mean-0-sd-1-single-imputation-----------------mice_obj---micesim_data-selectx1-x2_na-y-m-1-method-norm-printflag-false-si_mod---withmice_obj-lmy-x1-x2_na-ci_single---si_modanalyses1-confintlevel-0.95-ci_single---ci_singlex2_na-multiple-imputation---------------mice_obj---micesim_data-selectx1-x2_na-y-m-10-method-norm-printflag-false-mi_mods---withmice_obj-lmy-x1-x2_na-pooled_res---poolmi_mods-summ_pooled_res---summarypooled_res-conf.int-true-conf.level-0.95-ci_multiple_lower---summ_pooled_res-filtertermx2_na-pull2.5-ci_multiple_upper---summ_pooled_res-filtertermx2_na-pull97.5-store-ci-information-ci_listi---tibble-ci_lower-c-ci_single1-ci_multiple_lower-ci_upper-c-ci_single2-ci_multiple_upper-which_imp-csingle-multiple"><code>{r mult_single_sim_study} # set.seed(224) # num_simulations &lt;- 1000 # ci_list &lt;- vector("list", length = num_simulations) #  # system.time({ # for (i in 1:num_simulations) { #     # Simulate data #     n &lt;- 1000 #     sim_data &lt;- tibble( #         x1 = runif(n, min = 0, max = 1), #         x2 = x1 + rnorm(n, mean = 0, sd = 1), #         x2_miss_bool = rbinom(n, size = 1, prob = x1/2), #         x2_NA = if_else(x2_miss_bool == 1, NA, x2), #         y = x1 + x2 + rnorm(n, mean = 0, sd = 1) #     ) #      #     # Single imputation --------------- #     mice_obj &lt;- mice(sim_data |&gt; select(x1, x2_NA, y), m = 1, method = "norm", printFlag = FALSE) #     si_mod &lt;- with(mice_obj, lm(y ~ x1 + x2_NA)) #     ci_single &lt;- si_mod$analyses[[1]] |&gt; confint(level = 0.95) #     ci_single &lt;- ci_single["x2_NA",] #      #     # Multiple imputation ------------- #     mice_obj &lt;- mice(sim_data |&gt; select(x1, x2_NA, y), m = 10, method = "norm", printFlag = FALSE) #     mi_mods &lt;- with(mice_obj, lm(y ~ x1 + x2_NA)) #     pooled_res &lt;- pool(mi_mods) #     summ_pooled_res &lt;- summary(pooled_res, conf.int = TRUE, conf.level = 0.95) #     ci_multiple_lower &lt;- summ_pooled_res |&gt; filter(term=="x2_NA") |&gt; pull(`2.5 %`) #     ci_multiple_upper &lt;- summ_pooled_res |&gt; filter(term=="x2_NA") |&gt; pull(`97.5 %`) #      #     # Store CI information #     ci_list[[i]] &lt;- tibble( #         ci_lower = c( #             ci_single[1], #             ci_multiple_lower #         ), #         ci_upper = c( #             ci_single[2], #             ci_multiple_upper #         ), #         which_imp = c("single", "multiple") #     ) # } # }) #</code></a></li>
  <li><a href="#section-118" id="toc-section-118" class="nav-link" data-scroll-target="#section-118"></a></li>
  <li><a href="#below-we-compute-the-confidence-interval-ci-coverage-probability-fraction-of-times-the-ci-contains-the-true-value-of-1-for-the-cis-generated-from-single-and-multiple-imputation" id="toc-below-we-compute-the-confidence-interval-ci-coverage-probability-fraction-of-times-the-ci-contains-the-true-value-of-1-for-the-cis-generated-from-single-and-multiple-imputation" class="nav-link" data-scroll-target="#below-we-compute-the-confidence-interval-ci-coverage-probability-fraction-of-times-the-ci-contains-the-true-value-of-1-for-the-cis-generated-from-single-and-multiple-imputation">Below we compute the confidence interval (CI) coverage probability (fraction of times the CI contains the true value of <code>1</code>) for the CIs generated from single and multiple imputation:</a></li>
  <li><a href="#section-119" id="toc-section-119" class="nav-link" data-scroll-target="#section-119"></a></li>
  <li><a href="#r-mult_single_sim_study_summ-ci_data---bind_rowsci_list-ci_data-mutatecontains_truth-ci_lower-1-ci_upper-1-group_bywhich_imp-summarizefrac_contains_truth-meancontains_truth" id="toc-r-mult_single_sim_study_summ-ci_data---bind_rowsci_list-ci_data-mutatecontains_truth-ci_lower-1-ci_upper-1-group_bywhich_imp-summarizefrac_contains_truth-meancontains_truth" class="nav-link" data-scroll-target="#r-mult_single_sim_study_summ-ci_data---bind_rowsci_list-ci_data-mutatecontains_truth-ci_lower-1-ci_upper-1-group_bywhich_imp-summarizefrac_contains_truth-meancontains_truth"><code>{r mult_single_sim_study_summ} # ci_data &lt;- bind_rows(ci_list) # ci_data |&gt;  #     mutate(contains_truth = ci_lower &lt; 1 &amp; ci_upper &gt; 1) |&gt;  #     group_by(which_imp) |&gt;  #     summarize(frac_contains_truth = mean(contains_truth)) #</code></a></li>
  <li><a href="#section-120" id="toc-section-120" class="nav-link" data-scroll-target="#section-120"></a></li>
  <li><a href="#done" id="toc-done" class="nav-link" data-scroll-target="#done">## Done!</a></li>
  <li><a href="#section-121" id="toc-section-121" class="nav-link" data-scroll-target="#section-121"></a></li>
  <li><a href="#check-the-ica-instructions-for-how-to-a-push-your-code-to-github-and-b-update-your-portfolio-website" id="toc-check-the-ica-instructions-for-how-to-a-push-your-code-to-github-and-b-update-your-portfolio-website" class="nav-link" data-scroll-target="#check-the-ica-instructions-for-how-to-a-push-your-code-to-github-and-b-update-your-portfolio-website">- Check the ICA Instructions for how to (a) push your code to GitHub and (b) update your portfolio website</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../src/ica/ica-sample1.html">In-Class Activities</a></li><li class="breadcrumb-item"><a href="../../src/ica/08-missing-data-notes.html"><span class="chapter-title">‚Äî</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-title">‚Äî</span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta column-body">

    
  
    
  </div>
  


</header>


<section id="title-8-missing-data" class="level1">
<h1>title: ‚Äú8 Missing Data‚Äù</h1>
</section>
<section id="section" class="level1">
<h1>‚Äî</h1>
</section>
<section id="section-1" class="level1">
<h1></h1>
</section>
<section id="section-2" class="level1">
<h1></h1>
</section>
<section id="r-doc_setup_08-echofalse-messagefalse-librarytidyverse-librarynaniar-librarymice" class="level1">
<h1><code>{r doc_setup_08, echo=FALSE, message=FALSE} # library(tidyverse) # library(naniar) # library(mice) #</code></h1>
</section>
<section id="section-3" class="level1">
<h1></h1>
</section>
<section id="learning-goals" class="level1">
<h1>## üß© Learning Goals</h1>
</section>
<section id="section-4" class="level1">
<h1></h1>
</section>
<section id="by-the-end-of-this-lesson-you-should-be-able-to" class="level1">
<h1>By the end of this lesson, you should be able to:</h1>
</section>
<section id="section-5" class="level1">
<h1></h1>
</section>
<section id="go-through-a-data-quality-checklist-when-data-wrangling" class="level1">
<h1>- Go through a data quality checklist when data wrangling</h1>
</section>
<section id="explain-the-difference-between-mcar-mar-and-mnar-missing-data-mechanisms" class="level1">
<h1>- Explain the difference between MCAR, MAR, and MNAR missing data mechanisms</h1>
</section>
<section id="assess-what-missing-data-mechanisms-might-be-at-play-in-a-given-dataset" class="level1">
<h1>- Assess what missing data mechanisms might be at play in a given dataset</h1>
</section>
<section id="use-visualizations-to-explore-missing-data-patterns" class="level1">
<h1>- Use visualizations to explore missing data patterns</h1>
</section>
<section id="explain-why-multiple-imputation-is-preferred-to-single-imputation" class="level1">
<h1>- Explain why multiple imputation is preferred to single imputation</h1>
</section>
<section id="explain-how-a-simulation-study-can-be-used-to-investigate-properties-of-statistical-methods" class="level1">
<h1>- Explain how a simulation study can be used to investigate properties of statistical methods</h1>
</section>
<section id="section-6" class="level1">
<h1></h1>
</section>
<section id="section-7" class="level1">
<h1></h1>
</section>
<section id="data-quality-checklist" class="level1">
<h1>## Data Quality Checklist</h1>
</section>
<section id="section-8" class="level1">
<h1></h1>
</section>
<section id="when-wrangling-cleaning-data-make-sure-to-check-the-assumptions-you-make-about-the-data-to-ensure-you-dont-lose-data-quality." class="level1">
<h1>When wrangling / cleaning data, make sure to check the assumptions you make about the data to ensure you don‚Äôt lose data quality.</h1>
</section>
<section id="section-9" class="level1">
<h1></h1>
</section>
<section id="section-10" class="level1">
<h1></h1>
</section>
<section id="section-11" class="level1 incremental">
<h1 class="incremental">:::</h1>
</section>
<section id="data-parsing-reading-data-into-a-different-data-format" class="level1">
<h1><strong>Data Parsing</strong> (reading data into a different data format)</h1>
</section>
<section id="section-12" class="level1">
<h1></h1>
</section>
<section id="always-keep-the-original-raw-data-dont-manually-change-it." class="level1">
<h1>- Always keep the original, raw data (don‚Äôt manually change it).</h1>
</section>
<section id="use-test-cases-find-rows-or-write-test-cases-to-double-check-the-wrangling-works-as-expected" class="level1">
<h1>- Use Test Cases: Find rows or write test cases to double check the wrangling works as expected</h1>
</section>
<section id="dates-when-using-lubridate-to-parse-dates-and-times-ensure-the-strings-are-consistently-ordered-and-formatted-correctly-eg-mmddyy-vs.-ddmmyy." class="level1">
<h1>- DATES: When using <code>lubridate</code> to parse dates and times, ensure the strings are consistently ordered and formatted correctly, eg, mm/dd/yy vs.&nbsp;dd/mm/yy.</h1>
</section>
<section id="strings-when-using-stringr-to-parse-strings-with-regular-expressions-check-example-rows-to-ensure-that-the-pattern-captured-all-of-the-examples-you-want-and-excluded-the-patterns-you-dont-want." class="level1">
<h1>- STRINGS: When using <code>stringr</code> to parse strings with regular expressions, check example rows to ensure that the pattern captured all of the examples you want and excluded the patterns you don‚Äôt want.</h1>
</section>
<section id="always-check-for-missing-values-to-see-if-the-missing-ones-are-expected-given-the-original-data." class="level1">
<h1>- Always check for missing values to see if the missing ones are expected given the original data.</h1>
</section>
<section id="section-13" class="level1">
<h1></h1>
</section>
<section id="section-14" class="level1">
<h1>:::</h1>
</section>
<section id="section-15" class="level1">
<h1></h1>
</section>
<section id="data-joining" class="level1">
<h1><strong>Data Joining</strong></h1>
</section>
<section id="section-16" class="level1">
<h1></h1>
</section>
<section id="section-17" class="level1 incremental">
<h1 class="incremental">:::</h1>
</section>
<section id="section-18" class="level1">
<h1></h1>
</section>
<section id="identify-missing-values-in-the-key-variables-and-decide-how-to-handle-them-before-the-merge-process-e.g.-omitting-rows-with-missing-values-imputing-missing-values." class="level1">
<h1>- Identify missing values in the key variables and decide how to handle them before the merge process (e.g., omitting rows with missing values, imputing missing values).</h1>
</section>
<section id="decide-on-the-correct-join-type-left-right-inner-full-etc.-or-if-the-data-structure-is-the-same-use-list_rbind-to-bind-rows-or-list_cbind-to-bind-columns." class="level1">
<h1>- Decide on the correct join type (left, right, inner, full, etc.) OR if the data structure is the same use <code>list_rbind()</code> to bind rows or <code>list_cbind()</code> to bind columns.</h1>
</section>
<section id="if-doing-a-join-make-sure-that-the-key-variables-by-have-the-same-meaning-in-both-datasets-and-are-represented-in-the-same-way-e.g.-id-1-to-20-in-first-dataset-will-match-id-1---20-in-undesirable-ways" class="level1">
<h1>- If doing a join, make sure that the key variables (<code>by</code>) have the same meaning in both datasets and are represented in the same way (e.g., id = 1 to 20 in first dataset will match id = 1 - 20 in undesirable ways)</h1>
</section>
<section id="predict-the-number-of-rows-that-will-result-from-the-join-and-double-check-the-anti_join-to-see-which-rows-did-not-find-a-match." class="level1">
<h1>- Predict the number of rows that will result from the join and double check the <code>anti_join()</code> to see which rows did not find a match.</h1>
</section>
<section id="check-for-duplicate-records-within-each-dataset-and-ensure-they-are-handled-appropriately-before-merging." class="level1">
<h1>- Check for duplicate records within each dataset and ensure they are handled appropriately before merging.</h1>
</section>
<section id="verify-that-the-merged-dataset-maintains-consistency-with-the-original-datasets-in-terms-of-data-values-variable-names-and-variable-types." class="level1">
<h1>- Verify that the merged dataset maintains consistency with the original datasets in terms of data values, variable names, and variable types.</h1>
</section>
<section id="perform-some-preliminary-analysis-or-validation-checks-on-the-merged-dataset-to-ensure-that-it-meets-the-requirements-of-your-analysis." class="level1">
<h1>- Perform some preliminary analysis or validation checks on the merged dataset to ensure that it meets the requirements of your analysis.</h1>
</section>
<section id="section-19" class="level1">
<h1></h1>
</section>
<section id="section-20" class="level1">
<h1>:::</h1>
</section>
<section id="section-21" class="level1">
<h1></h1>
</section>
<section id="section-22" class="level1">
<h1></h1>
</section>
<section id="sanity-check-visualize-your-data" class="level1">
<h1><strong>Sanity Check: Visualize your data!!!</strong></h1>
</section>
<section id="section-23" class="level1">
<h1></h1>
</section>
<section id="section-24" class="level1 incremental">
<h1 class="incremental">:::</h1>
</section>
<section id="do-the-right-number-of-points-appear" class="level1">
<h1>- Do the right number of points appear?</h1>
</section>
<section id="do-the-values-seem-reasonable" class="level1">
<h1>- Do the values seem reasonable?</h1>
</section>
<section id="section-25" class="level1">
<h1>:::</h1>
</section>
<section id="section-26" class="level1">
<h1></h1>
</section>
<section id="explicit-v.-implicit-missing-data" class="level1">
<h1>## Explicit v. Implicit Missing Data</h1>
</section>
<section id="section-27" class="level1">
<h1></h1>
</section>
<section id="explicit-missing-data-is-data-that-is-explicitly-marked-as-missing.-in-r-this-is-done-with-na." class="level1">
<h1><strong>Explicit missing data</strong> is data that is explicitly marked as missing. In R, this is done with <code>NA</code>.</h1>
</section>
<section id="section-28" class="level1">
<h1></h1>
</section>
<section id="section-29" class="level1">
<h1></h1>
</section>
<section id="implicit-missing-data-is-data-that-is-missing-but-not-explicitly-marked-as-such." class="level1">
<h1><strong>Implicit missing data</strong> is data that is missing but not explicitly marked as such.</h1>
</section>
<section id="section-30" class="level1">
<h1></h1>
</section>
<section id="this-can-happen-when-an-entire-row-is-missing-from-a-dataset." class="level1">
<h1>- This can happen when an entire row is missing from a dataset.</h1>
</section>
<section id="for-example-if-a-study-participant-doesnt-attend-a-follow-up-visit.-it-maybe-not-even-be-recorded-in-the-data." class="level1">
<h1>- For example, if a study participant doesn‚Äôt attend a follow-up visit. It maybe not even be recorded in the data.</h1>
</section>
<section id="section-31" class="level1">
<h1></h1>
</section>
<section id="we-need-to-make-implicit-missingness-explicit-before-we-can-work-with-the-data." class="level1">
<h1>We need to <strong>make implicit missingness explicit</strong> before we can work with the data.</h1>
</section>
<section id="section-32" class="level1">
<h1></h1>
</section>
<section id="consider-the-combinations-of-variables-that-youd-expect-to-be-fully-present-in-a-complete-dataset." class="level1">
<h1>- Consider the combinations of variables that you‚Äôd expect to be fully present in a complete dataset.</h1>
</section>
<section id="if-a-combination-is-missing-you-can-create-a-new-row-with-explicit-missing-values." class="level1">
<h1>- If a combination is missing, you can create a new row with explicit missing values.</h1>
</section>
<section id="for-example-if-you-expect-every-participant-each-has-a-unique-pid-to-have-an-observation-for-each-visit-you-could-use-the-function-complete-to-create-that-new-row-and-plug-in-values-of-na-for-the-missing-data." class="level1">
<h1>- For example, if you expect every participant (each has a unique <code>pid</code>) to have an observation for each <code>visit</code>, you could use the function <code>complete()</code> to create that new row and plug in values of <code>NA</code> for the missing data.</h1>
</section>
<section id="section-33" class="level1">
<h1></h1>
</section>
<section id="study_data_full---study_data-completepid-visit" class="level1">
<h1><code># study_data_full &lt;- study_data |&gt;  #   complete(pid, visit) #</code></h1>
</section>
<section id="section-34" class="level1">
<h1></h1>
</section>
<section id="dealing-with-missing-data" class="level1">
<h1>## Dealing with missing data</h1>
</section>
<section id="section-35" class="level1">
<h1></h1>
</section>
<section id="if-you-have-explicit-missing-data-there-are-3-main-ways-of-proceeding" class="level1">
<h1>If you have <strong>explicit</strong> missing data, there are 3 main ways of proceeding:</h1>
</section>
<section id="section-36" class="level1">
<h1></h1>
</section>
<section id="section-37" class="level1 incremental">
<h1 class="incremental">:::</h1>
</section>
<section id="section-38" class="level1">
<h1></h1>
</section>
<section id="drop-the-cases-or-rows-with-any-missing-data-from-the-analysisa-complete-case-analysis" class="level1">
<h1>1. Drop the cases or rows with any missing data from the analysis‚Äìa <strong>complete case analysis</strong></h1>
</section>
<section id="pro-easy-to-implement" class="level1">
<h1>- Pro: Easy to implement</h1>
</section>
<section id="con-reduces-sample-size-introduces-bias-if-the-missing-data-is-not-missing-completely-at-random" class="level1">
<h1>- Con: reduces sample size, introduces bias if the missing data is not ‚Äúmissing completely at random‚Äù</h1>
</section>
<section id="section-39" class="level1">
<h1></h1>
</section>
<section id="create-a-category-for-missing-values." class="level1">
<h1>2. Create a category for missing values.</h1>
</section>
<section id="example-the-survey-question-what-is-your-gender-might-only-provide-two-possible-responses-male-and-female.-missing-values-for-this-could-indicate-that-the-respondent-uses-a-non-binary-designation.-instead-of-dropping-these-cases-treating-the-missing-data-as-its-own-category-does-not-wish-to-answer-would-be-more-appropriate." class="level1">
<h1>- Example: The survey question ‚ÄúWhat is your gender?‚Äù might only provide two possible responses: ‚Äúmale‚Äù and ‚Äúfemale‚Äù. Missing values for this could indicate that the respondent uses a non-binary designation. Instead of dropping these cases, treating the missing data as its own category (‚ÄúDoes not wish to answer‚Äù) would be more appropriate.</h1>
</section>
<section id="pros-maintains-sample-size-may-help-us-if-data-is-missing-not-at-random" class="level1">
<h1>- Pros: Maintains sample size, may help us if data is ‚Äúmissing not at random‚Äù</h1>
</section>
<section id="cons-not-directly-applicable-to-continuous-outcomes-could-include-interactions-with-a-categorical-version-in-models-to-account-for-it" class="level1">
<h1>- Cons: Not directly applicable to continuous outcomes (could include interactions with a categorical version in models to account for it)</h1>
</section>
<section id="section-40" class="level1">
<h1></h1>
</section>
<section id="impute-or-fill-in-values-for-the-missing-data-using-imputation-algorithms." class="level1">
<h1>3. <strong>Impute</strong> (or fill in values for) the missing data using imputation algorithms.</h1>
</section>
<section id="imputation-algorithms-can-be-as-simple-as-replacing-missing-values-with-the-mean-of-the-non-missing-values-very-simplistic." class="level1">
<h1>- Imputation algorithms can be as simple as replacing missing values with the mean of the non-missing values (very simplistic).</h1>
</section>
<section id="regression-imputation-algorithms-use-models-to-predict-missing-values-as-a-function-of-other-variables-in-the-data." class="level1">
<h1>- Regression imputation algorithms use models to predict missing values as a function of other variables in the data.</h1>
</section>
<section id="pros-maintains-sample-size-multiple-regression-imputation-minimizes-bias-if-missing-at-random" class="level1">
<h1>- Pros: Maintains sample size, multiple regression imputation minimizes bias if ‚Äúmissing at random‚Äù</h1>
</section>
<section id="cons-computationally-intensive" class="level1">
<h1>- Cons: Computationally intensive</h1>
</section>
<section id="section-41" class="level1">
<h1>:::</h1>
</section>
<section id="section-42" class="level1">
<h1></h1>
</section>
<section id="section-43" class="level1">
<h1></h1>
</section>
<section id="deciding-between-these-options-and-proceeding-with-choosing-finer-details-within-an-option-requires-an-understanding-of-the-mechanism-by-which-data-become-missing." class="level1">
<h1>Deciding between these options and proceeding with choosing finer details within an option requires an understanding of the <strong>mechanism</strong> by which data become missing.</h1>
</section>
<section id="section-44" class="level1">
<h1></h1>
</section>
<section id="section-45" class="level1">
<h1></h1>
</section>
<section id="section-46" class="level1">
<h1></h1>
</section>
<section id="missing-data-mechanisms" class="level1">
<h1>## Missing Data Mechanisms</h1>
</section>
<section id="section-47" class="level1">
<h1></h1>
</section>
<section id="the-reasons-for-which-a-variable-might-have-missing-data-are-divided-into-3-mechanisms-mcar-mar-and-mnar." class="level1">
<h1>The reasons for which a variable might have missing data are divided into 3 mechanisms: MCAR, MAR, and MNAR.</h1>
</section>
<section id="section-48" class="level1">
<h1></h1>
</section>
<section id="within-a-dataset-multiple-mechanisms-may-be-presentwe-need-to-consider-the-missingness-mechanism-for-each-variable-individually." class="level1">
<h1>Within a dataset, multiple mechanisms may be present‚Äìwe need to consider the missingness mechanism for each variable individually.</h1>
</section>
<section id="section-49" class="level1">
<h1></h1>
</section>
<section id="section-50" class="level1 incremental">
<h1 class="incremental">:::</h1>
</section>
<section id="missing-completely-at-random-mcar" class="level1">
<h1>- <strong>Missing completely at random (MCAR)</strong>:</h1>
</section>
<section id="the-probability-of-missing-data-for-a-variable-is-the-same-for-all-cases.-implies-that-causes-of-the-missing-data-are-unrelated-to-the-data.-httpsstefvanbuuren.namefimdsec-mcar.html" class="level1">
<h1>- The probability of missing data for a variable is the same for all cases. Implies that causes of the missing data are unrelated to the data. (<a href="https://stefvanbuuren.name/fimd/sec-MCAR.html" class="uri">https://stefvanbuuren.name/fimd/sec-MCAR.html</a>)</h1>
</section>
<section id="examples" class="level1">
<h1>- Examples:</h1>
</section>
<section id="measurement-device-that-runs-out-of-batteries-causes-the-remainder-of-observations-for-the-day-to-be-missing." class="level1">
<h1>- Measurement device that runs out of batteries causes the remainder of observations for the day to be missing.</h1>
</section>
<section id="data-entry-software-requires-a-particular-field-to-be-typo-free-and-missing-values-are-introduced-when-there-are-typos." class="level1">
<h1>- Data entry software requires a particular field to be typo-free, and missing values are introduced when there are typos.</h1>
</section>
<section id="implications-for-downstream-work" class="level1">
<h1>- Implications for downstream work:</h1>
</section>
<section id="if-a-variable-has-mcar-missingness-a-complete-case-analysis-will-be-unbiased-still-valid." class="level1">
<h1>- If a variable has MCAR missingness, a complete case analysis will be unbiased (still valid).</h1>
</section>
<section id="however-with-a-lot-of-missing-observations-a-complete-case-analysis-will-suffer-from-loss-of-statistical-power-ability-to-detect-a-real-difference-and-imputation-will-be-useful-to-retain-the-original-sample-size." class="level1">
<h1>- However, with a lot of missing observations, a complete case analysis will suffer from loss of statistical power (ability to detect a real difference), and imputation will be useful to retain the original sample size.</h1>
</section>
<section id="section-51" class="level1">
<h1></h1>
</section>
<section id="missing-at-random-mar" class="level1">
<h1>- <strong>Missing at random (MAR):</strong></h1>
</section>
<section id="the-probability-of-missing-data-is-related-to-observed-variables-but-unrelated-to-unobserved-information." class="level1">
<h1>- The probability of missing data is related to <strong>observed</strong> variables but unrelated to unobserved information.</h1>
</section>
<section id="examples-1" class="level1">
<h1>- Examples:</h1>
</section>
<section id="blood-pressure-measurements-tend-to-be-missing-in-patients-in-worse-health.-those-in-worse-health-are-more-likely-to-miss-clinic-visits.-better-and-worse-health-can-be-measured-by-a-variety-of-indicators-in-their-health-record." class="level1">
<h1>- Blood pressure measurements tend to be missing in patients in worse health. (Those in worse health are more likely to miss clinic visits.) Better and worse health can be measured by a variety of indicators in their health record.</h1>
</section>
<section id="in-a-survey-older-people-are-more-likely-to-report-their-income-than-younger-people.-missingness-is-related-to-the-observed-age-variable-but-not-to-unobserved-information." class="level1">
<h1>- In a survey, older people are more likely to report their income than younger people. Missingness is related to the observed age variable, but not to unobserved information.</h1>
</section>
<section id="implications-for-downstream-work-1" class="level1">
<h1>- Implications for downstream work:</h1>
</section>
<section id="try-to-use-imputation-methods-that-predict-the-value-of-the-missing-variables-from-other-observed-variables.-assessing-whether-this-can-be-done-accurately-takes-some-explorationwell-explore-this-shortly." class="level1">
<h1>- Try to use imputation methods that predict the value of the missing variables from other observed variables. Assessing whether this can be done accurately takes some exploration‚Äìwe‚Äôll explore this shortly.</h1>
</section>
<section id="section-52" class="level1">
<h1></h1>
</section>
<section id="missing-not-at-random-mnar" class="level1">
<h1>- <strong>Missing not at random (MNAR):</strong></h1>
</section>
<section id="the-probability-of-missing-data-is-related-to-unobserved-variables-and-probably-observed-variables-too." class="level1">
<h1>- The probability of missing data is related to <strong>unobserved</strong> variables (and probably observed variables too).</h1>
</section>
<section id="examples-2" class="level1">
<h1>- Examples:</h1>
</section>
<section id="blood-pressure-measurements-are-more-likely-to-be-missing-for-those-with-the-highest-blood-pressure.-this-is-mnar-rather-than-mar-because-the-missing-data-on-blood-pressure-is-related-to-the-unobserved-values-themselves." class="level1">
<h1>- Blood pressure measurements are more likely to be missing for those with the highest blood pressure. This is MNAR rather than MAR because the missing data on blood pressure is related to the unobserved values themselves.</h1>
</section>
<section id="high-income-individuals-may-be-less-likely-to-report-their-income." class="level1">
<h1>- High-income individuals may be less likely to report their income.</h1>
</section>
<section id="implications-for-downstream-work-2" class="level1">
<h1>- Implications for downstream work:</h1>
</section>
<section id="ideally-we-would-learn-more-about-the-causes-for-the-missingness.-this-could-allow-us-to-use-more-informed-imputation-models." class="level1">
<h1>- Ideally, we would learn more about the causes for the missingness. This could allow us to use more informed imputation models.</h1>
</section>
<section id="example-biological-measurements-that-tend-to-be-missing-because-of-concentrations-that-are-too-low-a-phenomenon-known-as-left-censoring.-imputation-methods-specifically-suited-to-left-censoring-are-useful-here." class="level1">
<h1>- Example: Biological measurements that tend to be missing because of concentrations that are too low (a phenomenon known as left-censoring). Imputation methods specifically suited to left-censoring are useful here.</h1>
</section>
<section id="we-can-use-imputation-methods-with-different-assumptions-about-the-missing-data-and-try-out-a-variety-of-assumptions.-this-lets-us-see-how-sensitive-the-results-are-under-various-scenarios." class="level1">
<h1>- We can use imputation methods with different assumptions about the missing data and try out a variety of assumptions. This lets us see how sensitive the results are under various scenarios.</h1>
</section>
<section id="example-if-higher-incomes-are-more-likely-to-be-missing-we-can-make-different-assumptions-about-what-high-could-be-to-fill-in-the-missing-values-and-see-how-our-results-change-under-these-different-assumptions." class="level1">
<h1>- Example: If higher incomes are more likely to be missing, we can make different assumptions about what ‚Äúhigh‚Äù could be to fill in the missing values and see how our results change under these different assumptions.</h1>
</section>
<section id="section-53" class="level1">
<h1></h1>
</section>
<section id="section-54" class="level1">
<h1>:::</h1>
</section>
<section id="section-55" class="level1">
<h1></h1>
</section>
<section id="exercise" class="level1">
<h1>## Exercise</h1>
</section>
<section id="section-56" class="level1">
<h1></h1>
</section>
<section id="missing-data-mechanism-for-each-of-the-following-situations-propose-what-missing-data-mechanism-you-think-is-most-likely-at-play." class="level1">
<h1>1. <strong>Missing data mechanism</strong> For each of the following situations, propose what missing data mechanism you think is most likely at play.</h1>
</section>
<section id="a.-in-a-clinical-trial-some-patients-dropped-out-before-the-end-of-the-study.-their-reasons-for-dropping-out-were-not-recorded." class="level1">
<h1>a. In a clinical trial, some patients dropped out before the end of the study. Their reasons for dropping out were not recorded.</h1>
</section>
<section id="mnar-probably-the-chance-of-missingness-is-likely-due-to-factors-that-arent-recorded-like-discomfort." class="level1">
<h1>MNAR probably: The chance of missingness is likely due to factors that aren‚Äôt recorded (like discomfort).</h1>
</section>
<section id="b.-a-weather-station-records-temperature-humidity-and-wind-speed-every-hour.-some-of-the-recorded-values-are-missing." class="level1">
<h1>b. A weather station records temperature, humidity, and wind speed every hour. Some of the recorded values are missing.</h1>
</section>
<section id="could-be-mcar-if-the-missing-values-are-from-technical-glitches.-could-be-mar-if-the-missing-values-are-related-to-other-measured-weather-variables.-could-be-mnar-if-the-values-tend-to-be-missing-when-the-values-themselves-are-high-e.g.-high-temperature-humidity-and-wind-speed-causing-measurement-devices-to-malfunction." class="level1">
<h1>Could be MCAR if the missing values are from technical glitches. Could be MAR if the missing values are related to other measured weather variables. Could be MNAR if the values tend to be missing when the values themselves are high (e.g., high temperature, humidity, and wind speed causing measurement devices to malfunction).</h1>
</section>
<section id="c.-a-social-media-platform-collects-data-on-user-interactions-such-as-likes-comments-and-shares.-some-interactions-are-not-recorded-due-to-bugs-in-the-code." class="level1">
<h1>c.&nbsp;A social media platform collects data on user interactions, such as likes, comments, and shares. Some interactions are not recorded due to bugs in the code.</h1>
</section>
<section id="could-be-mcar-if-the-bugs-affected-the-platform-uniformly.-could-be-mar-if-the-bugs-affected-groups-of-users-differently-but-where-the-groupings-are-known-e.g.-bugs-affect-mobile-users-more-and-mobile-vs.-desktop-usage-is-measurable.-could-be-mnar-if-the-bugs-lead-to-performance-issues-that-affect-users-with-slower-internet-more-where-internet-speed-is-likely-not-measured." class="level1">
<h1>Could be MCAR if the bugs affected the platform uniformly. Could be MAR if the bugs affected groups of users differently, but where the groupings are known (e.g., bugs affect mobile users more and mobile vs.&nbsp;desktop usage is measurable). Could be MNAR if the bugs lead to performance issues that affect users with slower internet more (where internet speed is likely not measured).</h1>
</section>
<section id="section-57" class="level1">
<h1></h1>
</section>
<section id="section-58" class="level1">
<h1></h1>
</section>
<section id="section-59" class="level1">
<h1></h1>
</section>
<section id="exploring-missing-data" class="level1">
<h1>## Exploring Missing Data</h1>
</section>
<section id="section-60" class="level1">
<h1></h1>
</section>
<section id="guiding-question-how-can-we-use-visualizations-and-tabulations-to-explore-what-missing-data-mechanisms-may-be-at-play" class="level1">
<h1><strong>Guiding question:</strong> How can we use visualizations and tabulations to explore what missing data mechanisms may be at play?</h1>
</section>
<section id="section-61" class="level1">
<h1></h1>
</section>
<section id="well-look-at-the-airquality-dataset-available-in-base-r-which-gives-daily-air-quality-measurements-in-new-york-from-may-to-september-1973.-you-can-pull-up-the-codebook-with-airquality-in-the-console." class="level1">
<h1>We‚Äôll look at the <code>airquality</code> dataset available in base R, which gives daily air quality measurements in New York from May to September 1973. You can pull up the codebook with <code>?airquality</code> in the Console.</h1>
</section>
<section id="section-62" class="level1">
<h1></h1>
</section>
<section id="r-load_airqual-eval-true-dataairquality" class="level1">
<h1><code>{r load_airqual} # #| eval: true # data(airquality) #</code></h1>
</section>
<section id="section-63" class="level1">
<h1></h1>
</section>
<section id="missingness-by-variable" class="level1">
<h1>## Missingness by Variable</h1>
</section>
<section id="section-64" class="level1">
<h1></h1>
</section>
<section id="we-can-explore-how-much-missingness-there-is-for-each-variable-with-the-following-functions" class="level1">
<h1>We can explore how much missingness there is for each variable with the following functions:</h1>
</section>
<section id="section-65" class="level1">
<h1></h1>
</section>
<section id="r-miss_by_var-eval-true-summaryairquality-summary-statistics-in-addition-to-number-of-nas-naniarvis_missairquality-where-are-nas-located-naniarmiss_var_summaryairquality-information-from-vis_miss-in-table-form" class="level1">
<h1><code>{r miss_by_var} # #| eval: true # summary(airquality) # Summary statistics in addition to number of NA's # naniar::vis_miss(airquality) # Where are NA's located? # naniar::miss_var_summary(airquality) # Information from vis_miss() in table form #</code></h1>
</section>
<section id="section-66" class="level1">
<h1></h1>
</section>
<section id="missingness-by-case" class="level1">
<h1>## Missingness by Case</h1>
</section>
<section id="section-67" class="level1">
<h1></h1>
</section>
<section id="we-can-explore-how-much-missingness-there-is-for-each-case-with-naniarmiss_case_summary." class="level1">
<h1>We can explore how much missingness there is for each case with <code>naniar::miss_case_summary()</code>.</h1>
</section>
<section id="for-each-case-this-function-calculates-the-number-and-percentage-of-variables-with-a-missing-value." class="level1">
<h1>For each case, this function calculates the number and percentage of variables with a missing value.</h1>
</section>
<section id="section-68" class="level1">
<h1></h1>
</section>
<section id="section-69" class="level1">
<h1></h1>
</section>
<section id="impact-of-information-if-the-pct_miss-column-is-large-for-a-case-we-likely-wont-be-able-to-impute-any-of-its-missing-values-because-there-just-isnt-enough-known-informationthis-case-will-have-to-be-dropped-from-the-analysis." class="level1">
<h1><strong>Impact of Information:</strong> If the <code>pct_miss</code> column is large for a case, we likely won‚Äôt be able to impute any of its missing values because there just isn‚Äôt enough known information‚Äìthis case will have to be dropped from the analysis.</h1>
</section>
<section id="section-70" class="level1">
<h1></h1>
</section>
<section id="r-miss_by_case-eval-true-naniarmiss_case_summaryairquality" class="level1">
<h1><code>{r miss_by_case} # #| eval: true # naniar::miss_case_summary(airquality) #</code></h1>
</section>
<section id="section-71" class="level1">
<h1></h1>
</section>
<section id="exploring-missingness-mechanisms" class="level1">
<h1>## Exploring Missingness Mechanisms</h1>
</section>
<section id="section-72" class="level1">
<h1></h1>
</section>
<section id="assessing-missingness-mechanisms-involves-checking-if-missingness-in-a-variable-is-related-to-other-variables." class="level1">
<h1>Assessing missingness mechanisms involves checking if missingness in a variable is related to other variables.</h1>
</section>
<section id="section-73" class="level1">
<h1></h1>
</section>
<section id="note-through-our-available-data-we-are-really-only-able-to-explore-the-potential-for-mcar-or-mar-mechanisms." class="level1">
<h1>Note: Through our available data, we are really only able to explore the potential for MCAR or MAR mechanisms.</h1>
</section>
<section id="section-74" class="level1">
<h1></h1>
</section>
<section id="section-75" class="level1">
<h1></h1>
</section>
<section id="section-76" class="level1">
<h1></h1>
</section>
<section id="impact-of-information-there-is-always-the-chance-that-unobserved-information-unobserved-other-variables-or-unobserved-values-of-the-variables-we-do-have-is-related-to-missingness-for-our-variables-so-to-think-through-the-potential-for-mnar-more-contextual-information-is-necessary." class="level1">
<h1><strong>Impact of Information:</strong> There is always the chance that unobserved information (unobserved other variables or unobserved values of the variables we do have) is related to missingness for our variables, so to think through the potential for MNAR, more contextual information is necessary.</h1>
</section>
<section id="section-77" class="level1">
<h1></h1>
</section>
<section id="section-78" class="level1">
<h1></h1>
</section>
<section id="section-79" class="level1">
<h1></h1>
</section>
<section id="to-explore-these-relationships-we-can-create-truefalse-indicators-of-whether-a-variable-is-missing.-in-the-plots-below-we-use-is.naozone-to-explore-whether-cases-with-missing-ozone-values-are-noticeably-different-from-cases-with-observed-ozone-values-in-terms-of-solar.r." class="level1">
<h1>To explore these relationships, we can create TRUE/FALSE indicators of whether a variable is missing. In the plots below, we use <code>is.na(Ozone)</code> to explore whether cases with missing ozone values are noticeably different from cases with observed ozone values in terms of <code>Solar.R</code>.</h1>
</section>
<section id="section-80" class="level1">
<h1></h1>
</section>
<section id="r-miss_box_dens-libraryggplot2-eval-true-ggplotairquality-aesx-is.naozone-y-solar.r-geom_boxplot-ggplotairquality-aesx-solar.r-color-is.naozone-geom_density" class="level1">
<h1><code>{r miss_box_dens} # library(ggplot2) # #| eval: true # ggplot(airquality, aes(x = is.na(Ozone), y = Solar.R)) +  #     geom_boxplot() # ggplot(airquality, aes(x = Solar.R, color = is.na(Ozone))) +  #     geom_density() #</code></h1>
</section>
<section id="section-81" class="level1">
<h1></h1>
</section>
<section id="the-above-boxplots-and-density-plots-suggest-that-missing-ozone-is-not-strongly-related-to-solar-radiation-levels." class="level1">
<h1>The above boxplots and density plots suggest that missing ozone is not strongly related to solar radiation levels.</h1>
</section>
<section id="section-82" class="level1">
<h1></h1>
</section>
<section id="section-83" class="level1">
<h1></h1>
</section>
<section id="we-still-should-check-if-ozone-missingness-is-related-to-the-wind-temp-month-and-day-variables-to-be-done-in-exercises." class="level1">
<h1>We still should check if ozone missingness is related to the <code>Wind</code>, <code>Temp</code>, <code>Month</code>, and <code>Day</code> variables (to be done in Exercises).</h1>
</section>
<section id="section-84" class="level1">
<h1></h1>
</section>
<section id="section-85" class="level1">
<h1></h1>
</section>
<section id="section-86" class="level1">
<h1></h1>
</section>
<section id="in-addition-to-checking-if-the-chance-of-ozone-missingness-is-related-to-solar.r-we-should-check-if-the-values-of-ozone-could-be-predicted-by-solar.r." class="level1">
<h1>In addition to checking if the <em>chance</em> of ozone missingness is related to <code>Solar.R</code>, we should check if the <em>values</em> of ozone could be predicted by <code>Solar.R</code>.</h1>
</section>
<section id="section-87" class="level1">
<h1></h1>
</section>
<section id="section-88" class="level1">
<h1></h1>
</section>
<section id="in-the-scaterrplot-below-we-look-at-the-relationship-between-ozone-and-solar.r-and-use-vertical-lines-to-indicate-the-solar.r-values-for-cases-that-are-missing-ozone." class="level1">
<h1>In the scaterrplot below, we look at the relationship between <code>Ozone</code> and <code>Solar.R</code> and use vertical lines to indicate the <code>Solar.R</code> values for cases that are missing <code>Ozone</code>.</h1>
</section>
<section id="section-89" class="level1">
<h1></h1>
</section>
<section id="impact-of-information-we-see-that-missing-ozone-cases-are-within-the-observed-span-of-solar.r-so-we-would-be-ok-with-predicting-ozone-from-solar.r-because-there-would-be-no-extrapolation." class="level1">
<h1>- <strong>Impact of Information:</strong> We see that missing <code>Ozone</code> cases are within the observed span of <code>Solar.R</code>, so we would be ok with predicting <code>Ozone</code> from <code>Solar.R</code> because there would be no <strong>extrapolation</strong>.</h1>
</section>
<section id="section-90" class="level1">
<h1></h1>
</section>
<section id="r-miss_scatter_na_markers-eval-true-ggplotairquality-aesx-solar.r-y-ozone-geom_point-geom_smooth-geom_vlinedata-airquality-filteris.naozone-mapping-aesxintercept-solar.r" class="level1">
<h1><code>{r miss_scatter_na_markers} # #| eval: true # ggplot(airquality, aes(x = Solar.R, y = Ozone)) + #     geom_point() + #     geom_smooth() + #     geom_vline(data = airquality |&gt; filter(is.na(Ozone)), mapping = aes(xintercept = Solar.R)) #</code></h1>
</section>
<section id="section-91" class="level1">
<h1></h1>
</section>
<section id="section-92" class="level1">
<h1></h1>
</section>
<section id="section-93" class="level1">
<h1></h1>
</section>
<section id="exercises" class="level1">
<h1>## Exercises</h1>
</section>
<section id="section-94" class="level1">
<h1></h1>
</section>
<section id="mechanism-detection-practice-look-at-the-boxplot-scatterplot-pairs-for-alternate-situations-1-and-2-below.-how-do-these-situations-compare-to-our-actual-situation-and-to-each-other-what-concerns-might-arise-from-using-a-model-to-impute-ozone" class="level1">
<h1>2. <strong>Mechanism detection practice</strong> Look at the boxplot + scatterplot pairs for Alternate Situations 1 and 2 below. How do these situations compare to our actual situation and to each other? What concerns might arise from using a model to impute <code>Ozone</code>?</h1>
</section>
<section id="section-95" class="level1">
<h1></h1>
</section>
<section id="r-miss_scatter_na_markers_alt-libraryreadr-librarytidyverse-eval-true-echo-false-airquality_mod---airquality-mutate-solar.r_mod1-if_elseis.naozone-250-solar.r4-solar.r-solar.r_mod2-if_elseis.naozone-250-solar.r2-solar.r-ggplotairquality_mod-aesx-is.naozone-y-solar.r_mod1-geom_boxplot-labstitle-alternate-situation-1-ggplotairquality_mod-aesx-solar.r_mod1-y-ozone-geom_point-geom_smooth-geom_vlinedata-airquality_mod-filteris.naozone-mapping-aesxintercept-solar.r_mod1-labstitle-alternate-situation-1-ggplotairquality_mod-aesx-is.naozone-y-solar.r_mod2-geom_boxplot-labstitle-alternate-situation-2-ggplotairquality_mod-aesx-solar.r_mod2-y-ozone-geom_point-geom_smooth-geom_vlinedata-airquality_mod-filteris.naozone-mapping-aesxintercept-solar.r_mod2-labstitle-alternate-situation-2" class="level1">
<h1><code>{r miss_scatter_na_markers_alt} # library(readr) # library(tidyverse) # #| eval: true # #| echo: false # airquality_mod &lt;- airquality |&gt;  #     mutate( #         Solar.R_mod1 = if_else(is.na(Ozone), 250 + Solar.R/4, Solar.R), #         Solar.R_mod2 = if_else(is.na(Ozone), 250 + Solar.R/2, Solar.R) #     ) #  # ggplot(airquality_mod, aes(x = is.na(Ozone), y = Solar.R_mod1)) +  #     geom_boxplot() + #     labs(title = "Alternate Situation 1") # ggplot(airquality_mod, aes(x = Solar.R_mod1, y = Ozone)) + #     geom_point() + #     geom_smooth() + #     geom_vline(data = airquality_mod |&gt; filter(is.na(Ozone)), mapping = aes(xintercept = Solar.R_mod1)) + #     labs(title = "Alternate Situation 1") #  # ggplot(airquality_mod, aes(x = is.na(Ozone), y = Solar.R_mod2)) +  #     geom_boxplot() + #     labs(title = "Alternate Situation 2") # ggplot(airquality_mod, aes(x = Solar.R_mod2, y = Ozone)) + #     geom_point() + #     geom_smooth() + #     geom_vline(data = airquality_mod |&gt; filter(is.na(Ozone)), mapping = aes(xintercept = Solar.R_mod2)) + #     labs(title = "Alternate Situation 2") #</code></h1>
</section>
<section id="ozone-is-missing-when-solar-is-at-higher-values-for-both-alternative-situations.-in-alt-1-version-we-have-some-observed-data-in-the-range-of-solar-for-where-ozone-is-missing-so-we-could-predict-it-fairly-well.-in-alt-2-version-ozone-is-missing-when-solar-is-beyond-the-values-of-our-observed-data-so-we-dont-have-a-good-sense-of-what-the-relationship-would-be-between-solar-and-ozone." class="level1">
<h1>Ozone is missing when solar is at higher values for both alternative situations. In alt 1 version, we have some observed data in the range of Solar for where Ozone is missing so we could predict it fairly well. In alt 2 version, Ozone is missing when Solar is beyond the values of our observed data so we don‚Äôt have a good sense of what the relationship would be between Solar and Ozone.</h1>
</section>
<section id="ozone-mechanism-detection-continue-the-investigation-of-missingness-for-ozone." class="level1">
<h1>3. <strong>Ozone mechanism detection</strong> Continue the investigation of missingness for <code>Ozone</code>.</h1>
</section>
<section id="section-96" class="level1">
<h1></h1>
</section>
<section id="we-want-to-see-how-month-wind-and-temp-relate-to-the-chance-of-missingness-for-ozone-and-to-the-value-of-ozone." class="level1">
<h1>We want to see how <code>Month</code>, <code>Wind</code>, and <code>Temp</code> relate to the chance of missingness for <code>Ozone</code> and to the value of <code>Ozone</code>.</h1>
</section>
<section id="section-97" class="level1">
<h1></h1>
</section>
<section id="does-it-look-like-a-linear-regression-model-perhaps-with-variable-transformations-could-be-effective-in-imputing-the-missing-ozone-data" class="level1">
<h1>Does it look like a linear regression model (perhaps with variable transformations) could be effective in imputing the missing ozone data?</h1>
</section>
<section id="section-98" class="level1">
<h1></h1>
</section>
<section id="r-ggplotairquality-aesfill-is.naozone-x-factormonth-geom_barposition-fill-ggplotairquality-aesx-is.naozone-y-wind-geom_boxplot-ggplotairquality-aesx-is.naozone-y-temp-geom_boxplot-ggplotairquality-aesx-factormonth-y-ozone-geom_boxplot-ggplotairquality-aesx-wind-y-ozone-geom_point-geom_smooth-geom_vlinedata-airquality-filteris.naozone-mapping-aesxintercept-wind-ggplotairquality-aesx-temp-y-ozone-geom_point-geom_smooth-geom_vlinedata-airquality-filteris.naozone-mapping-aesxintercept-temp" class="level1">
<h1><code>{r} # ggplot(airquality, aes(fill = is.na(Ozone), x = factor(Month))) + #   geom_bar(position = "fill") #  # ggplot(airquality, aes(x = is.na(Ozone), y = Wind)) + #   geom_boxplot() #  # ggplot(airquality, aes(x = is.na(Ozone), y = Temp)) + #   geom_boxplot() #  # ggplot(airquality, aes(x = factor(Month), y = Ozone)) + #     geom_boxplot() #  # ggplot(airquality, aes(x = Wind, y = Ozone)) + #   geom_point() + #   geom_smooth() + #   geom_vline(data = airquality |&gt; filter(is.na(Ozone)), mapping = aes(xintercept = Wind)) #  # ggplot(airquality, aes(x = Temp, y = Ozone)) + #     geom_point() + #     geom_smooth() + #     geom_vline(data = airquality |&gt; filter(is.na(Ozone)), mapping = aes(xintercept = Temp)) #</code></h1>
</section>
<section id="section-99" class="level1">
<h1></h1>
</section>
<section id="section-100" class="level1">
<h1></h1>
</section>
<section id="section-101" class="level1">
<h1></h1>
</section>
<section id="regression-imputation" class="level1">
<h1>## Regression Imputation</h1>
</section>
<section id="section-102" class="level1">
<h1></h1>
</section>
<section id="when-a-model-is-built-and-used-to-generate-a-single-set-of-predictions-for-missing-values-this-is-known-as-single-imputation." class="level1">
<h1>When a model is built and used to generate a single set of predictions for missing values, this is known as <strong>single imputation</strong>.</h1>
</section>
<section id="section-103" class="level1">
<h1></h1>
</section>
<section id="section-104" class="level1">
<h1></h1>
</section>
<section id="when-using-singly-imputed-data-in-subsequent-modeling-the-uncertainty-in-estimates-tends-to-be-underestimated.-this-means-that" class="level1">
<h1>- When using singly imputed data in subsequent modeling, the uncertainty in estimates tends to be underestimated. This means that:</h1>
</section>
<section id="standard-errors-are-lower-than-they-should-be." class="level1">
<h1>- Standard errors are lower than they should be.</h1>
</section>
<section id="confidence-intervals-wont-contain-the-true-parameter-value-the-advertised-percentage-of-times" class="level1">
<h1>- Confidence intervals won‚Äôt contain the true parameter value the ‚Äúadvertised‚Äù percentage of times</h1>
</section>
<section id="e.g.-95-confidence-intervals-will-not-contain-the-truth-in-95-of-samplesthe-coverage-probability-will-be-less-than-95" class="level1">
<h1>- e.g., 95% confidence intervals will not contain the truth in 95% of samples‚Äìthe coverage probability will be less than 95%</h1>
</section>
<section id="section-105" class="level1">
<h1></h1>
</section>
<section id="section-106" class="level1">
<h1></h1>
</section>
<section id="in-multiple-imputation-multiple-imputed-datasets-are-generated-with-different-values-for-the-filled-in-data." class="level1">
<h1>In <strong>multiple imputation</strong>, multiple imputed datasets are generated with different values for the filled-in data.</h1>
</section>
<section id="section-107" class="level1">
<h1></h1>
</section>
<section id="section-108" class="level1">
<h1></h1>
</section>
<section id="subsequent-models-are-fit-on-each-of-these-datasets-and-both-estimates-and-uncertainty-measures-are-pooled-across-all-of-these-fits." class="level1">
<h1>- Subsequent models are fit on each of these datasets, and both estimates and uncertainty measures are pooled across all of these fits.</h1>
</section>
<section id="multiple-imputation-more-accurately-estimates-uncertainty-measures." class="level1">
<h1>- Multiple imputation more accurately estimates uncertainty measures.</h1>
</section>
<section id="section-109" class="level1">
<h1></h1>
</section>
<section id="simulation-studies" class="level1">
<h1>## Simulation Studies</h1>
</section>
<section id="section-110" class="level1">
<h1></h1>
</section>
<section id="we-can-use-a-simulation-study-to-investigate-the-statistical-properties-described-above." class="level1">
<h1>We can use a <strong>simulation study</strong> to investigate the statistical properties described above.</h1>
</section>
<section id="section-111" class="level1">
<h1></h1>
</section>
<section id="section-112" class="level1 incremental">
<h1 class="incremental">:::</h1>
</section>
<section id="section-113" class="level1">
<h1></h1>
</section>
<section id="generate-simulate-data-where-we-are-in-control-of-missing-data-mechanisms-and-the-true-relationship-between-an-outcome-and-the-predictors." class="level1">
<h1>1. Generate (simulate) data where we are in control of missing data mechanisms and the true relationship between an outcome and the predictors.</h1>
</section>
<section id="on-that-simulated-data-use-single-imputation-to-fill-in-the-missing-values.-fit-the-desired-model-and-obtain-a-confidence-interval-for-a-coefficient-of-interest." class="level1">
<h1>2. On that simulated data, use <strong>single imputation</strong> to fill in the missing values. Fit the desired model, and obtain a confidence interval for a coefficient of interest.</h1>
</section>
<section id="on-that-simulated-data-use-multiple-imputation-to-fill-in-the-missing-values.-fit-the-desired-models-on-all-imputed-datasets-pool-results-and-obtain-a-confidence-interval-for-a-coefficient-of-interest." class="level1">
<h1>3. On that simulated data, use <strong>multiple imputation</strong> to fill in the missing values. Fit the desired models on all imputed datasets, pool results, and obtain a confidence interval for a coefficient of interest.</h1>
</section>
<section id="steps-1---3-are-repeated-a-lot-of-times-num_simulations---1000-to-see-how-things-work-out-in-lots-of-different-samples." class="level1">
<h1>4. Steps 1 - 3 are repeated a lot of times (<code>num_simulations &lt;- 1000</code>) to see how things work out in lots of different samples.</h1>
</section>
<section id="summarize-the-performance-of-single-and-multiple-imputation-across-the-num_simulations-simulations." class="level1">
<h1>5. Summarize the performance of single and multiple imputation across the <code>num_simulations</code> simulations.</h1>
</section>
<section id="section-114" class="level1">
<h1></h1>
</section>
<section id="section-115" class="level1">
<h1>:::</h1>
</section>
<section id="section-116" class="level1">
<h1></h1>
</section>
<section id="we-will-slowly-step-through-the-simulation-study-code-below.-we-will-pause-frequently-for-you-to-add-comments-documenting-what-is-happening." class="level1">
<h1>We will slowly step through the simulation study code below. We will pause frequently for you to add comments documenting what is happening.</h1>
</section>
<section id="section-117" class="level1">
<h1></h1>
</section>
<section id="r-mult_single_sim_study-set.seed224-num_simulations---1000-ci_list---vectorlist-length-num_simulations-system.time-for-i-in-1num_simulations-simulate-data-n---1000-sim_data---tibble-x1-runifn-min-0-max-1-x2-x1-rnormn-mean-0-sd-1-x2_miss_bool-rbinomn-size-1-prob-x12-x2_na-if_elsex2_miss_bool-1-na-x2-y-x1-x2-rnormn-mean-0-sd-1-single-imputation-----------------mice_obj---micesim_data-selectx1-x2_na-y-m-1-method-norm-printflag-false-si_mod---withmice_obj-lmy-x1-x2_na-ci_single---si_modanalyses1-confintlevel-0.95-ci_single---ci_singlex2_na-multiple-imputation---------------mice_obj---micesim_data-selectx1-x2_na-y-m-10-method-norm-printflag-false-mi_mods---withmice_obj-lmy-x1-x2_na-pooled_res---poolmi_mods-summ_pooled_res---summarypooled_res-conf.int-true-conf.level-0.95-ci_multiple_lower---summ_pooled_res-filtertermx2_na-pull2.5-ci_multiple_upper---summ_pooled_res-filtertermx2_na-pull97.5-store-ci-information-ci_listi---tibble-ci_lower-c-ci_single1-ci_multiple_lower-ci_upper-c-ci_single2-ci_multiple_upper-which_imp-csingle-multiple" class="level1">
<h1><code>{r mult_single_sim_study} # set.seed(224) # num_simulations &lt;- 1000 # ci_list &lt;- vector("list", length = num_simulations) #  # system.time({ # for (i in 1:num_simulations) { #     # Simulate data #     n &lt;- 1000 #     sim_data &lt;- tibble( #         x1 = runif(n, min = 0, max = 1), #         x2 = x1 + rnorm(n, mean = 0, sd = 1), #         x2_miss_bool = rbinom(n, size = 1, prob = x1/2), #         x2_NA = if_else(x2_miss_bool == 1, NA, x2), #         y = x1 + x2 + rnorm(n, mean = 0, sd = 1) #     ) #      #     # Single imputation --------------- #     mice_obj &lt;- mice(sim_data |&gt; select(x1, x2_NA, y), m = 1, method = "norm", printFlag = FALSE) #     si_mod &lt;- with(mice_obj, lm(y ~ x1 + x2_NA)) #     ci_single &lt;- si_mod$analyses[[1]] |&gt; confint(level = 0.95) #     ci_single &lt;- ci_single["x2_NA",] #      #     # Multiple imputation ------------- #     mice_obj &lt;- mice(sim_data |&gt; select(x1, x2_NA, y), m = 10, method = "norm", printFlag = FALSE) #     mi_mods &lt;- with(mice_obj, lm(y ~ x1 + x2_NA)) #     pooled_res &lt;- pool(mi_mods) #     summ_pooled_res &lt;- summary(pooled_res, conf.int = TRUE, conf.level = 0.95) #     ci_multiple_lower &lt;- summ_pooled_res |&gt; filter(term=="x2_NA") |&gt; pull(`2.5 %`) #     ci_multiple_upper &lt;- summ_pooled_res |&gt; filter(term=="x2_NA") |&gt; pull(`97.5 %`) #      #     # Store CI information #     ci_list[[i]] &lt;- tibble( #         ci_lower = c( #             ci_single[1], #             ci_multiple_lower #         ), #         ci_upper = c( #             ci_single[2], #             ci_multiple_upper #         ), #         which_imp = c("single", "multiple") #     ) # } # }) #</code></h1>
</section>
<section id="section-118" class="level1">
<h1></h1>
</section>
<section id="below-we-compute-the-confidence-interval-ci-coverage-probability-fraction-of-times-the-ci-contains-the-true-value-of-1-for-the-cis-generated-from-single-and-multiple-imputation" class="level1">
<h1>Below we compute the confidence interval (CI) coverage probability (fraction of times the CI contains the true value of <code>1</code>) for the CIs generated from single and multiple imputation:</h1>
</section>
<section id="section-119" class="level1">
<h1></h1>
</section>
<section id="r-mult_single_sim_study_summ-ci_data---bind_rowsci_list-ci_data-mutatecontains_truth-ci_lower-1-ci_upper-1-group_bywhich_imp-summarizefrac_contains_truth-meancontains_truth" class="level1">
<h1><code>{r mult_single_sim_study_summ} # ci_data &lt;- bind_rows(ci_list) # ci_data |&gt;  #     mutate(contains_truth = ci_lower &lt; 1 &amp; ci_upper &gt; 1) |&gt;  #     group_by(which_imp) |&gt;  #     summarize(frac_contains_truth = mean(contains_truth)) #</code></h1>
</section>
<section id="section-120" class="level1">
<h1></h1>
</section>
<section id="done" class="level1">
<h1>## Done!</h1>
</section>
<section id="section-121" class="level1">
<h1></h1>
</section>
<section id="check-the-ica-instructions-for-how-to-a-push-your-code-to-github-and-b-update-your-portfolio-website" class="level1">
<h1>- Check the ICA Instructions for how to (a) push your code to GitHub and (b) update your portfolio website</h1>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation column-body">
  <div class="nav-page nav-page-previous">
      <a href="../../src/ica/06-wrangling-1-notes.html" class="pagination-link" aria-label="6 Adv Data wrangling P1">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">6 Adv Data wrangling P1</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../src/ica/09-functions-notes.html" class="pagination-link" aria-label="9 Functions">
        <span class="nav-page-text"><span class="chapter-title">9 Functions</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb1" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu"># ---</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu"># title: "8 Missing Data"</span></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu"># ---</span></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="fu"># </span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="fu"># </span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="fu"># ```{r doc_setup_08, echo=FALSE, message=FALSE}</span></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="fu"># library(tidyverse)</span></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="fu"># library(naniar)</span></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="fu"># library(mice)</span></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="fu"># ```</span></span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="fu"># </span></span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="fu"># ## üß© Learning Goals</span></span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="fu"># </span></span>
<span id="cb1-14"><a href="#cb1-14"></a><span class="fu"># By the end of this lesson, you should be able to:</span></span>
<span id="cb1-15"><a href="#cb1-15"></a><span class="fu"># </span></span>
<span id="cb1-16"><a href="#cb1-16"></a><span class="fu"># - Go through a data quality checklist when data wrangling</span></span>
<span id="cb1-17"><a href="#cb1-17"></a><span class="fu"># - Explain the difference between MCAR, MAR, and MNAR missing data mechanisms</span></span>
<span id="cb1-18"><a href="#cb1-18"></a><span class="fu"># - Assess what missing data mechanisms might be at play in a given dataset</span></span>
<span id="cb1-19"><a href="#cb1-19"></a><span class="fu"># - Use visualizations to explore missing data patterns</span></span>
<span id="cb1-20"><a href="#cb1-20"></a><span class="fu"># - Explain why multiple imputation is preferred to single imputation</span></span>
<span id="cb1-21"><a href="#cb1-21"></a><span class="fu"># - Explain how a simulation study can be used to investigate properties of statistical methods</span></span>
<span id="cb1-22"><a href="#cb1-22"></a><span class="fu"># </span></span>
<span id="cb1-23"><a href="#cb1-23"></a><span class="fu"># </span></span>
<span id="cb1-24"><a href="#cb1-24"></a><span class="fu"># ## Data Quality Checklist </span></span>
<span id="cb1-25"><a href="#cb1-25"></a><span class="fu"># </span></span>
<span id="cb1-26"><a href="#cb1-26"></a><span class="fu"># When wrangling / cleaning data, make sure to check the assumptions you make about the data to ensure you don't lose data quality.</span></span>
<span id="cb1-27"><a href="#cb1-27"></a><span class="fu"># </span></span>
<span id="cb1-28"><a href="#cb1-28"></a><span class="fu"># </span></span>
<span id="cb1-29"><a href="#cb1-29"></a><span class="fu"># :::{.incremental}</span></span>
<span id="cb1-30"><a href="#cb1-30"></a><span class="fu"># **Data Parsing** (reading data into a different data format)</span></span>
<span id="cb1-31"><a href="#cb1-31"></a><span class="fu"># </span></span>
<span id="cb1-32"><a href="#cb1-32"></a><span class="fu"># - Always keep the original, raw data (don't manually change it).</span></span>
<span id="cb1-33"><a href="#cb1-33"></a><span class="fu"># - Use Test Cases: Find rows or write test cases to double check the wrangling works as expected</span></span>
<span id="cb1-34"><a href="#cb1-34"></a><span class="fu"># - DATES: When using `lubridate` to parse dates and times, ensure the strings are consistently ordered and formatted correctly, eg,  mm/dd/yy vs. dd/mm/yy. </span></span>
<span id="cb1-35"><a href="#cb1-35"></a><span class="fu"># - STRINGS: When using `stringr` to parse strings with regular expressions, check example rows to ensure that the pattern captured all of the examples you want and excluded the patterns you don't want.</span></span>
<span id="cb1-36"><a href="#cb1-36"></a><span class="fu"># - Always check for missing values to see if the missing ones are expected given the original data.</span></span>
<span id="cb1-37"><a href="#cb1-37"></a><span class="fu"># </span></span>
<span id="cb1-38"><a href="#cb1-38"></a><span class="fu"># :::</span></span>
<span id="cb1-39"><a href="#cb1-39"></a><span class="fu"># </span></span>
<span id="cb1-40"><a href="#cb1-40"></a><span class="fu"># **Data Joining**</span></span>
<span id="cb1-41"><a href="#cb1-41"></a><span class="fu"># </span></span>
<span id="cb1-42"><a href="#cb1-42"></a><span class="fu"># :::{.incremental}</span></span>
<span id="cb1-43"><a href="#cb1-43"></a><span class="fu"># </span></span>
<span id="cb1-44"><a href="#cb1-44"></a><span class="fu"># - Identify missing values in the key variables and decide how to handle them before the merge process (e.g., omitting rows with missing values, imputing missing values).</span></span>
<span id="cb1-45"><a href="#cb1-45"></a><span class="fu"># - Decide on the correct join type (left, right, inner, full, etc.) OR if the data structure is the same use `list_rbind()` to bind rows or `list_cbind()` to bind columns.</span></span>
<span id="cb1-46"><a href="#cb1-46"></a><span class="fu"># - If doing a join, make sure that the key variables (`by`) have the same meaning in both datasets and are represented in the same way (e.g., id = 1 to 20 in first dataset will match id = 1 - 20 in undesirable ways)</span></span>
<span id="cb1-47"><a href="#cb1-47"></a><span class="fu"># - Predict the number of rows that will result from the join and double check the `anti_join()` to see which rows did not find a match.</span></span>
<span id="cb1-48"><a href="#cb1-48"></a><span class="fu"># - Check for duplicate records within each dataset and ensure they are handled appropriately before merging.</span></span>
<span id="cb1-49"><a href="#cb1-49"></a><span class="fu"># - Verify that the merged dataset maintains consistency with the original datasets in terms of data values, variable names, and variable types.</span></span>
<span id="cb1-50"><a href="#cb1-50"></a><span class="fu"># - Perform some preliminary analysis or validation checks on the merged dataset to ensure that it meets the requirements of your analysis.</span></span>
<span id="cb1-51"><a href="#cb1-51"></a><span class="fu"># </span></span>
<span id="cb1-52"><a href="#cb1-52"></a><span class="fu"># :::</span></span>
<span id="cb1-53"><a href="#cb1-53"></a><span class="fu"># </span></span>
<span id="cb1-54"><a href="#cb1-54"></a><span class="fu"># </span></span>
<span id="cb1-55"><a href="#cb1-55"></a><span class="fu"># **Sanity Check: Visualize your data!!!**</span></span>
<span id="cb1-56"><a href="#cb1-56"></a><span class="fu"># </span></span>
<span id="cb1-57"><a href="#cb1-57"></a><span class="fu"># :::{.incremental}</span></span>
<span id="cb1-58"><a href="#cb1-58"></a><span class="fu"># - Do the right number of points appear?</span></span>
<span id="cb1-59"><a href="#cb1-59"></a><span class="fu"># - Do the values seem reasonable?</span></span>
<span id="cb1-60"><a href="#cb1-60"></a><span class="fu"># :::</span></span>
<span id="cb1-61"><a href="#cb1-61"></a><span class="fu"># </span></span>
<span id="cb1-62"><a href="#cb1-62"></a><span class="fu"># ## Explicit v. Implicit Missing Data </span></span>
<span id="cb1-63"><a href="#cb1-63"></a><span class="fu"># </span></span>
<span id="cb1-64"><a href="#cb1-64"></a><span class="fu"># **Explicit missing data** is data that is explicitly marked as missing. In R, this is done with `NA`.</span></span>
<span id="cb1-65"><a href="#cb1-65"></a><span class="fu"># </span></span>
<span id="cb1-66"><a href="#cb1-66"></a><span class="fu"># </span></span>
<span id="cb1-67"><a href="#cb1-67"></a><span class="fu"># **Implicit missing data** is data that is missing but not explicitly marked as such. </span></span>
<span id="cb1-68"><a href="#cb1-68"></a><span class="fu"># </span></span>
<span id="cb1-69"><a href="#cb1-69"></a><span class="fu"># - This can happen when an entire row is missing from a dataset. </span></span>
<span id="cb1-70"><a href="#cb1-70"></a><span class="fu">#     - For example, if a study participant doesn't attend a follow-up visit. It maybe not even be recorded in the data.</span></span>
<span id="cb1-71"><a href="#cb1-71"></a><span class="fu"># </span></span>
<span id="cb1-72"><a href="#cb1-72"></a><span class="fu"># We need to **make implicit missingness explicit** before we can work with the data. </span></span>
<span id="cb1-73"><a href="#cb1-73"></a><span class="fu"># </span></span>
<span id="cb1-74"><a href="#cb1-74"></a><span class="fu"># - Consider the combinations of variables that you'd expect to be fully present in a complete dataset. </span></span>
<span id="cb1-75"><a href="#cb1-75"></a><span class="fu">#     - If a combination is missing, you can create a new row with explicit missing values. </span></span>
<span id="cb1-76"><a href="#cb1-76"></a><span class="fu">#       - For example, if you expect every participant (each has a unique `pid`) to have an observation for each `visit`, you could use the function `complete()` to create that new row and plug in values of `NA` for the missing data.</span></span>
<span id="cb1-77"><a href="#cb1-77"></a><span class="fu"># </span></span>
<span id="cb1-78"><a href="#cb1-78"></a><span class="fu"># ```</span></span>
<span id="cb1-79"><a href="#cb1-79"></a><span class="fu"># study_data_full &lt;- study_data |&gt; </span></span>
<span id="cb1-80"><a href="#cb1-80"></a><span class="fu">#   complete(pid, visit)</span></span>
<span id="cb1-81"><a href="#cb1-81"></a><span class="fu"># ```</span></span>
<span id="cb1-82"><a href="#cb1-82"></a><span class="fu"># </span></span>
<span id="cb1-83"><a href="#cb1-83"></a><span class="fu"># ## Dealing with missing data </span></span>
<span id="cb1-84"><a href="#cb1-84"></a><span class="fu"># </span></span>
<span id="cb1-85"><a href="#cb1-85"></a><span class="fu"># If you have **explicit** missing data, there are 3 main ways of proceeding:</span></span>
<span id="cb1-86"><a href="#cb1-86"></a><span class="fu"># </span></span>
<span id="cb1-87"><a href="#cb1-87"></a><span class="fu"># ::: {.incremental}</span></span>
<span id="cb1-88"><a href="#cb1-88"></a><span class="fu"># </span></span>
<span id="cb1-89"><a href="#cb1-89"></a><span class="fu"># 1. Drop the cases or rows with any missing data from the analysis--a **complete case analysis**</span></span>
<span id="cb1-90"><a href="#cb1-90"></a><span class="fu">#     -  Pro: Easy to implement</span></span>
<span id="cb1-91"><a href="#cb1-91"></a><span class="fu">#     -  Con: reduces sample size, introduces bias if the missing data is not "missing completely at random" </span></span>
<span id="cb1-92"><a href="#cb1-92"></a><span class="fu">#     </span></span>
<span id="cb1-93"><a href="#cb1-93"></a><span class="fu"># 2. Create a category for missing values.</span></span>
<span id="cb1-94"><a href="#cb1-94"></a><span class="fu">#     - Example: The survey question "What is your gender?" might only provide two possible responses: "male" and "female". Missing values for this could indicate that the respondent uses a non-binary designation. Instead of dropping these cases, treating the missing data as its own category ("Does not wish to answer") would be more appropriate.</span></span>
<span id="cb1-95"><a href="#cb1-95"></a><span class="fu">#     - Pros: Maintains sample size, may help us if data is "missing not at random"</span></span>
<span id="cb1-96"><a href="#cb1-96"></a><span class="fu">#     - Cons: Not directly applicable to continuous outcomes (could include interactions with a categorical version in models to account for it)</span></span>
<span id="cb1-97"><a href="#cb1-97"></a><span class="fu">#     </span></span>
<span id="cb1-98"><a href="#cb1-98"></a><span class="fu"># 3. **Impute** (or fill in values for) the missing data using imputation algorithms.</span></span>
<span id="cb1-99"><a href="#cb1-99"></a><span class="fu">#     - Imputation algorithms can be as simple as replacing missing values with the mean of the non-missing values (very simplistic).</span></span>
<span id="cb1-100"><a href="#cb1-100"></a><span class="fu">#     - Regression imputation algorithms use models to predict missing values as a function of other variables in the data.</span></span>
<span id="cb1-101"><a href="#cb1-101"></a><span class="fu">#     - Pros: Maintains sample size, multiple regression imputation minimizes bias if "missing at random" </span></span>
<span id="cb1-102"><a href="#cb1-102"></a><span class="fu">#     - Cons: Computationally intensive</span></span>
<span id="cb1-103"><a href="#cb1-103"></a><span class="fu"># :::</span></span>
<span id="cb1-104"><a href="#cb1-104"></a><span class="fu"># </span></span>
<span id="cb1-105"><a href="#cb1-105"></a><span class="fu"># </span></span>
<span id="cb1-106"><a href="#cb1-106"></a><span class="fu"># Deciding between these options and proceeding with choosing finer details within an option requires an understanding of the **mechanism** by which data become missing.</span></span>
<span id="cb1-107"><a href="#cb1-107"></a><span class="fu"># </span></span>
<span id="cb1-108"><a href="#cb1-108"></a><span class="fu"># </span></span>
<span id="cb1-109"><a href="#cb1-109"></a><span class="fu"># </span></span>
<span id="cb1-110"><a href="#cb1-110"></a><span class="fu"># ## Missing Data Mechanisms </span></span>
<span id="cb1-111"><a href="#cb1-111"></a><span class="fu"># </span></span>
<span id="cb1-112"><a href="#cb1-112"></a><span class="fu"># The reasons for which a variable might have missing data are divided into 3 mechanisms: MCAR, MAR, and MNAR. </span></span>
<span id="cb1-113"><a href="#cb1-113"></a><span class="fu"># </span></span>
<span id="cb1-114"><a href="#cb1-114"></a><span class="fu"># Within a dataset, multiple mechanisms may be present--we need to consider the missingness mechanism for each variable individually.</span></span>
<span id="cb1-115"><a href="#cb1-115"></a><span class="fu"># </span></span>
<span id="cb1-116"><a href="#cb1-116"></a><span class="fu"># ::: {.incremental}</span></span>
<span id="cb1-117"><a href="#cb1-117"></a><span class="fu"># - **Missing completely at random (MCAR)**:</span></span>
<span id="cb1-118"><a href="#cb1-118"></a><span class="fu">#     - The probability of missing data for a variable is the same for all cases. Implies that causes of the missing data are unrelated to the data. (&lt;https://stefvanbuuren.name/fimd/sec-MCAR.html&gt;)</span></span>
<span id="cb1-119"><a href="#cb1-119"></a><span class="fu">#     - Examples:</span></span>
<span id="cb1-120"><a href="#cb1-120"></a><span class="fu">#         - Measurement device that runs out of batteries causes the remainder of observations for the day to be missing.</span></span>
<span id="cb1-121"><a href="#cb1-121"></a><span class="fu">#         - Data entry software requires a particular field to be typo-free, and missing values are introduced when there are typos.</span></span>
<span id="cb1-122"><a href="#cb1-122"></a><span class="fu">#     - Implications for downstream work:</span></span>
<span id="cb1-123"><a href="#cb1-123"></a><span class="fu">#         - If a variable has MCAR missingness, a complete case analysis will be unbiased (still valid).</span></span>
<span id="cb1-124"><a href="#cb1-124"></a><span class="fu">#         - However, with a lot of missing observations, a complete case analysis will suffer from loss of statistical power (ability to detect a real difference), and imputation will be useful to retain the original sample size.</span></span>
<span id="cb1-125"><a href="#cb1-125"></a><span class="fu"># </span></span>
<span id="cb1-126"><a href="#cb1-126"></a><span class="fu"># - **Missing at random (MAR):**</span></span>
<span id="cb1-127"><a href="#cb1-127"></a><span class="fu">#     - The probability of missing data is related to **observed** variables but unrelated to unobserved information.</span></span>
<span id="cb1-128"><a href="#cb1-128"></a><span class="fu">#     - Examples:</span></span>
<span id="cb1-129"><a href="#cb1-129"></a><span class="fu">#         - Blood pressure measurements tend to be missing in patients in worse health. (Those in worse health are more likely to miss clinic visits.) Better and worse health can be measured by a variety of indicators in their health record.</span></span>
<span id="cb1-130"><a href="#cb1-130"></a><span class="fu">#         - In a survey, older people are more likely to report their income than younger people. Missingness is related to the observed age variable, but not to unobserved information.</span></span>
<span id="cb1-131"><a href="#cb1-131"></a><span class="fu">#     - Implications for downstream work:</span></span>
<span id="cb1-132"><a href="#cb1-132"></a><span class="fu">#         - Try to use imputation methods that predict the value of the missing variables from other observed variables. Assessing whether this can be done accurately takes some exploration--we'll explore this shortly.</span></span>
<span id="cb1-133"><a href="#cb1-133"></a><span class="fu"># </span></span>
<span id="cb1-134"><a href="#cb1-134"></a><span class="fu"># - **Missing not at random (MNAR):**</span></span>
<span id="cb1-135"><a href="#cb1-135"></a><span class="fu">#     - The probability of missing data is related to **unobserved** variables (and probably observed variables too).</span></span>
<span id="cb1-136"><a href="#cb1-136"></a><span class="fu">#     - Examples:</span></span>
<span id="cb1-137"><a href="#cb1-137"></a><span class="fu">#         - Blood pressure measurements are more likely to be missing for those with the highest blood pressure. This is MNAR rather than MAR because the missing data on blood pressure is related to the unobserved values themselves.</span></span>
<span id="cb1-138"><a href="#cb1-138"></a><span class="fu">#         - High-income individuals may be less likely to report their income.</span></span>
<span id="cb1-139"><a href="#cb1-139"></a><span class="fu">#     - Implications for downstream work:</span></span>
<span id="cb1-140"><a href="#cb1-140"></a><span class="fu">#         - Ideally, we would learn more about the causes for the missingness. This could allow us to use more informed imputation models.</span></span>
<span id="cb1-141"><a href="#cb1-141"></a><span class="fu">#             - Example: Biological measurements that tend to be missing because of concentrations that are too low (a phenomenon known as left-censoring). Imputation methods specifically suited to left-censoring are useful here.</span></span>
<span id="cb1-142"><a href="#cb1-142"></a><span class="fu">#         - We can use imputation methods with different assumptions about the missing data and try out a variety of assumptions. This lets us see how sensitive the results are under various scenarios.</span></span>
<span id="cb1-143"><a href="#cb1-143"></a><span class="fu">#             - Example: If higher incomes are more likely to be missing, we can make different assumptions about what "high" could be to fill in the missing values and see how our results change under these different assumptions.</span></span>
<span id="cb1-144"><a href="#cb1-144"></a><span class="fu"># </span></span>
<span id="cb1-145"><a href="#cb1-145"></a><span class="fu"># :::</span></span>
<span id="cb1-146"><a href="#cb1-146"></a><span class="fu"># </span></span>
<span id="cb1-147"><a href="#cb1-147"></a><span class="fu"># ## Exercise </span></span>
<span id="cb1-148"><a href="#cb1-148"></a><span class="fu"># </span></span>
<span id="cb1-149"><a href="#cb1-149"></a><span class="fu"># 1. **Missing data mechanism** For each of the following situations, propose what missing data mechanism you think is most likely at play. </span></span>
<span id="cb1-150"><a href="#cb1-150"></a><span class="fu">#   a. In a clinical trial, some patients dropped out before the end of the study. Their reasons for dropping out were not recorded.</span></span>
<span id="cb1-151"><a href="#cb1-151"></a><span class="fu">#   MNAR probably: The chance of missingness is likely due to factors that aren‚Äôt recorded (like discomfort). </span></span>
<span id="cb1-152"><a href="#cb1-152"></a><span class="fu">#   b. A weather station records temperature, humidity, and wind speed every hour. Some of the recorded values are missing.</span></span>
<span id="cb1-153"><a href="#cb1-153"></a><span class="fu">#   Could be MCAR if the missing values are from technical glitches. Could be MAR if the missing values are related to other measured weather variables. Could be MNAR if the values tend to be missing when the values themselves are high (e.g., high temperature, humidity, and wind speed causing measurement devices to malfunction). </span></span>
<span id="cb1-154"><a href="#cb1-154"></a><span class="fu">#   c. A social media platform collects data on user interactions, such as likes, comments, and shares. Some interactions are not recorded due to bugs in the code.</span></span>
<span id="cb1-155"><a href="#cb1-155"></a><span class="fu">#   Could be MCAR if the bugs affected the platform uniformly. Could be MAR if the bugs affected groups of users differently, but where the groupings are known (e.g., bugs affect mobile users more and mobile vs. desktop usage is measurable). Could be MNAR if the bugs lead to performance issues that affect users with slower internet more (where internet speed is likely not measured).</span></span>
<span id="cb1-156"><a href="#cb1-156"></a><span class="fu"># </span></span>
<span id="cb1-157"><a href="#cb1-157"></a><span class="fu"># </span></span>
<span id="cb1-158"><a href="#cb1-158"></a><span class="fu"># </span></span>
<span id="cb1-159"><a href="#cb1-159"></a><span class="fu"># ## Exploring Missing Data </span></span>
<span id="cb1-160"><a href="#cb1-160"></a><span class="fu"># </span></span>
<span id="cb1-161"><a href="#cb1-161"></a><span class="fu"># **Guiding question:** How can we use visualizations and tabulations to explore what missing data mechanisms may be at play?</span></span>
<span id="cb1-162"><a href="#cb1-162"></a><span class="fu"># </span></span>
<span id="cb1-163"><a href="#cb1-163"></a><span class="fu"># We'll look at the `airquality` dataset available in base R, which gives daily air quality measurements in New York from May to September 1973. You can pull up the codebook with `?airquality` in the Console.</span></span>
<span id="cb1-164"><a href="#cb1-164"></a><span class="fu"># </span></span>
<span id="cb1-165"><a href="#cb1-165"></a><span class="fu"># ```{r load_airqual}</span></span>
<span id="cb1-166"><a href="#cb1-166"></a><span class="fu"># #| eval: true</span></span>
<span id="cb1-167"><a href="#cb1-167"></a><span class="fu"># data(airquality)</span></span>
<span id="cb1-168"><a href="#cb1-168"></a><span class="fu"># ```</span></span>
<span id="cb1-169"><a href="#cb1-169"></a><span class="fu"># </span></span>
<span id="cb1-170"><a href="#cb1-170"></a><span class="fu"># ## Missingness by Variable </span></span>
<span id="cb1-171"><a href="#cb1-171"></a><span class="fu"># </span></span>
<span id="cb1-172"><a href="#cb1-172"></a><span class="fu"># We can explore how much missingness there is for each variable with the following functions:</span></span>
<span id="cb1-173"><a href="#cb1-173"></a><span class="fu"># </span></span>
<span id="cb1-174"><a href="#cb1-174"></a><span class="fu"># ```{r miss_by_var}</span></span>
<span id="cb1-175"><a href="#cb1-175"></a><span class="fu"># #| eval: true</span></span>
<span id="cb1-176"><a href="#cb1-176"></a><span class="fu"># summary(airquality) # Summary statistics in addition to number of NA's</span></span>
<span id="cb1-177"><a href="#cb1-177"></a><span class="fu"># naniar::vis_miss(airquality) # Where are NA's located?</span></span>
<span id="cb1-178"><a href="#cb1-178"></a><span class="fu"># naniar::miss_var_summary(airquality) # Information from vis_miss() in table form</span></span>
<span id="cb1-179"><a href="#cb1-179"></a><span class="fu"># ```</span></span>
<span id="cb1-180"><a href="#cb1-180"></a><span class="fu"># </span></span>
<span id="cb1-181"><a href="#cb1-181"></a><span class="fu"># ## Missingness by Case </span></span>
<span id="cb1-182"><a href="#cb1-182"></a><span class="fu"># </span></span>
<span id="cb1-183"><a href="#cb1-183"></a><span class="fu"># We can explore how much missingness there is for each case with `naniar::miss_case_summary()`. </span></span>
<span id="cb1-184"><a href="#cb1-184"></a><span class="fu"># For each case, this function calculates the number and percentage of variables with a missing value. </span></span>
<span id="cb1-185"><a href="#cb1-185"></a><span class="fu"># </span></span>
<span id="cb1-186"><a href="#cb1-186"></a><span class="fu"># </span></span>
<span id="cb1-187"><a href="#cb1-187"></a><span class="fu"># **Impact of Information:** If the `pct_miss` column is large for a case, we likely won't be able to impute any of its missing values because there just isn't enough known information--this case will have to be dropped from the analysis.</span></span>
<span id="cb1-188"><a href="#cb1-188"></a><span class="fu"># </span></span>
<span id="cb1-189"><a href="#cb1-189"></a><span class="fu"># ```{r miss_by_case}</span></span>
<span id="cb1-190"><a href="#cb1-190"></a><span class="fu"># #| eval: true</span></span>
<span id="cb1-191"><a href="#cb1-191"></a><span class="fu"># naniar::miss_case_summary(airquality)</span></span>
<span id="cb1-192"><a href="#cb1-192"></a><span class="fu"># ```</span></span>
<span id="cb1-193"><a href="#cb1-193"></a><span class="fu"># </span></span>
<span id="cb1-194"><a href="#cb1-194"></a><span class="fu"># ## Exploring Missingness Mechanisms </span></span>
<span id="cb1-195"><a href="#cb1-195"></a><span class="fu"># </span></span>
<span id="cb1-196"><a href="#cb1-196"></a><span class="fu"># Assessing missingness mechanisms involves checking if missingness in a variable is related to other variables. </span></span>
<span id="cb1-197"><a href="#cb1-197"></a><span class="fu"># </span></span>
<span id="cb1-198"><a href="#cb1-198"></a><span class="fu"># Note: Through our available data, we are really only able to explore the potential for MCAR or MAR mechanisms. </span></span>
<span id="cb1-199"><a href="#cb1-199"></a><span class="fu"># </span></span>
<span id="cb1-200"><a href="#cb1-200"></a><span class="fu"># </span></span>
<span id="cb1-201"><a href="#cb1-201"></a><span class="fu"># </span></span>
<span id="cb1-202"><a href="#cb1-202"></a><span class="fu"># **Impact of Information:** There is always the chance that unobserved information (unobserved other variables or unobserved values of the variables we do have) is related to missingness for our variables, so to think through the potential for MNAR, more contextual information is necessary.</span></span>
<span id="cb1-203"><a href="#cb1-203"></a><span class="fu"># </span></span>
<span id="cb1-204"><a href="#cb1-204"></a><span class="fu"># </span></span>
<span id="cb1-205"><a href="#cb1-205"></a><span class="fu"># </span></span>
<span id="cb1-206"><a href="#cb1-206"></a><span class="fu"># To explore these relationships, we can create TRUE/FALSE indicators of whether a variable is missing. In the plots below, we use `is.na(Ozone)` to explore whether cases with missing ozone values are noticeably different from cases with observed ozone values in terms of `Solar.R`.</span></span>
<span id="cb1-207"><a href="#cb1-207"></a><span class="fu"># </span></span>
<span id="cb1-208"><a href="#cb1-208"></a><span class="fu"># ```{r miss_box_dens}</span></span>
<span id="cb1-209"><a href="#cb1-209"></a><span class="fu"># library(ggplot2)</span></span>
<span id="cb1-210"><a href="#cb1-210"></a><span class="fu"># #| eval: true</span></span>
<span id="cb1-211"><a href="#cb1-211"></a><span class="fu"># ggplot(airquality, aes(x = is.na(Ozone), y = Solar.R)) + </span></span>
<span id="cb1-212"><a href="#cb1-212"></a><span class="fu">#     geom_boxplot()</span></span>
<span id="cb1-213"><a href="#cb1-213"></a><span class="fu"># ggplot(airquality, aes(x = Solar.R, color = is.na(Ozone))) + </span></span>
<span id="cb1-214"><a href="#cb1-214"></a><span class="fu">#     geom_density()</span></span>
<span id="cb1-215"><a href="#cb1-215"></a><span class="fu"># ```</span></span>
<span id="cb1-216"><a href="#cb1-216"></a><span class="fu"># </span></span>
<span id="cb1-217"><a href="#cb1-217"></a><span class="fu"># The above boxplots and density plots suggest that missing ozone is not strongly related to solar radiation levels. </span></span>
<span id="cb1-218"><a href="#cb1-218"></a><span class="fu"># </span></span>
<span id="cb1-219"><a href="#cb1-219"></a><span class="fu"># </span></span>
<span id="cb1-220"><a href="#cb1-220"></a><span class="fu"># We still should check if ozone missingness is related to the `Wind`, `Temp`, `Month`, and `Day` variables (to be done in Exercises).</span></span>
<span id="cb1-221"><a href="#cb1-221"></a><span class="fu"># </span></span>
<span id="cb1-222"><a href="#cb1-222"></a><span class="fu"># </span></span>
<span id="cb1-223"><a href="#cb1-223"></a><span class="fu"># </span></span>
<span id="cb1-224"><a href="#cb1-224"></a><span class="fu"># In addition to checking if the *chance* of ozone missingness is related to `Solar.R`, we should check if the *values* of ozone could be predicted by `Solar.R`. </span></span>
<span id="cb1-225"><a href="#cb1-225"></a><span class="fu"># </span></span>
<span id="cb1-226"><a href="#cb1-226"></a><span class="fu"># </span></span>
<span id="cb1-227"><a href="#cb1-227"></a><span class="fu"># In the scaterrplot below, we look at the relationship between `Ozone` and `Solar.R` and use vertical lines to indicate the `Solar.R` values for cases that are missing `Ozone`.</span></span>
<span id="cb1-228"><a href="#cb1-228"></a><span class="fu"># </span></span>
<span id="cb1-229"><a href="#cb1-229"></a><span class="fu"># - **Impact of Information:** We see that missing `Ozone` cases are within the observed span of `Solar.R`, so we would be ok with predicting `Ozone` from `Solar.R` because there would be no **extrapolation**.</span></span>
<span id="cb1-230"><a href="#cb1-230"></a><span class="fu"># </span></span>
<span id="cb1-231"><a href="#cb1-231"></a><span class="fu"># ```{r miss_scatter_na_markers}</span></span>
<span id="cb1-232"><a href="#cb1-232"></a><span class="fu"># #| eval: true</span></span>
<span id="cb1-233"><a href="#cb1-233"></a><span class="fu"># ggplot(airquality, aes(x = Solar.R, y = Ozone)) +</span></span>
<span id="cb1-234"><a href="#cb1-234"></a><span class="fu">#     geom_point() +</span></span>
<span id="cb1-235"><a href="#cb1-235"></a><span class="fu">#     geom_smooth() +</span></span>
<span id="cb1-236"><a href="#cb1-236"></a><span class="fu">#     geom_vline(data = airquality |&gt; filter(is.na(Ozone)), mapping = aes(xintercept = Solar.R))</span></span>
<span id="cb1-237"><a href="#cb1-237"></a><span class="fu"># ```</span></span>
<span id="cb1-238"><a href="#cb1-238"></a><span class="fu"># </span></span>
<span id="cb1-239"><a href="#cb1-239"></a><span class="fu"># </span></span>
<span id="cb1-240"><a href="#cb1-240"></a><span class="fu"># </span></span>
<span id="cb1-241"><a href="#cb1-241"></a><span class="fu"># ## Exercises </span></span>
<span id="cb1-242"><a href="#cb1-242"></a><span class="fu"># </span></span>
<span id="cb1-243"><a href="#cb1-243"></a><span class="fu"># 2. **Mechanism detection practice** Look at the boxplot + scatterplot pairs for Alternate Situations 1 and 2 below. How do these situations compare to our actual situation and to each other? What concerns might arise from using a model to impute `Ozone`?</span></span>
<span id="cb1-244"><a href="#cb1-244"></a><span class="fu"># </span></span>
<span id="cb1-245"><a href="#cb1-245"></a><span class="fu"># ```{r miss_scatter_na_markers_alt}</span></span>
<span id="cb1-246"><a href="#cb1-246"></a><span class="fu"># library(readr)</span></span>
<span id="cb1-247"><a href="#cb1-247"></a><span class="fu"># library(tidyverse)</span></span>
<span id="cb1-248"><a href="#cb1-248"></a><span class="fu"># #| eval: true</span></span>
<span id="cb1-249"><a href="#cb1-249"></a><span class="fu"># #| echo: false</span></span>
<span id="cb1-250"><a href="#cb1-250"></a><span class="fu"># airquality_mod &lt;- airquality |&gt; </span></span>
<span id="cb1-251"><a href="#cb1-251"></a><span class="fu">#     mutate(</span></span>
<span id="cb1-252"><a href="#cb1-252"></a><span class="fu">#         Solar.R_mod1 = if_else(is.na(Ozone), 250 + Solar.R/4, Solar.R),</span></span>
<span id="cb1-253"><a href="#cb1-253"></a><span class="fu">#         Solar.R_mod2 = if_else(is.na(Ozone), 250 + Solar.R/2, Solar.R)</span></span>
<span id="cb1-254"><a href="#cb1-254"></a><span class="fu">#     )</span></span>
<span id="cb1-255"><a href="#cb1-255"></a><span class="fu"># </span></span>
<span id="cb1-256"><a href="#cb1-256"></a><span class="fu"># ggplot(airquality_mod, aes(x = is.na(Ozone), y = Solar.R_mod1)) + </span></span>
<span id="cb1-257"><a href="#cb1-257"></a><span class="fu">#     geom_boxplot() +</span></span>
<span id="cb1-258"><a href="#cb1-258"></a><span class="fu">#     labs(title = "Alternate Situation 1")</span></span>
<span id="cb1-259"><a href="#cb1-259"></a><span class="fu"># ggplot(airquality_mod, aes(x = Solar.R_mod1, y = Ozone)) +</span></span>
<span id="cb1-260"><a href="#cb1-260"></a><span class="fu">#     geom_point() +</span></span>
<span id="cb1-261"><a href="#cb1-261"></a><span class="fu">#     geom_smooth() +</span></span>
<span id="cb1-262"><a href="#cb1-262"></a><span class="fu">#     geom_vline(data = airquality_mod |&gt; filter(is.na(Ozone)), mapping = aes(xintercept = Solar.R_mod1)) +</span></span>
<span id="cb1-263"><a href="#cb1-263"></a><span class="fu">#     labs(title = "Alternate Situation 1")</span></span>
<span id="cb1-264"><a href="#cb1-264"></a><span class="fu"># </span></span>
<span id="cb1-265"><a href="#cb1-265"></a><span class="fu"># ggplot(airquality_mod, aes(x = is.na(Ozone), y = Solar.R_mod2)) + </span></span>
<span id="cb1-266"><a href="#cb1-266"></a><span class="fu">#     geom_boxplot() +</span></span>
<span id="cb1-267"><a href="#cb1-267"></a><span class="fu">#     labs(title = "Alternate Situation 2")</span></span>
<span id="cb1-268"><a href="#cb1-268"></a><span class="fu"># ggplot(airquality_mod, aes(x = Solar.R_mod2, y = Ozone)) +</span></span>
<span id="cb1-269"><a href="#cb1-269"></a><span class="fu">#     geom_point() +</span></span>
<span id="cb1-270"><a href="#cb1-270"></a><span class="fu">#     geom_smooth() +</span></span>
<span id="cb1-271"><a href="#cb1-271"></a><span class="fu">#     geom_vline(data = airquality_mod |&gt; filter(is.na(Ozone)), mapping = aes(xintercept = Solar.R_mod2)) +</span></span>
<span id="cb1-272"><a href="#cb1-272"></a><span class="fu">#     labs(title = "Alternate Situation 2")</span></span>
<span id="cb1-273"><a href="#cb1-273"></a><span class="fu"># ```</span></span>
<span id="cb1-274"><a href="#cb1-274"></a><span class="fu"># Ozone is missing when solar is at higher values for both alternative situations. In alt 1 version, we have some observed data in the range of Solar for where Ozone is missing so we could predict it fairly well. In alt 2 version, Ozone is missing when Solar is beyond the values of our observed data so we don't have a good sense of what the relationship would be between Solar and Ozone.</span></span>
<span id="cb1-275"><a href="#cb1-275"></a><span class="fu"># 3. **Ozone mechanism detection** Continue the investigation of missingness for `Ozone`. </span></span>
<span id="cb1-276"><a href="#cb1-276"></a><span class="fu"># </span></span>
<span id="cb1-277"><a href="#cb1-277"></a><span class="fu"># We want to see how `Month`, `Wind`, and `Temp` relate to the chance of missingness for `Ozone` and to the value of `Ozone`.</span></span>
<span id="cb1-278"><a href="#cb1-278"></a><span class="fu"># </span></span>
<span id="cb1-279"><a href="#cb1-279"></a><span class="fu"># Does it look like a linear regression model (perhaps with variable transformations) could be effective in imputing the missing ozone data?</span></span>
<span id="cb1-280"><a href="#cb1-280"></a><span class="fu"># </span></span>
<span id="cb1-281"><a href="#cb1-281"></a><span class="fu"># ```{r}</span></span>
<span id="cb1-282"><a href="#cb1-282"></a><span class="fu"># ggplot(airquality, aes(fill = is.na(Ozone), x = factor(Month))) +</span></span>
<span id="cb1-283"><a href="#cb1-283"></a><span class="fu">#   geom_bar(position = "fill")</span></span>
<span id="cb1-284"><a href="#cb1-284"></a><span class="fu"># </span></span>
<span id="cb1-285"><a href="#cb1-285"></a><span class="fu"># ggplot(airquality, aes(x = is.na(Ozone), y = Wind)) +</span></span>
<span id="cb1-286"><a href="#cb1-286"></a><span class="fu">#   geom_boxplot()</span></span>
<span id="cb1-287"><a href="#cb1-287"></a><span class="fu"># </span></span>
<span id="cb1-288"><a href="#cb1-288"></a><span class="fu"># ggplot(airquality, aes(x = is.na(Ozone), y = Temp)) +</span></span>
<span id="cb1-289"><a href="#cb1-289"></a><span class="fu">#   geom_boxplot()</span></span>
<span id="cb1-290"><a href="#cb1-290"></a><span class="fu"># </span></span>
<span id="cb1-291"><a href="#cb1-291"></a><span class="fu"># ggplot(airquality, aes(x = factor(Month), y = Ozone)) +</span></span>
<span id="cb1-292"><a href="#cb1-292"></a><span class="fu">#     geom_boxplot()</span></span>
<span id="cb1-293"><a href="#cb1-293"></a><span class="fu"># </span></span>
<span id="cb1-294"><a href="#cb1-294"></a><span class="fu"># ggplot(airquality, aes(x = Wind, y = Ozone)) +</span></span>
<span id="cb1-295"><a href="#cb1-295"></a><span class="fu">#   geom_point() +</span></span>
<span id="cb1-296"><a href="#cb1-296"></a><span class="fu">#   geom_smooth() +</span></span>
<span id="cb1-297"><a href="#cb1-297"></a><span class="fu">#   geom_vline(data = airquality |&gt; filter(is.na(Ozone)), mapping = aes(xintercept = Wind))</span></span>
<span id="cb1-298"><a href="#cb1-298"></a><span class="fu"># </span></span>
<span id="cb1-299"><a href="#cb1-299"></a><span class="fu"># ggplot(airquality, aes(x = Temp, y = Ozone)) +</span></span>
<span id="cb1-300"><a href="#cb1-300"></a><span class="fu">#     geom_point() +</span></span>
<span id="cb1-301"><a href="#cb1-301"></a><span class="fu">#     geom_smooth() +</span></span>
<span id="cb1-302"><a href="#cb1-302"></a><span class="fu">#     geom_vline(data = airquality |&gt; filter(is.na(Ozone)), mapping = aes(xintercept = Temp))</span></span>
<span id="cb1-303"><a href="#cb1-303"></a><span class="fu"># ```</span></span>
<span id="cb1-304"><a href="#cb1-304"></a><span class="fu"># </span></span>
<span id="cb1-305"><a href="#cb1-305"></a><span class="fu"># </span></span>
<span id="cb1-306"><a href="#cb1-306"></a><span class="fu"># </span></span>
<span id="cb1-307"><a href="#cb1-307"></a><span class="fu"># ## Regression Imputation </span></span>
<span id="cb1-308"><a href="#cb1-308"></a><span class="fu"># </span></span>
<span id="cb1-309"><a href="#cb1-309"></a><span class="fu"># When a model is built and used to generate a single set of predictions for missing values, this is known as **single imputation**. </span></span>
<span id="cb1-310"><a href="#cb1-310"></a><span class="fu"># </span></span>
<span id="cb1-311"><a href="#cb1-311"></a><span class="fu"># </span></span>
<span id="cb1-312"><a href="#cb1-312"></a><span class="fu"># - When using singly imputed data in subsequent modeling, the uncertainty in estimates tends to be underestimated. This means that:</span></span>
<span id="cb1-313"><a href="#cb1-313"></a><span class="fu">#     - Standard errors are lower than they should be.</span></span>
<span id="cb1-314"><a href="#cb1-314"></a><span class="fu">#     - Confidence intervals won't contain the true parameter value the "advertised" percentage of times</span></span>
<span id="cb1-315"><a href="#cb1-315"></a><span class="fu">#         - e.g., 95% confidence intervals will not contain the truth in 95% of samples--the coverage probability will be less than 95%</span></span>
<span id="cb1-316"><a href="#cb1-316"></a><span class="fu"># </span></span>
<span id="cb1-317"><a href="#cb1-317"></a><span class="fu"># </span></span>
<span id="cb1-318"><a href="#cb1-318"></a><span class="fu"># In **multiple imputation**, multiple imputed datasets are generated with different values for the filled-in data. </span></span>
<span id="cb1-319"><a href="#cb1-319"></a><span class="fu"># </span></span>
<span id="cb1-320"><a href="#cb1-320"></a><span class="fu"># </span></span>
<span id="cb1-321"><a href="#cb1-321"></a><span class="fu"># - Subsequent models are fit on each of these datasets, and both estimates and uncertainty measures are pooled across all of these fits. </span></span>
<span id="cb1-322"><a href="#cb1-322"></a><span class="fu"># - Multiple imputation more accurately estimates uncertainty measures.</span></span>
<span id="cb1-323"><a href="#cb1-323"></a><span class="fu"># </span></span>
<span id="cb1-324"><a href="#cb1-324"></a><span class="fu"># ## Simulation Studies </span></span>
<span id="cb1-325"><a href="#cb1-325"></a><span class="fu"># </span></span>
<span id="cb1-326"><a href="#cb1-326"></a><span class="fu"># We can use a **simulation study** to investigate the statistical properties described above.</span></span>
<span id="cb1-327"><a href="#cb1-327"></a><span class="fu"># </span></span>
<span id="cb1-328"><a href="#cb1-328"></a><span class="fu"># ::: {.incremental}</span></span>
<span id="cb1-329"><a href="#cb1-329"></a><span class="fu"># </span></span>
<span id="cb1-330"><a href="#cb1-330"></a><span class="fu"># 1. Generate (simulate) data where we are in control of missing data mechanisms and the true relationship between an outcome and the predictors.</span></span>
<span id="cb1-331"><a href="#cb1-331"></a><span class="fu"># 2. On that simulated data, use **single imputation** to fill in the missing values. Fit the desired model, and obtain a confidence interval for a coefficient of interest.</span></span>
<span id="cb1-332"><a href="#cb1-332"></a><span class="fu"># 3. On that simulated data, use **multiple imputation** to fill in the missing values. Fit the desired models on all imputed datasets, pool results, and obtain a confidence interval for a coefficient of interest.</span></span>
<span id="cb1-333"><a href="#cb1-333"></a><span class="fu"># 4. Steps 1 - 3 are repeated a lot of times (`num_simulations &lt;- 1000`) to see how things work out in lots of different samples.</span></span>
<span id="cb1-334"><a href="#cb1-334"></a><span class="fu"># 5. Summarize the performance of single and multiple imputation across the `num_simulations` simulations.</span></span>
<span id="cb1-335"><a href="#cb1-335"></a><span class="fu"># </span></span>
<span id="cb1-336"><a href="#cb1-336"></a><span class="fu"># :::</span></span>
<span id="cb1-337"><a href="#cb1-337"></a><span class="fu"># </span></span>
<span id="cb1-338"><a href="#cb1-338"></a><span class="fu"># We will slowly step through the simulation study code below. We will pause frequently for you to add comments documenting what is happening. </span></span>
<span id="cb1-339"><a href="#cb1-339"></a><span class="fu"># </span></span>
<span id="cb1-340"><a href="#cb1-340"></a><span class="fu"># ```{r mult_single_sim_study}</span></span>
<span id="cb1-341"><a href="#cb1-341"></a><span class="fu"># set.seed(224)</span></span>
<span id="cb1-342"><a href="#cb1-342"></a><span class="fu"># num_simulations &lt;- 1000</span></span>
<span id="cb1-343"><a href="#cb1-343"></a><span class="fu"># ci_list &lt;- vector("list", length = num_simulations)</span></span>
<span id="cb1-344"><a href="#cb1-344"></a><span class="fu"># </span></span>
<span id="cb1-345"><a href="#cb1-345"></a><span class="fu"># system.time({</span></span>
<span id="cb1-346"><a href="#cb1-346"></a><span class="fu"># for (i in 1:num_simulations) {</span></span>
<span id="cb1-347"><a href="#cb1-347"></a><span class="fu">#     # Simulate data</span></span>
<span id="cb1-348"><a href="#cb1-348"></a><span class="fu">#     n &lt;- 1000</span></span>
<span id="cb1-349"><a href="#cb1-349"></a><span class="fu">#     sim_data &lt;- tibble(</span></span>
<span id="cb1-350"><a href="#cb1-350"></a><span class="fu">#         x1 = runif(n, min = 0, max = 1),</span></span>
<span id="cb1-351"><a href="#cb1-351"></a><span class="fu">#         x2 = x1 + rnorm(n, mean = 0, sd = 1),</span></span>
<span id="cb1-352"><a href="#cb1-352"></a><span class="fu">#         x2_miss_bool = rbinom(n, size = 1, prob = x1/2),</span></span>
<span id="cb1-353"><a href="#cb1-353"></a><span class="fu">#         x2_NA = if_else(x2_miss_bool == 1, NA, x2),</span></span>
<span id="cb1-354"><a href="#cb1-354"></a><span class="fu">#         y = x1 + x2 + rnorm(n, mean = 0, sd = 1)</span></span>
<span id="cb1-355"><a href="#cb1-355"></a><span class="fu">#     )</span></span>
<span id="cb1-356"><a href="#cb1-356"></a><span class="fu">#     </span></span>
<span id="cb1-357"><a href="#cb1-357"></a><span class="fu">#     # Single imputation ---------------</span></span>
<span id="cb1-358"><a href="#cb1-358"></a><span class="fu">#     mice_obj &lt;- mice(sim_data |&gt; select(x1, x2_NA, y), m = 1, method = "norm", printFlag = FALSE)</span></span>
<span id="cb1-359"><a href="#cb1-359"></a><span class="fu">#     si_mod &lt;- with(mice_obj, lm(y ~ x1 + x2_NA))</span></span>
<span id="cb1-360"><a href="#cb1-360"></a><span class="fu">#     ci_single &lt;- si_mod$analyses[[1]] |&gt; confint(level = 0.95)</span></span>
<span id="cb1-361"><a href="#cb1-361"></a><span class="fu">#     ci_single &lt;- ci_single["x2_NA",]</span></span>
<span id="cb1-362"><a href="#cb1-362"></a><span class="fu">#     </span></span>
<span id="cb1-363"><a href="#cb1-363"></a><span class="fu">#     # Multiple imputation -------------</span></span>
<span id="cb1-364"><a href="#cb1-364"></a><span class="fu">#     mice_obj &lt;- mice(sim_data |&gt; select(x1, x2_NA, y), m = 10, method = "norm", printFlag = FALSE)</span></span>
<span id="cb1-365"><a href="#cb1-365"></a><span class="fu">#     mi_mods &lt;- with(mice_obj, lm(y ~ x1 + x2_NA))</span></span>
<span id="cb1-366"><a href="#cb1-366"></a><span class="fu">#     pooled_res &lt;- pool(mi_mods)</span></span>
<span id="cb1-367"><a href="#cb1-367"></a><span class="fu">#     summ_pooled_res &lt;- summary(pooled_res, conf.int = TRUE, conf.level = 0.95)</span></span>
<span id="cb1-368"><a href="#cb1-368"></a><span class="fu">#     ci_multiple_lower &lt;- summ_pooled_res |&gt; filter(term=="x2_NA") |&gt; pull(`2.5 %`)</span></span>
<span id="cb1-369"><a href="#cb1-369"></a><span class="fu">#     ci_multiple_upper &lt;- summ_pooled_res |&gt; filter(term=="x2_NA") |&gt; pull(`97.5 %`)</span></span>
<span id="cb1-370"><a href="#cb1-370"></a><span class="fu">#     </span></span>
<span id="cb1-371"><a href="#cb1-371"></a><span class="fu">#     # Store CI information</span></span>
<span id="cb1-372"><a href="#cb1-372"></a><span class="fu">#     ci_list[[i]] &lt;- tibble(</span></span>
<span id="cb1-373"><a href="#cb1-373"></a><span class="fu">#         ci_lower = c(</span></span>
<span id="cb1-374"><a href="#cb1-374"></a><span class="fu">#             ci_single[1],</span></span>
<span id="cb1-375"><a href="#cb1-375"></a><span class="fu">#             ci_multiple_lower</span></span>
<span id="cb1-376"><a href="#cb1-376"></a><span class="fu">#         ),</span></span>
<span id="cb1-377"><a href="#cb1-377"></a><span class="fu">#         ci_upper = c(</span></span>
<span id="cb1-378"><a href="#cb1-378"></a><span class="fu">#             ci_single[2],</span></span>
<span id="cb1-379"><a href="#cb1-379"></a><span class="fu">#             ci_multiple_upper</span></span>
<span id="cb1-380"><a href="#cb1-380"></a><span class="fu">#         ),</span></span>
<span id="cb1-381"><a href="#cb1-381"></a><span class="fu">#         which_imp = c("single", "multiple")</span></span>
<span id="cb1-382"><a href="#cb1-382"></a><span class="fu">#     )</span></span>
<span id="cb1-383"><a href="#cb1-383"></a><span class="fu"># }</span></span>
<span id="cb1-384"><a href="#cb1-384"></a><span class="fu"># })</span></span>
<span id="cb1-385"><a href="#cb1-385"></a><span class="fu"># ```</span></span>
<span id="cb1-386"><a href="#cb1-386"></a><span class="fu"># </span></span>
<span id="cb1-387"><a href="#cb1-387"></a><span class="fu"># Below we compute the confidence interval (CI) coverage probability (fraction of times the CI contains the true value of `1`) for the CIs generated from single and multiple imputation:</span></span>
<span id="cb1-388"><a href="#cb1-388"></a><span class="fu"># </span></span>
<span id="cb1-389"><a href="#cb1-389"></a><span class="fu"># ```{r mult_single_sim_study_summ}</span></span>
<span id="cb1-390"><a href="#cb1-390"></a><span class="fu"># ci_data &lt;- bind_rows(ci_list)</span></span>
<span id="cb1-391"><a href="#cb1-391"></a><span class="fu"># ci_data |&gt; </span></span>
<span id="cb1-392"><a href="#cb1-392"></a><span class="fu">#     mutate(contains_truth = ci_lower &lt; 1 &amp; ci_upper &gt; 1) |&gt; </span></span>
<span id="cb1-393"><a href="#cb1-393"></a><span class="fu">#     group_by(which_imp) |&gt; </span></span>
<span id="cb1-394"><a href="#cb1-394"></a><span class="fu">#     summarize(frac_contains_truth = mean(contains_truth))</span></span>
<span id="cb1-395"><a href="#cb1-395"></a><span class="fu"># ```</span></span>
<span id="cb1-396"><a href="#cb1-396"></a><span class="fu"># </span></span>
<span id="cb1-397"><a href="#cb1-397"></a><span class="fu"># ## Done!</span></span>
<span id="cb1-398"><a href="#cb1-398"></a><span class="fu"># </span></span>
<span id="cb1-399"><a href="#cb1-399"></a><span class="fu"># - Check the ICA Instructions for how to (a) push your code to GitHub and (b) update your portfolio website</span></span></code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">

<div class="cookie-consent-footer"><a href="#" id="open_preferences_center">Cookie Preferences</a></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>